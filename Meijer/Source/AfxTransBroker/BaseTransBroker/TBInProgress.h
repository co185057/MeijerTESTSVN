///////////////////////////////////////////////////////////////////////////
///
/// \file TBInProgress.h
/// \brief Declaration file for the CTBInProgress class
///
//////////////////////////////////////////////////////////////////////
#if !defined(AFX_TBINPROGRESS_H__30060CBD_C72C_4246_B326_1FC06A37A518__INCLUDED_)
#define AFX_TBINPROGRESS_H__30060CBD_C72C_4246_B326_1FC06A37A518__INCLUDED_

#if _MSC_VER > 1000
#pragma once
#endif // _MSC_VER > 1000

#include "SingleInstance.h"
#include "CustomerTBDefs.h"

//////////////////////////////////////////////////////////////////////
///
/// CTBInProgress is ...
///
///	@author: FastLane POSI
///
//////////////////////////////////////////////////////////////////////
class CTBInProgress  : public CSingleInstance<CTBInProgress>
{
    friend class CSingleInstance<CTBInProgress>;
public:
		//////////////////////////////////////////////////////////////////////
		///
		/// Destructor
		///
		//////////////////////////////////////////////////////////////////////
    virtual ~CTBInProgress();
    
		/// \struct TBInProgressList
		/// \brief TBInProgressList structure
    typedef struct TBInProgressList{
        TCHAR *szname;
        long key;
        TCHAR *szType;
        TBInProgressList()
            :szname(NULL),
            key(0), szType(NULL)
        {}
        ~TBInProgressList()
        {
            delete [] szname;
            delete [] szType;
        }
    } tTBInProgressList;
    
		//////////////////////////////////////////////////////////////////////
		///
		/// Initialize, ### ADD DESC ###
		///
		//////////////////////////////////////////////////////////////////////
    void Initialize();
    
		//////////////////////////////////////////////////////////////////////
		///
		/// GetKey, ### ADD DESC ###
		///
		///	@param LPCTSTR
		///	@return long
		//////////////////////////////////////////////////////////////////////
    long GetKey(LPCTSTR szStateName);

		//////////////////////////////////////////////////////////////////////
		///
		/// GetName, ### ADD DESC ###
		///
		///	@param long
		///	@return TCHAR *
		//////////////////////////////////////////////////////////////////////
    const TCHAR *GetName(long key);

		//////////////////////////////////////////////////////////////////////
		///
		/// GetType, ### ADD DESC ###
		///
		///	@param long
		///	@return TCHAR *
		//////////////////////////////////////////////////////////////////////
    const TCHAR *GetType(long key);
    
private:
		//////////////////////////////////////////////////////////////////////
		///
		/// Hide Copy Const
		///
		//////////////////////////////////////////////////////////////////////
    CTBInProgress(const CTBInProgress &);              // hide copy const

		//////////////////////////////////////////////////////////////////////
		///
		/// Hide Assignment
		///
		//////////////////////////////////////////////////////////////////////
    CTBInProgress & operator =(const CTBInProgress &); // hide assignment

    //////////////////////////////////////////////////////////////////////
		///
		/// Contructor
		///
		//////////////////////////////////////////////////////////////////////
    CTBInProgress();

    tTBInProgressList *m_pTBProgressList; ///< Variable to TBInProgressList Struct

    int m_nStatesCount;	///< no of states
    
		MSXML2::IXMLDOMDocumentPtr m_pTBStatesDoc;	/// XML DOM object for TBStates
    
};

#endif // !defined(AFX_TBINPROGRESS_H__30060CBD_C72C_4246_B326_1FC06A37A518__INCLUDED_)
