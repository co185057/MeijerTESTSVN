<?xml version="1.0" encoding="UTF-8" ?>

<!-- CHANGE HISTORY: 										-->
<!-- CRD 628007 Name: CJ Estrada Date: Apr 16, 2021 -->
<!-- CRD 537490 Name: CJ Estrada Date: Mar 17, 2021 -->
<!-- CRD 564271 Name: CJ Estrada Date: Mar 9, 2021 -->
<!-- CRD 554915 Name: CJ Estrada Date: Feb 8, 2021 -->
<!-- CRD 461118 Name: Dennis Michol Gabutin Date: July 22, 2020 -->
<!-- POS328559 Work Request:79417 Name: Aparna Tunuguntla   Date:Aug 29, 2017 -->
<!-- POS324040/POS324438 Work Request:79417 Name: Alex Bronola  Date:Jul 07, 2017 -->
<!-- POS323036 Work Request:76936 Name: Alex Bronola   Date:May 04, 2017 -->
<!-- POS320733 Work Request:76936 Name:Alex Bronola Date:Apr. 12, 2017 -->
<!-- POS320135 Work Request:76936 Name:Alex Bronola Date:Apr. 03, 2017 -->
<!-- POS310004 Work Request:79417 Name:Alex Bronola Date:Feb 24, 2017    -->
<!-- POS305064 Work Request:76936 Name:Alex Bronola Date:Mar 1, 2017    -->
<!-- POS311584 Work Request:76936 Name:Alex Bronola Date:Jan 19, 2017    -->
<!-- POS311482 Work Request:76936 Name:Alex Bronola Date:Jan 16, 2017    -->
<!-- POS303159 Work Request:76936 Name:Alex Bronola Date:Dec 16, 2016    -->
<!-- POS303376 Work Request:76936 Name: Veerasekhara,D  Date:December 16, 2016 -->
<!-- POS306203 Work Request:76936 Name:Alex Bronola Date:Dec 15, 2016    -->
<!-- POS291625 Work Request:76936 Name:Alex Bronola Date:Dec 05, 2016    -->
<!-- POS294897 Work Request:73595 Name:Alexander Bronola Date:October 03, 2016 -->
<!-- POS294602 Work Request:73595 Name:Alexander Bronola Date:Sept 27, 2016 -->
<!-- POS290538 Work Request:73595 Name:Robert Susanto Date:August 24, 2016					-->
<!-- POS290243 Work Request:73595 Name:Robert Susanto Date:August 24, 2016					-->
<!-- POS277295 Work Request:73595 Name:Alexander Bronola/Veerasekhara D 	Date:August 12, 2016				-->
<!-- POS273548 Work Request:73594 Name:Robert Susanto Date:July 1, 2016					-->
<!-- POS244229 Work Request:73594 Name:Alexander Bronola Date:June 23, 2016				-->
<!-- POS258550 Work Request:68941 Name:Robert Susanto Date:May 25, 2016					-->
<!-- POS262867 Work Request:68941 Name:Robert Susanto Date:May 23, 2016					-->
<!-- POS265169 Work Request:68941 Name:Robert Susanto Date:May 11, 2016					-->
<!-- POS257231 Work Request:68941 Name:Robert Susanto Date:March 31, 2016					-->
<!-- POS253532 WorkRequest:68941 Name:Saiprasad Srihasam Date:Mar18,2016	-->	
<!-- POS223750 Work Request:68941 Name:Robert Susanto Date:Jan 11, 2016					-->
<!-- POS240201 Work Request:68942 Name:Robert Susanto Date:January 7, 2016    -->
<!-- POS235150 Work Request:68942 Name:Saiprasad Srihasam Date:January 4, 2016    -->
<!-- POS208800 Work Request:68940 Name:Robert Susanto Date: September 15, 2015          -->
<!-- POS215380 Work Request:68940 Name:Saiprasad Srihasam Date: September 2, 2015          -->
<!-- POS214059 Work Request:68940 Name:Robert Susanto Date: August 5, 2015          -->
<!-- POS212941 Work Request:68940 Name:Robert Susanto Date: August 5, 2015          -->
<!-- POS189696 Work Request:68237 Name:Saiprasad Srihasam Date: April 14, 2015          -->
<!-- POS180969  Work Request:66559 Name:Robert Susanto Date:February 10, 2015		-->
<!-- POS154789 Work Request:66559 Name:Saiprasad Srihasam    Date:January 30, 2015  		-->	
<!-- POS154826 Work Request:66559 Name:Saiprasad Srihasam    Date:January 22, 2015  		-->	
<!-- POS154789 Work Request:66559 Name:Kranthi Cherugondi/Robert Date:January 21,2015                -->
<!-- POS138840  Work Request:66559 Name:Robert Susanto Date:January 15, 2015		-->
<!-- POS153885 Work Request:66559 Name:Saiprasad Srihasam Date:January 13,2015                            -->
<!-- POS149583 Work Request:66559 Name:Saiprasad Srihasam Date:January 08,2015                            -->
<!-- POS138630 Work Request:66559 Name:Saiprasad Srihasam    Date:December 04, 2014			   -->
<!-- POS145373  Work Request:66559 Name:Robert Susanto Date:November 20, 2014		-->
<!-- POS143713 Work Request:65347 Name:Robert Susanto Date:November 6, 2014		-->
<!-- POS139881 Work Request:65347 Name:Robert Susanto Date:October 23, 2014		-->
<!-- POS111636 Work Request:65347 Name:Srihasam Saiprasad Date:October 10, 2014		-->
<!-- POS73721 Work Request:58657 Name:Robert Susanto    Date:September 6, 2013		-->
<!-- POS101707 Work Request:65347 Name: Saiprasad Srihasam Date: September 29, 2014 -->
<!-- POS106936 Work Request:61232 Name:Robert Susanto    Date:July 22, 2014			-->
<!-- POS94866 Work Request:61233 Name: Saiprasad Srihasam Date:July 21, 2014        -->
<!-- POS102483 Work Request:61232 Name:Robert Susanto    Date:July 1, 2014			-->
<!-- POS95965 Work Request:61232 Name:Robert Susanto    Date:May 23, 2014			-->
<!-- POS83168 Work Request:61232 Name:Matt Condra    Date:February 11, 2014			   -->
<!-- POS85378 Work Request:59313 Name:Matt Condra    Date:January 10, 2014			   -->
<!-- POS78133 Work Request:58657 Name:Matt Condra    Date:October 7, 2013			   -->
<!-- POS73665 Work Request:58657 Name:Matt Condra    Date:September 24, 2013			-->
<!-- POS48277/71132 Work Request:58657 Name:Robert Susanto    Date:September 6, 2013		-->
<!-- POS70546 Work Request:56285 Name:Robert Susanto    Date:July 11, 2013			-->
<!-- POS68773 Work Request:56285 Name:Robert Susanto    Date:June 25, 2013			-->
<!-- POS65108/6300 Work Request:56285 Name:Robert Susanto    Date:May 23, 2013		-->
<!-- POS57465 Work Request:56285 Name:Matt Condra    Date:May 15, 2013			-->
<!-- POS61842 Work Request:54416 Name:Robert Susanto    Date:April 19, 2013			-->
<!-- POS60208 Work Request:54416 Name:Robert Susanto    Date:April 3, 2013			-->
<!-- POS59850 Work Request:54416 Name:Robert Susanto    Date:April 1, 2013			-->
<!-- POS55609 Work Request:54416 Name:Matt Condra    Date:March 26, 2013			-->
<!-- POS55263 Work Request:54416 Name:Robert Susanto    Date:March 18, 2013			-->
<!-- POS57686 Work Request:54416 Name:Robert Susanto    Date:March 11, 2013			-->
<!-- POS41473 Work Request:54416 Name:Matt Condra    Date:March 6, 2013			-->
<!-- POS55434 Work Request:52635 Name:Robert Susanto    Date:February 12, 2013			-->
<!-- POS53849 Work Request:52635 Name:Sandy Reedy    Date:January 23, 2013			-->
<!-- POS52017 Work Request:52635 Name:Matt Condra    Date:January 11, 2013			-->
<!-- POS51551 Work Request:52635 Name:Sandy Reedy Date:December 20, 2012		        -->
<!-- POS44624/POS51734 Work Request:52635 Name:Sandy Reedy Date:December 19, 2012		-->
<!-- POS50538 Work Request:52635 Name:Robert Susanto    Date:December 11, 2012			-->
<!-- POS49567 Work Request:52635 Name:Robert Susanto    Date:November 28, 2012			-->
<!-- POS33020 Work Request:52635 Name:Matt Condra    Date:November 16, 2012			-->
<!-- POS39475 Work Request:52635 Name:Matt Condra    Date:November 10, 2012			-->
<!-- POS30981/POS37397 Work Request:52635 Name:Robert Susanto Date:October 24 2012  		-->
<!-- POS36905/POS42533 Work Request:52635 Name:Robert Susanto Date:October 17, 2012		-->
<!-- POS39158 Work Request:50865 Name:Robert Susanto Date:September 5, 2012			-->
<!-- POS42003 Work Request:50865 Name:Robert Susanto Date:August 31, 2012			-->
<!-- POS36318 Work Request:50865 Name:Robert Susanto Date:August 24, 2012			-->
<!-- POS30981/POS31053 Work Request:50864 Name:Robert Susanto Date:July 31 2012  		-->
<!-- POS30981/POS31051 Work Request:50864 Name:Robert Susanto Date:July 18 2012  		-->
<!-- POS30981/POS31050 Work Request:50864 Name:Robert Susanto Date:July 17 2012  		-->
<!-- POS30981/POS31050 Work Request:50864 Name:Robert Susanto Date:July 16 2012  		-->
<!-- POS30981/POS31050 Work Request:50864 Name:Robert Susanto Date:July 12 2012  		-->
<!-- POS30981/POS31052 Work Request:50864 Name:Robert Susanto Date:June 26 2012	  		-->
<!-- POS36880/POS31050 Work Request:50864 Name:Robert Susanto Date:June 21 2012	  		-->
<!-- POS36412/POS31050 Work Request:50864 Name:Robert Susanto Date:June 14 2012	  		-->
<!-- POS30981/POS31051 Work Request:50864 Name:Robert Susanto Date:May 21 2012	  		-->
<!-- POS30981/POS31051 Work Request:50864 Name:Robert Susanto Date:May 7 2012	  		-->
<!-- POS30981/POS31050 Work Request:50864 Name:Robert Susanto Date:April 24 2012  		-->
<!-- POS36319 Work Request:50864 Name:Robert Susanto Date:June 20, 2012				-->
<!-- POS27359 Work Request:19114 Name:Matt Condra    Date:February 22 2012 			-->
<!-- POS28644 Work Request:16656 Name:Robert Susanto Date:January 26 2012  			-->
<!-- POS25997 Work Request:16656 Name:Matt Condra    Date:January 3 2012  			-->
<!-- POS25874 Work Request:16656 Name:Matt Condra    Date:December 15 2011			-->
<!-- POS19072 Work Request:16656 Name:Matt Condra    Date:November 29 2011			-->
<!-- POS18905 Work Request:16656 Name:Robert Susanto Date:October 13 2011  			-->
<!-- POS17261 Work Request:16656 Name:Matt Condra    Date:October 27 2011 			-->
<!-- POS19073 Work Request:16656 Name:Matt Condra    Date:Oct 14 2011				-->
<!-- POS11024 Work Request:16632 Name:Sandeep Shenoy Date:October 26, 2011      	-->
<!-- POS11024 Work Request:16632 Name:Sandeep Shenoy Date:October 20, 2011      	-->
<!-- POS11024 Work Request:16632 Name:Sandeep Shenoy Date:October 7, 2011  	    	-->
<!-- POS11024 Work Request:16632 Name:Sandeep Shenoy Date:October 5, 2011  	    	-->
<!-- POS11024 Work Request:16632 Name:Sandy Reedy Date:September 27, 2011  	    	-->
<!-- POS11024 Work Request:16632 Name:Sandy Reedy Date:September 8, 2011  	    	-->
<!-- POS11024 Work Request:16632 Name:Sandeep Shenoy Date:August 26, 2011  	    	-->
<!-- POS11024 Work Request:16632 Name:Sandeep Shenoy Date:August 23, 2011  	    	-->
<!-- POS11024 Work Request:16632 Name:Sandy Reedy Date:August 22, 2011  	    	-->
<!-- POS11024 Work Request:16632 Name:Sandy Reedy Date:August 19, 2011  	    	-->
<!-- POS15437 Work Request:15196 Name:Robert Susanto Date:August 1 2011  			-->
<!-- POS15885 Work Request:15196 Name:Robert Susanto Date:July 29  2011  			-->

<!-- POS11024 Work Request:16632 Name:Sandy Reedy Date:July 20, 2011  		    	-->
<!-- POS11024 Work Request:16632 Name:Sandy Reedy Date:July 19, 2011  		    	-->
<!-- POS11024 Work Request:16632 Name:Sandy Reedy Date:July 14, 2011  		    	-->
<!-- POS11024 Work Request:16632 Name:Sandy Reedy Date:July 14, 2011  		    	-->
<!-- POS11024 Work Request:16632 Name:Sandeep Shenoy Date:Jul  7, 2011  			-->
<!-- POS15989 Work Request:15196 Name:Robert Susanto Date:July 20  2011  			-->
<!-- POS15766 Work Request:15196 Name:Robert Susanto Date:July 8  2011  			-->
<!-- POS15302 Work Request:15196 Name:Robert Susanto Date:July 15 2011  			-->
<!-- POS15434 Work Request:15196 Name:Robert Susanto Date:June 28 2011  			-->
<!-- POS14806 Work Request:15196 Name:Robert Susanto Date:June 10 2011  			-->
<!-- POS6135 Work Request:15196 Name:Robert Susanto Date:April 28 2011  			-->
<!-- POS12127 Work Request:13752 Name:Robert Susanto Date:April 5 2011  			-->
<!--												-->

<!-- edited with XMLSpy v2005 sp2 U (http://www.altova.com) by Developer (NCR Corporation) -->
<ApplicationModel xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:noNamespaceSchemaLocation="ApplicationModel.xsd" Version="1.24">
   <States>
      <State Name="APPLICATION_START" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="ApplicationStart" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="ApplicationStart" />
         </OnStateEnter>
      </State>
      <State Name="OFFLINE_APPROVE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="4" />
            </DetectContext>
         </Detect>
      </State>

<!-- POS61842 - rrs  -->
      <State Name="DYNAFRAME_NOT_FOUND">
         <Detect>
           <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="title_1" Contains="DynaFrame Not Found" />
            </DetectContext>
         </Detect>         
      </State>
<!-- POS61842 - rrs  -->


      <State Name="VOID_GIFT_CARD">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="155" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="EXIT_SECURE_MODE">
         <Detect>
            <DetectContext Context="DF_Exit_secure_mode" />
            <DetectContext Context="Operator_guidance"></DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_Exit_secure_mode" />
            <SetProperty Value="1" Action="Set" Property="HideInput" />
            <ResetControl Control="Display" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SetProperty Property="OP_Guidance_Txt" Action="Set" Value="Please enter password to exit secure mode" />
            <SetProperty Property="OP_Guidance_Prompt" Action="Set" Value="" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="1" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Exit Secure Mode" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="Key in password to exit secure mode" />
            <SendControl Control="Display" />
            <SetProperty Property="OP_Guidance_Txt" Action="Set" Value="" />
            <SetProperty Property="OP_Guidance_Prompt" Action="Set" Value="" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Value="0" Action="Set" Property="HideInput" />
         </OnStateExit>
      </State>
      <State Name="SECURE_MODE_EXIT" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="Secure_mode_exit" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Secure_mode_exit" />
            <ResetContext Context="DF_Exit_secure_mode" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
	   <!-- BEGIN SOTF8850 SOTF10804 -->
	   <State Name="CSBR_SLIP_NOT_VALID">
		   <Detect>
			   <DetectContext Context="Operator_guidance">
				   <Field Name="msg_num" RegEx="^((1452)|(1453))$" />
			   </DetectContext>
		   </Detect>
	   </State>
	   <State Name="CSBR_SLIP_EXPIRED">
		   <Detect>
			   <DetectContext Context="Operator_guidance">
				   <Field Name="msg_num" Equals="1454" />
			   </DetectContext>
		   </Detect>
	   </State>
	   <State Name="CSBR_PREVIOUSLY_REDEEMED">
		   <Detect>
			   <DetectContext Context="Operator_guidance">
				   <Field Name="msg_num" RegEx="^((1455)|(1456))$" />
			   </DetectContext>
		   </Detect>
	   </State>
	   <State Name="CSBR_SLIP_NOT_FROM_STORE">
		   <Detect>
			   <DetectContext Context="Operator_guidance">
				   <Field Name="msg_num" Equals="1457" />
			   </DetectContext>
		   </Detect>
	   </State>
	   <!-- END SOTF8850 SOTF10804 -->


      <!--POS37397: Mobile ReResume - Start -->
	  <!--POS53849: Correct msg_num 1581 -->
      <State Name="MOB_SHOP_ORDER_RE_RESUME_MSG">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1581" />
	       <Field Name="msg_level" RegEx="^((1)|(3))$" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropMobShopOrderPrompt" Action="Set" Value="1" />
            <ResetControl Control="Display" />
         </OnStateEnter>
      </State>
	  <!--POS53849: Correct msg_num 1581 -->
      <State Name="MOB_SHOP_ORDER_INVALID_RE_RESUME_SET">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1581" />
	       <Field Name="msg_level" RegEx="^((2))$" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropMobShopOrderPrompt" Action="Set" Value="0" />  
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SendControl Control="Display" />
         </OnStateEnter>
	 <OnStateExit>
	    <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
	</OnStateExit>
      </State>
	  <!--POS53849: Correct msg_num 1581 -->
      <State Name="MOB_SHOP_ORDER_RE_RESUME_SUPERVISOR_LVL4" Group="SUPERVISOR_OPERATOR_MESSAGE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1581" />
	       <Field Name="msg_level" Equals="4" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropMobShopOrderPrompt" Action="Set" Value="0" />
            <SetProperty Property="IsSupervisorApproval" Action="Set" Value="0" />
  	    <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SendControl Control="Display" />
         </OnStateEnter>
	 <OnStateExit>
	    <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
	</OnStateExit>
      </State>
      <!--POS37397: Mobile ReResume - End -->

      <State Name="SUPERVISOR_OPERATOR_MESSAGE5" Group="SUPERVISOR_OPERATOR_MESSAGE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="474" />
               <Field Name="msg_level" Equals="5" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="SignPaperForm" Action="Set" Value="1" />
            <SetProperty Property="IsSupervisorApproval" Action="Set" Value="0" />
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SendControl Control="Display" />
		</OnStateEnter>
		<OnStateExit>
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
		</OnStateExit>
      </State>
      <State Name="SUPERVISOR_OPERATOR_MESSAGE6" Group="SUPERVISOR_OPERATOR_MESSAGE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="474" />
               <Field Name="msg_level" Equals="6" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="SignPaperForm" Action="Set" Value="1" />
            <SetProperty Property="IsSupervisorApproval" Action="Set" Value="0" />
        	<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
			<SendControl Control="Display" />	
		</OnStateEnter>
		<OnStateExit>
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
		</OnStateExit>
      </State>
      <State Name="SUPERVISOR_OPERATOR_MESSAGE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_level" Equals="5" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="IsSupervisorApproval" Action="Set" Value="0" />
         	<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
			<SendControl Control="Display" />
		</OnStateEnter>
		<OnStateExit>
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
		</OnStateExit>
      </State>
      <State Name="SUPERVISOR_OPERATOR_MESSAGE2" Group="SUPERVISOR_OPERATOR_MESSAGE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_level" Equals="6" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="IsSupervisorApproval" Action="Set" Value="0" />
        	<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
			<SendControl Control="Display" />
		</OnStateEnter>
		<OnStateExit>
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
		</OnStateExit>
      </State>
      <State Name="SUPERVISOR_OPERATOR_MESSAGE3" Group="SUPERVISOR_OPERATOR_MESSAGE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_level" Equals="7" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="IsSupervisorApproval" Action="Set" Value="0" />
         	<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
			<SendControl Control="Display" />
		</OnStateEnter>
		<OnStateExit>
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
		</OnStateExit>
      </State>
      <State Name="SUPERVISOR_OPERATOR_MESSAGE4" Group="SUPERVISOR_OPERATOR_MESSAGE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_level" Equals="8" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="IsSupervisorApproval" Action="Set" Value="0" />
        	<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
			<SendControl Control="Display" />
		</OnStateEnter>
		<OnStateExit>
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
		</OnStateExit>
      </State>
	  <!-- start CRD 418158 -->
	  <State Name="COUPON_CUSTOMER_OVERRIDE_MESSAGE_LVL1">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_level" Equals="11" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
             <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
             <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateExit>
      </State>
	  <State Name="COUPON_CUSTOMER_OVERRIDE_MESSAGE_LVL2TO5">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_level" RegEx="^((12)|(13)|(14)|(15))" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
             <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
             <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateExit>
      </State>
	  <State Name="COUPON_CUSTOMER_OVERRIDE_MESSAGE_LVL7TO8">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_level" RegEx="^((17)|(18))" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
             <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
             <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateExit>
      </State>
	  <!-- end CRD 418158 -->

      <State Name="LABEL_PRICE_PER_POUND">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="989" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="VOID_ITEM_WEIGHT">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="284" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
         </OnStateEnter>
      </State>
      <State Name="PRICE_DISCREPANCY">
         <Detect>
            <DetectContext Context="Item_entry_orig_price_display"></DetectContext>
         </Detect>
      </State>
      <!-- SOTF7626 Start rrs -->
      <State Name="BALANCE_INQUIRY_COMPLETE" Group="BAL_INQUIRY_DEST2">  <!-- POS208800 -->
         <Detect>
            <DetectContext Context="DF_Balncinq_complete" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_Balncinq_complete" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Balance Confirmation" />
            <SetProperty Property="Title2_Prop" Action="Set" Value="" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Confirm balance at MSR." />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
         </OnStateExit>
      </State>
      <!-- SOTF7626 End -->
      <State Name="CONFIRM_TRANSACTION" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="DF_Debit_confirm" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_Debit_confirm" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Transaction Confirmation" />
            <SetProperty Property="Title2_Prop" Action="Set" Value="" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Confirm transaction at MSR." />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="SELECT_TAX_TABLE">
         <Detect>
            <DetectContext Context="DF_Manual_tax" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_Manual_tax" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Manual Tax Table ID" />
            <SetProperty Property="Title2_Prop" Action="Set" Value="" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Key in or select tax table ID, or key in an" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="amount and select a tax table ID." />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="Tax Table 1" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="Tax Table 2" />
            <SetProperty Property="DK3_Label_Prop" Action="Set" Value="Tax Table 3" />
            <SetProperty Property="DK4_Label_Prop" Action="Set" Value="Tax Table 4" />
            <SetProperty Property="DK5_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK6_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK7_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK8_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK3_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK4_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK5_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK6_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK7_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK8_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="1" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="SELECT_TAX_TABLE_AMOUNT" Group="SELECT_TAX_TABLE">
         <Detect>
            <DetectContext Context="DF_Oit_tax_amt" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_Oit_tax_amt" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Manual Tax Amount" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Key in manual tax amount." />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK3_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK4_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK5_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK6_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK7_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK8_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK3_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK4_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK5_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK6_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK7_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK8_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="1" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="INVALID_VOID_ITEM">
         <Detect>
            <DetectContext Context="DF_Void_item_not_sold" />
	    <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_Void_item_not_sold" />
            <ResetControl Control="Display" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SetProperty Property="OP_Guidance_Txt" Action="Set" Value="This item not sold in transaction" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="1" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Void Item Not Found" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="Cancel" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="0" />
            <SendControl Control="Display" />
            <SetProperty Property="OP_Guidance_Txt" Action="Set" Value="" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
         </OnStateEnter>
      </State>    
      <!--
      <State Name="EBT_REFFERAL" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="EBT_slip_1_fs" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="EBT_slip_1_fs" />
            <SetProperty Property="NotEBTDeclineSlip" Action="Set" Value="1" />
         </OnStateEnter>
      </State>
      -->
     <!-- <State Name="EBT_INSUFFICIENT_ENDORSEMENT">
         <Detect>
            <DetectContext Context="EBT_slip_trailer" />
            <DetectProperty Property="IsEBTTenderInsufficient" Equals="1" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="EBT_slip_trailer" />
         </OnStateEnter>
      </State>
      
      <State Name="EBT_ENDORSEMENT">
         <Detect>
            <DetectContext Context="EBT_slip_trailer" />
            <DetectProperty Property="NotEBTDeclineSlip" Equals="0" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="EBT_slip_trailer" />
         </OnStateEnter>
      </State>-->
    
	  <State Name="EBT_ENDORSEMENT">
         <Detect>
            <DetectContext Context="EBT_slip_trailer" />            
         </Detect>
         <OnStateEnter>
            <ResetContext Context="EBT_slip_trailer" />
         </OnStateEnter>
      </State>  
      

      <State Name="NEGATIVE_MEDIA_AMOUNT">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="226" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SetProperty Value="1" Action="Set" Property="PropNegativeMedia" />
            <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="MICR_ERROR">
         <Detect>
            <DetectContext Context="Error_context">
               <Field Name="echo_text" Contains="MICR ERROR" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Error_context" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="MICR Error" />
            <!-- Title2_Prop field is populated in TB to present actual FL MICR error desc -->
            <!--<SetProperty Property="Title2_Prop" Action="Set" Value="" />-->
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Press Clear" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK3_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK4_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK5_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK6_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK7_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK8_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK3_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK4_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK5_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK6_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK7_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK8_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="1" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="ERROR_CONTEXT_SUPER" Group="ERROR_CONTEXT_CLEAR">
         <Detect>
            <DetectContext Context="Error_context" />
            <DetectProperty Property="OG_MsgNum_Prop" Equals="19" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Error_context" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Error" />
            <SetProperty Property="Title2_Prop" Action="Set" Value="Invalid Key Pressed" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Invalid Data Press Clear" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK3_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK4_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK5_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK6_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK7_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK8_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK3_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK4_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK5_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK6_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK7_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK8_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="OP_Guidance_Txt" Action="Set" Value="INVALID DATA" />
            <SetProperty Property="OP_Guidance_Prompt" Action="Set" Value="" />
            <SetProperty Value="1" Action="Set" Property="PropIsOperGuid" />
			<SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
		<SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
        	<ResetControl Control="Display" /> <!-- POS31051 reset the OG context -->
         </OnStateExit>
      </State>
      <State Name="ERROR_CONTEXT_CLEAR" Group="ERROR_CONTEXT_CLEAR">
         <Detect>
            <DetectContext Context="Error_context" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Error_context" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Error" />
            <SetProperty Property="Title2_Prop" Action="Set" Value="Invalid Key Pressed" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Invalid Data Press Clear" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK3_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK4_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK5_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK6_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK7_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK8_Label_Prop" Action="Set" Value="Backup" />
            <SetProperty Property="DK1_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK3_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK4_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK5_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK6_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK7_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK8_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="OP_Guidance_Txt" Action="Set" Value="INVALID DATA" />
            <SetProperty Property="OP_Guidance_Prompt" Action="Set" Value="" />
            <SetProperty Value="1" Action="Set" Property="PropIsOperGuid" />
	    <SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" />  <!-- POS36412 rrs -->
            <SendControl Control="Display" />
         </OnStateEnter>
<!-- POS36412 rrs -->
         <OnStateExit>
		<SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> 
         </OnStateExit>
<!-- e POS36412 -->
      </State>
      <State Name="SWIPE_VOID_CARD_ON_PINPAD">
         <Detect>
            <DetectContext Context="DF_Acct_no_MSR_VdPhone" />
         </Detect>
         <OnStateEnter>
            <SetProperty Property="IsVoidingPhoneGift" Action="Set" Value="1" />
            <ResetContext Context="DF_Acct_no_MSR_VdPhone" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Account Number" />
            <SetProperty Property="Title2_Prop" Action="Set" Value="Swipe Card To Void" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Swipe card at MSR" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="Cancel" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK3_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK4_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK5_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK6_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK7_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK8_Label_Prop" Action="Set" Value="Backup" />
            <SetProperty Property="DK1_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK3_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK4_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK5_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK6_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK7_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK8_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="0" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="SWIPE_CARD_ON_PINPAD">
         <Detect>
            <DetectContext Context="DF_Acct_no_MSR_PhoneGift">
                <Field Name="Cancel_asa_var" Equals="0" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="IsVoidingPhoneGift" Action="Set" Value="0" />
            <ResetContext Context="DF_Acct_no_MSR_PhoneGift" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Account Number" />
            <SetProperty Property="Title2_Prop" Action="Set" Value="MSR Entry" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Swipe card at MSR" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="Cancel" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK3_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK4_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK5_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK6_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK7_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK8_Label_Prop" Action="Set" Value="Backup" />
            <SetProperty Property="DK1_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK3_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK4_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK5_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK6_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK7_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK8_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="0" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="PHONE_GIFT_CARD_SWIPED">
         <Detect>
            <DetectContext Context="DF_Acct_no_MSR_PhoneGift">
                <Field Name="Cancel_asa_var" Equals="1" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_Acct_no_MSR_PhoneGift" />
         </OnStateEnter>
      </State>
      <State Name="END_PROCESSING" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="Process_or_blank">
				<Field Name="proc_msg" Equals="176" />
			</DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Process_or_blank" />
			<SetProperty Value="0" Action="Set" Property="NeedAMProcessing"/>
            
            <SendControl Control="Display" />
         </OnStateEnter>
		 <OnStateExit>
			   <SetProperty Value="0" Action="Set" Property="NeedAMProcessing"/>
		 </OnStateExit>
      </State>
      <State Name="PROCESSING" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="Process_or_blank" />
	    <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
			<ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="Process_or_blank" />
			<SetProperty Value="1" Action="Set" Property="NeedAMProcessing"/>
<!-- POS15437 -->
		<SetProperty Property="DK8_Label_Alt_Prop" Action="Set" Value="" />
<!-- POS15437 -->
            <SendControl Control="Display" />
         </OnStateEnter>
		 <OnStateExit>
			   <SetProperty Value="0" Action="Set" Property="NeedAMProcessing"/>
		 </OnStateExit>
      </State>
	  <!-- +CRD185924 -->
	    <State Name="POS_RESTARTING"  Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="1832" />
			   <DetectProperty Property="IsPOSRestartInprogress" Equals="0"/>
            </DetectContext>
         </Detect>
         <OnStateEnter>
			<SetProperty Property="IsPOSRestartInprogress" Action="Set" Value="1" />
			<SetProperty Property="IsQuickRestart" Action="Set" Value="1" />			
            <ResetContext Context="acs_tb_interface" />
         </OnStateEnter>
      </State>    
	  <!-- -CRD185924 -->
	  <State Name="APPLICATION_INITIALIZE" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="Initialisation" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Initialisation" />
            <SetProperty Property="IsQuickRestart" Action="Set" Value="0" />
	     </OnStateEnter>
      </State>	
      <State Name="SIGNIN_MENU">
         <Detect>
            <DetectContext Context="DF_Main_menu" />
            <DetectProperty Property="IsInTrainingMode" Equals="0"/>
            <DetectProperty Property="IsQuickRestart" Equals="0"/>     
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_Main_menu" />
            <ResetControl Control="Display" />
            <SetProperty Property="StoreCloseRequested" Action="Set" Value="" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <SetProperty Property="OP_Guidance_Txt" Action="Set" Value="Please press return to shopping now" />
            <SetProperty Property="OP_Guidance_Prompt" Action="Set" Value="" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="1" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Sign-in Menu" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="POS signed out" />
            <SendControl Control="Display" />
            <SetProperty Property="OP_Guidance_Txt" Action="Set" Value="" />
            <SetProperty Property="OP_Guidance_Prompt" Action="Set" Value="" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SetProperty Property="SeparateMedia" Action="Set" Value="0" /> <!-- TAR320495 -->
         </OnStateEnter>
      </State>
      <State Name="SIGNIN_MENU_TRAINING" Group="SIGNIN_MENU">
         <Detect>
            <DetectContext Context="DF_Main_menu" />
            <DetectProperty Property="IsInTrainingMode" Equals="1"/>
            <DetectProperty Property="IsQuickRestart" Equals="0"/>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_Main_menu" />
            <ResetControl Control="Display" />
            <SetProperty Property="StoreCloseRequested" Action="Set" Value="" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <SetProperty Property="OP_Guidance_Txt" Action="Set" Value="Please press return to shopping now" />
            <SetProperty Property="OP_Guidance_Prompt" Action="Set" Value="" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="1" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Sign-in Menu" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="POS signed out" />
            <SendControl Control="Display" />
            <SetProperty Property="OP_Guidance_Txt" Action="Set" Value="" />
            <SetProperty Property="OP_Guidance_Prompt" Action="Set" Value="" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SetProperty Property="SeparateMedia" Action="Set" Value="0" /> <!-- TAR320495 -->
         </OnStateEnter>
      </State>
      <State Name="POS_SIGNEDON" Group="ITEMMENU_DK1">
         <Detect>
            <DetectContext Context="Signon" />
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <ResetContext Context="Signon" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>
      <State Name="VOID_TRANSACTION">
         <Detect>
            <DetectContext Context="Void_transaction" />
         </Detect>
         <OnStateEnter>
			<SetProperty Property="PrintGiftReceipt" Action="Set" Value="0" />
			<SetProperty Property="RebateReceiptRequested" Action="Set" Value="0" />
            <SetProperty Property="IsTransactionVoided_Prop" Action="Set" Value="1" />
            <ResetContext Context="Void_transaction" />
         </OnStateEnter>
      </State>
      <State Name="BAL_INQUIRY_DEST">
         <Detect>
            <DetectContext Context="DF_Binq_dest" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_Binq_dest" />
            <ResetControl Control="Display" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Balance Inquiry" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Select destination for guest's balance inquiry." />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="MSR Display" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="Print" />
            <SetProperty Property="DK3_Label_Prop" Action="Set" Value="Both" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="0" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <!-- POS19072: Added WIC_FREE_ITEM_PHASE_POSSTATE so that WICFreeItemPhaseActive property is set during Shopping & Assist Modes. -->
      <!--           It also indirectly helps activate the Scan&Bag screen in Shopping Mode because it is currently in the SMInProgress state. -->
      <!-- POS25997: 'WIC Free Item' is softkey 7 on Item Menu's 3rd page -->
      <State Name="WIC_FREE_ITEM_PHASE_POSSTATE" Group="ITEMMENU_DK1">
         <Detect>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="icon_label_7" Contains="Free Item" />
               <Field Name="icon_bitmap_7" Contains="|BITMAP|:checkon" />
            </DetectContext>
            <DetectProperty Property="WICFreeItemPhaseActive" Equals="0" />
         </Detect>
         <OnStateEnter>
            <SetProperty Property="CustomerHasWICFreeItems" Action="Set" Value="1" />
            <SetProperty Property="WICFreeItemPhaseActive" Action="Set" Value="1" />
         </OnStateEnter>
      </State>
	  <!--+SSCOI-47453-->
	  <State Name="PROCESSING" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="DF_Mode">
               <Field Name="mode" Contains="|BITMAP|:waitmode.bmp" />
            </DetectContext>
		<DetectProperty Property="IsSCOFLMS" Equals="0" />	<!-- CRD 289150 don't detect processing state during flms-->
		<DetectProperty Property="IsEverseenAlert" Equals="0" />	<!-- CRD 347124 don't detect processing state during everseen alert-->
         </Detect>
      </State>
	  <!---SSCOI-47453-->	  
      <State Name="BAL_INQUIRY_DEST2" Group="BAL_INQUIRY_DEST">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="834" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="icon_desc_8" Contains="(Page 1 of" />  <!-- POS208800 rrs -->
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateEnter>
      </State>
      <State Name="DISCOUNT_PRICE">
         <Detect>
            <DetectContext Context="DF_Md_amt" />
	    <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_Md_amt" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Discount Amount ($)" />
            <SetProperty Property="Title2_Prop" Action="Set" Value="Select or key in discount amount." />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Scan item or select function." />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="$0.50" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="$1.00" />
            <SetProperty Property="DK3_Label_Prop" Action="Set" Value="$1.50" />
            <SetProperty Property="DK4_Label_Prop" Action="Set" Value="$2.00" />
            <SetProperty Property="DK5_Label_Prop" Action="Set" Value="$2.50" />
            <SetProperty Property="DK6_Label_Prop" Action="Set" Value="$3.00" />
            <SetProperty Property="DK7_Label_Prop" Action="Set" Value="$3.50" />
            <SetProperty Property="DK8_Label_Prop" Action="Set" Value="$4.00" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="DISCOUNT_RATE">
         <Detect>
            <DetectContext Context="DF_Md_rate" />
	    <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_Md_rate" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Discount Rate (%)" />
            <SetProperty Property="Title2_Prop" Action="Set" Value="" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Select or key in discount rate." />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="5%" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="10%" />
            <SetProperty Property="DK3_Label_Prop" Action="Set" Value="15%" />
            <SetProperty Property="DK4_Label_Prop" Action="Set" Value="20%" />
            <SetProperty Property="DK5_Label_Prop" Action="Set" Value="25%" />
            <SetProperty Property="DK6_Label_Prop" Action="Set" Value="30%" />
            <SetProperty Property="DK7_Label_Prop" Action="Set" Value="35%" />
            <SetProperty Property="DK8_Label_Prop" Action="Set" Value="40%" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="ATTEMPT_VOID">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="69" />
            </DetectContext>
            <DetectContext Context="DF_Void_item_mods"></DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaKey_labels" />
            <ResetContext Context="DF_Void_item_mods" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="SuppressAmountAudio" Action="Set" Value="false" />
         </OnStateExit>
      </State>
      <State Name="RETURN_TENDERS_OFFLINE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="219" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="1" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Property="OG_Guidance_Prop" Action="Set" Value="SUSPEND ERROR OPENING S/R KEY FILE" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Property="OG_Guidance_Prop" Action="Set" Value="" />
         </OnStateExit>
      </State>
      <State Name="RETURN_TENDERS">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="235" />
               <Field Name="msg_level" Equals="4" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="1" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Property="OG_Guidance_Prop" Action="Set" Value="RETURN TENDERS BEFORE SUSPENDING" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Property="OG_Guidance_Prop" Action="Set" Value="" />
         </OnStateExit>
      </State>
	   <!-- Start CRD 293100 new tb_int to trigger transfer start for Suspend/Resume Shop and Scan trx instead of Resume2_transaction context -->
	  <State Name="RESUME_STARTED_SR" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="acs_tb_interface">
				<Field Name="tb_int" Equals="1835" />
			</DetectContext>
         </Detect>
         <OnStateEnter>  
            <SetProperty Value="1" Action="Set" Property="IsResumeTrxInProgress" /> <!-- POS278643 aab -->		 
	    <SetProperty Value="0" Action="Set" Property="IsResumeComplete" />
	    <SetProperty Value="0" Action="Set" Property="IsResumeCompleteLocal" />
	<SetProperty Value="1" Action="Set" Property="IsResumeStarted" />
             <SetProperty Value="0" Action="Set" Property="IsResumeReady" />
            <SetProperty Value="1" Action="Set" Property="RecallModeWaitForMperks" />	<!-- CRD 293397 wait for mPerks before showing transfer complete -->
		<ResetContext Context="acs_tb_interface" />			
		<ResetContext Context="DF_DynaFrame_labels" />
         </OnStateEnter>
      </State>
	  <!-- End CRD 293100 -->
	  <State Name="RESUME_STARTED" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="Resume2_transaction"></DetectContext>
            <DetectProperty Property="IsResumeTrxInProgress" Equals="0" />
			<DetectProperty Property="IsACSIgnoreItemsOnResume" Equals="1" />
         </Detect>
         <Ignore>
            <Context Name="Item_entry_display" />
            <Context Name="Subtotal_running_display" />
            <Context Name="CM_Total_update" />
	    <Context Name="Process_or_blank" />

	    <!-- SOTF 8380 O2S RRS -->
	    <Context Name="O2S_box_id_disp" />
	    <!-- E SOTF 8380 O2S RRS -->
         </Ignore>
         <OnStateEnter>  
            <SetProperty Value="1" Action="Set" Property="IsResumeTrxInProgress" /> <!-- POS278643 aab -->		 
			<SetProperty Value="1" Action="Set" Property="IsResumeStarted" />
            <SetProperty Value="0" Action="Set" Property="IsResumeReady" />
            <ResetContext Context="Resume2_transaction" />
			<ResetContext Context="DF_DynaFrame_labels" />
         </OnStateEnter>
      </State>
	  <State Name="RESUME_STARTED_NOIGNORE" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="Resume2_transaction"></DetectContext>
            <DetectProperty Property="IsResumeTrxInProgress" Equals="0" />
			<DetectProperty Property="IsACSIgnoreItemsOnResume" Equals="0" />
         </Detect>
		 <Ignore>
            <Context Name="Subtotal_running_display" />
            <Context Name="CM_Total_update" />
			<Context Name="Process_or_blank" />
         </Ignore>
         <OnStateEnter>
		    <SetProperty Value="1" Action="Set" Property="IsResumeTrxInProgress" /> <!-- POS278643 aab -->
			<SetProperty Value="1" Action="Set" Property="IsResumeStarted" />
            <SetProperty Value="0" Action="Set" Property="IsResumeReady" />
            <ResetContext Context="Resume2_transaction" />
			<ResetContext Context="DF_DynaFrame_labels" />
         </OnStateEnter>
      </State>
      <!-- POS11024 Mobile Shopper Start -->
	  <State Name="RESUME_STARTED_MOBILE" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="acs_tb_interface">
				<Field Name="tb_int" Equals="1537" />
			</DetectContext>
            <DetectProperty Property="IsResumeTrxInProgress" Equals="0" />
			<DetectProperty Property="IsACSIgnoreItemsOnResume" Equals="1" />
         </Detect>
         <Ignore>
            <Context Name="Item_entry_display" />
            <Context Name="Subtotal_running_display" />
            <Context Name="CM_Total_update" />
	    <Context Name="Process_or_blank" />
	    <!-- SOTF 8380 O2S RRS -->
	    <Context Name="O2S_box_id_disp" />
	    <!-- E SOTF 8380 O2S RRS -->
         </Ignore>
         <OnStateEnter>  
        <SetProperty Value="1" Action="Set" Property="IsResumeTrxInProgress" /> <!-- POS278643 aab -->		 
	    <SetProperty Value="1" Action="Set" Property="IsResumeStarted" />
            <SetProperty Value="0" Action="Set" Property="IsResumeReady" />
	    <SetProperty Property="IsResumeTrxInProgress" Action="Set" Value="1" />
	    <SetProperty Value="0" Action="Set" Property="IsResumeComplete" />
	    <SetProperty Value="0" Action="Set" Property="IsResumeCompleteLocal" />
            <ResetContext Context="Resume2_transaction" />
	    <ResetContext Context="DF_DynaFrame_labels" />
         </OnStateEnter>
      </State>
	  <State Name="RESUME_STARTED_NOIGNORE_MOBILE" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="acs_tb_interface">
				<Field Name="tb_int" Equals="1537" />
			</DetectContext>
            <DetectProperty Property="IsResumeTrxInProgress" Equals="0" />
			<DetectProperty Property="IsACSIgnoreItemsOnResume" Equals="0" />
         </Detect>
		 <Ignore>
            <Context Name="Subtotal_running_display" />
            <Context Name="CM_Total_update" />
			<Context Name="Process_or_blank" />
         </Ignore>
         <OnStateEnter>
		<SetProperty Value="1" Action="Set" Property="IsResumeTrxInProgress" /> <!-- POS278643 aab -->
		<SetProperty Value="1" Action="Set" Property="IsResumeStarted" />
                <SetProperty Value="0" Action="Set" Property="IsResumeReady" />
		<SetProperty Property="IsResumeTrxInProgress" Action="Set" Value="1" />
		<SetProperty Value="0" Action="Set" Property="IsResumeComplete" />
		<SetProperty Value="0" Action="Set" Property="IsResumeCompleteLocal" />
	        <SetProperty Property="PropMobShopOrderPrompt" Action="Set" Value="1" /> <!-- POS31050 rrs -->
                <ResetContext Context="Resume2_transaction" />
		<ResetContext Context="DF_DynaFrame_labels" />
         </OnStateEnter>
      </State>
      <!-- POS11024 Mobile Shopper End -->
     <!--<State Name="RESUME_READY" Group="IGNORE_POSSTATE">
         <Detect>
			<DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="48" />
            </DetectContext>
			<DetectProperty Property="IsResumeStarted" Equals="1" />
			<DetectProperty Property="IsResumeReady" Equals="0" />
			<DetectProperty Property="IsSCOFLMS" Equals="0" />	 make sure that this is not a mobile transaction 
         </Detect>
         <OnStateEnter>
			<SetProperty Value="1" Action="Set" Property="IsResumeReady" />
			<ResetContext Context="DF_DynaFrame_labels" />
			<SendInput Input="PAYMENT" />
         </OnStateEnter>
      </State>-->
      <State Name="RESUME_COMPLETE">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" RegEx="^((48)|(58)|(59)|(786)|(788))$" />  <!-- sotf 9034 adding o2s and signature as resume complete rrs -->
            </DetectContext>
            <DetectProperty Property="IsResumeTrxInProgress" Equals="1" />
            <DetectProperty Property="IsResumeComplete" Equals="0" />
			<DetectProperty Property="IsResumeCompleteLocal" Equals="0" />
         </Detect>
         <OnStateEnter>
            <SetProperty Value="1" Action="Set" Property="IsResumeComplete" />
			<SetProperty Value="1" Action="Set" Property="IsResumeCompleteLocal" />
			<!-- POS9528 Remove setting of IsResumeStarted
			<SetProperty Value="0" Action="Set" Property="IsResumeStarted" />
			   POS9528-->
			<SetProperty Value="0" Action="Set" Property="IsResumeReady" />
	    <!-- pos 10308 rrs -->
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
	    <!-- e - pos 10308 rrs -->

	    <!-- START POS31050 rrs -->
   	    <SetProperty Value="0" Action="Set" Property="PropMobShopOrderPrompt" /> 
	    <SetProperty Value="0" Action="Set" Property="VoidPrepaidCards" />
	    <!-- EBD POS31050 rrs -->
         </OnStateEnter>
      </State>
	  <State Name="VOIDING" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="Item_entry_display">
			   <Field Name="item_code" Equals="VOID"/> 
            </DetectContext>
		<DetectProperty Property="IsVoiding" Equals="0" />
		</Detect>
		 <OnStateEnter>
			<SetProperty Property="IsVoiding" Action="Set" Value="1" />
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
		 </OnStateEnter> 
		  <OnStateExit>
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>	

      <!-- POS39158 rrs -->
      <State Name="MEIJER_COUPON">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="196" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
         </OnStateEnter>
      </State>
      <!-- e POS39158 -->	 	

      <!-- SOTF6400 BEGIN -->
      <State Name="DIGITAL_COUPON" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
		<Field Name="dynaframe_id" Equals="889" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
	    <ResetContext Context="DF_DynaFrame_labels" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
        </OnStateExit>
      </State>

      <!-- POS14806 DIGITAL COUPON PIN ENTRY -->
      <State Name="DIGITAL_COUPON_PIN_ENTRY" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
		<Field Name="dynaframe_id" Equals="890" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
	    <ResetContext Context="DF_DynaFrame_labels" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
        </OnStateExit>
      </State>
      <!-- E POS14806 DIGITAL COUPON PIN ENTRY -->
	  <!-- (+)POS317537 / SSCOI-49078: Handle the mPerks Retry limit OP message -->
	  <State Name="MPERKS_RETRY_LIMIT_EXCEEDED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1515" />
               <Field Name="msg_level" Equals="2" />
            </DetectContext>
         </Detect>
      </State>
	  <!-- (-) POS317537 / SSCOI-49078 -->
      <!-- POS15434 INVALID MPERKS PIN -->
     <State Name="MESSAGE_300_2_INVALID_MPERKS_PIN">
         <Detect>
            <DetectContext Context="Operator_guidance">
			   <Field Name="Guidance_for_operator" Contains="Invalid mPerks PIN" />
               <Field Name="msg_num" Equals="300" />
               <Field Name="msg_level" Equals="2" />
            </DetectContext>
         </Detect>
      </State>     
      <!-- E POS15434 INVALID MPERKS PIN -->

     <!-- POS106936 MPERKS PROMPT CC -->
     <State Name="DO_YOU_WANT_MPERKS" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="Operator_guidance">			   
               <Field Name="msg_num" Equals="1659" />
               <Field Name="msg_level" Equals="3" />
            </DetectContext>
         </Detect>
		 <OnStateEnter>
           <SetProperty Property="HookPropMperksPrompt" Action="Set" Value="1" />
        </OnStateEnter>
      </State>     
      <!-- E POS106936 MPERKS PROMPT CC -->
      <!-- POS277295 -->
	  <State Name="MPERKS_ACTIVITY_DETECTED" Group="IGNORE_POSSTATE">
         <Detect>
			<DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="800" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
		   <SendControl Control="ACSReward" />
		   <ResetContext Context="acs_tb_interface" />
		   <SetProperty Property="IsFrom800acs_tb_interface" Action="Set" Value="1" />
         </OnStateEnter>
      </State>
       <!-- POS277295 -->
	  <!-- +POS291625 -->
      <State Name="ENTER_MPERKS_PASSPORT_PIN" IgnoreDuplicate="true">
         <Detect>
             <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="801" />
             </DetectContext>
         </Detect>
         <OnStateEnter>
		   <ResetContext Context="acs_tb_interface" />
         </OnStateEnter>
      </State>
       <!-- -POS291625 -->
      <State Name="DIGITAL_COUPON_ACTIVE">
         <Detect>
			<DetectContext Context="FSCardEntered_display" >
			   <Field Name="account_number" Equals="" Negate="true" />
			</DetectContext>
			<DetectProperty Property="IsFrom800acs_tb_interface" Equals="0" /> 
         </Detect>
         <OnStateEnter>
		   <SetProperty Property="RecallModeWaitForMperks" Action="Set" Value="0" />	<!-- CRD 628007 -->
           <ResetContext Context="FSCardEntered_display" />
         </OnStateEnter>
      </State>
	  <!-- +bug265521 -->
	  <State Name="FSCARD_ENTERED" >
         <Detect>
			<!--FSCardEntered is used instead of FSCardEntered_display when full buffered receipt feature is turned off. -->
            <DetectContext Context="FSCardEntered" >
			   <Field Name="account_number" Equals="" Negate="true" />
			</DetectContext>
			<!--FSCardEntered is outputted also during tendering so prevent it here to get rid of multiple display -->
			<DetectProperty Property="IsTendering" Equals="0" />
			<DetectProperty Property="IsFrom800acs_tb_interface" Equals="0" />
         </Detect>
         <OnStateEnter>
		   <SetProperty Property="RecallModeWaitForMperks" Action="Set" Value="0" />	<!-- CRD 628007 -->
           <ResetContext Context="FSCardEntered" />
         </OnStateEnter>
      </State>
	  <State Name="FSCARD_SCANNED">
         <Detect>
            <DetectContext Context="FSCardEntered" >
			   <Field Name="account_number" Equals=""/>
			</DetectContext>
			<!--FSCardEntered is outputted also during tendering so prevent it here to get rid of multiple display -->
			<DetectProperty Property="IsTendering" Equals="0" />
			<DetectProperty Property="IsFrom800acs_tb_interface" Equals="0" />
         </Detect>
         <OnStateEnter>
           <ResetContext Context="FSCardEntered" />
		   <SetProperty Property="RecallModeWaitForMperks" Action="Set" Value="0" />	<!-- CRD 628007 -->
         </OnStateEnter>
      </State>
	  <State Name="FSCARD_SCANNED" >
         <Detect>
			<DetectContext Context="FSCardEntered_display" >
			   <Field Name="account_number" Equals=""/>
			</DetectContext>
			<DetectProperty Property="IsFrom800acs_tb_interface" Equals="0" />
         </Detect>
         <OnStateEnter>
           <ResetContext Context="FSCardEntered_display" />
         </OnStateEnter>
      </State>
	  <!-- Start CRD 130212 EAS item -->
	  <State Name="EAS_ITEM">
         <Detect>
            <DetectContext Context="acs_tb_interface">
				<Field Name="tb_int" Equals="1830" />
			</DetectContext>
         </Detect>
         <OnStateEnter>  
			<SetProperty Value="1" Action="Set" Property="IsAnEASItem" /> 	 
			<ResetContext Context="acs_tb_interface" />	
			<ResetContext Context="DF_DynaFrame_labels" />	
         </OnStateEnter>
      </State>
	  <!-- End CRD 130212 -->
	  <!-- Start CRD 223409 -->
	  <State Name="MOBILE_GENERIC_DELAYED">
         <Detect>
            <DetectContext Context="acs_tb_interface">
				<Field Name="tb_int" Equals="1833" />
			</DetectContext>
         </Detect>
         <OnStateEnter>  
			<SetProperty Value="1" Action="Set" Property="IsMobileGenericDelayed" /> 	 
			<ResetContext Context="acs_tb_interface" />	
			<ResetContext Context="DF_DynaFrame_labels" />	
         </OnStateEnter>
      </State>
	  <!-- End CRD 223409 -->
	  <!-- Start CRD 554915 -->
	  <State Name="ACCOUNT_LOOKUP_SUCCESS">
         <Detect>
            <DetectContext Context="acs_tb_interface">
				<Field Name="tb_int" Equals="804" />
				<Field Name="tb_long" Equals="0" />
			</DetectContext>
         </Detect>
         <OnStateEnter>
			<ResetContext Context="acs_tb_interface" />	
			<ResetContext Context="DF_DynaFrame_labels" />	
         </OnStateEnter>
      </State>
	  <State Name="ACCOUNT_LOOKUP_FAIL">
         <Detect>
            <DetectContext Context="acs_tb_interface">
				<Field Name="tb_int" Equals="804" />
				<Field Name="tb_long" Equals="1" />
			</DetectContext>
         </Detect>
         <OnStateEnter>   
			<ResetContext Context="acs_tb_interface" />	
			<ResetContext Context="DF_DynaFrame_labels" />	
         </OnStateEnter>
      </State>
	  <!-- Start CRD 564271 -->
	  <State Name="APPLY_MEIJER_CARD_OPTIONS" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="acs_tb_interface">
				<Field Name="tb_int" Equals="805" />
			</DetectContext>
         </Detect>
         <OnStateEnter>
			<SendControl Control="ApplyMeijerCardProperties" />
			<ResetContext Context="acs_tb_interface" />
         </OnStateEnter>
      </State>
	  <!-- End CRD 564271 -->
        <!-- bug277095  -->	  
      <State Name="DIGITAL_COUPON_ALREADY_IN_TRANSACTION_CANCEL" Group="DIGITAL_COUPON_ALREADY_IN_TRANSACTION">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1405" />
               <Field Name="msg_level" Equals="2" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
           <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
		   <SetProperty Value="{F2}" Action="Set" Property="ResponseCodeToSendToPOS" />
           <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateExit>
      </State>
      <!-- -bug265521 -->	  
      <State Name="DIGITAL_COUPON_ALREADY_IN_TRANSACTION">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1405" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
           <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
		   <!-- POS36318 send the F1 after customer acknowledging the error rrs -->
		   <SetProperty Value="{F1}" Action="Set" Property="ResponseCodeToSendToPOS" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateExit>
      </State> 	  
	  <State Name="MPERKS_ENROLLMENT">
	     <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="1016" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels"/>
         </Detect>
         <OnStateEnter>
           <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateExit>
      </State>
	  <!-- Start CRD 241533 -->
	  <State Name="DIGITAL_COUPON_INVALID_BARCODE_STOREMODE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1406" />
            </DetectContext>
			<DetectProperty Property="IsInStoreMode" Equals="1" />
         </Detect>
         <OnStateEnter>
		   <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
            <SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />	
            <SetProperty Property="IsFromUnHandledOG" Action="Set" Value="1" />
           <SendControl Control="Display" />
			<ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
	  <!-- End CRD 241533 -->
      <State Name="DIGITAL_COUPON_INVALID_BARCODE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1406" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
           <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
		   <!-- POS36318 send the F1 after customer acknowledging the error rrs -->
		   <SetProperty Value="{F1}" Action="Set" Property="ResponseCodeToSendToPOS" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateExit>
      </State>
	  <!-- Start CRD 241533 -->
	  <State Name="DIGITAL_COUPON_NOT_A_MEMBER_STOREMODE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1407" />
            </DetectContext>
			<DetectProperty Property="IsInStoreMode" Equals="1" />
         </Detect>
         <OnStateEnter>
		   <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
            <SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />	
            <SetProperty Property="IsFromUnHandledOG" Action="Set" Value="1" />
			<SendControl Control="Display" />
			<ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
	  <!-- End CRD 241533 -->
	  
      <State Name="DIGITAL_COUPON_NOT_A_MEMBER">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1407" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
           <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
		   <!-- POS36318 send the F1 after customer acknowledging the error rrs -->
		   <SetProperty Value="{F1}" Action="Set" Property="ResponseCodeToSendToPOS" />		   
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateExit>
      </State>
	  <!-- Start CRD 232271 -->
	  <State Name="DIGITAL_COUPON_LOOKUP_FAILED_STOREMODE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1408" />
            </DetectContext>
			<DetectProperty Property="IsInStoreMode" Equals="1" />
         </Detect>
         <OnStateEnter>
			<SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
            <SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />	
            <SetProperty Property="IsFromUnHandledOG" Action="Set" Value="1" />
            <SendControl Control="Display" />
			<ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
	  <!-- End CRD 232271 -->
      <State Name="DIGITAL_COUPON_LOOKUP_FAILED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1408" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
           <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
		   <!-- POS36318 send the F1 after customer acknowledging the error rrs -->
		   <SetProperty Value="{F1}" Action="Set" Property="ResponseCodeToSendToPOS" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateExit>
      </State>
	  <!-- Start CRD 232271 -->
	  <State Name="DIGITAL_COUPON_NO_PROMOTION_STOREMODE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1409" />
            </DetectContext>
			<DetectProperty Property="IsInStoreMode" Equals="1" />
         </Detect>
         <OnStateEnter>
		   <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
            <SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />	
            <SetProperty Property="IsFromUnHandledOG" Action="Set" Value="1" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
	  <!-- End CRD 232271 -->
      <State Name="DIGITAL_COUPON_NO_PROMOTION">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1409" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
           <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
		   <!-- POS36318 send the F1 after customer acknowledging the error rrs -->
		   <SetProperty Value="{F1}" Action="Set" Property="ResponseCodeToSendToPOS" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateExit>
      </State>
    <State Name="DIGITAL_COUPON_PROMO_ENTRY_ENABLED" Group="IGNORE_POSSTATE">
	 <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="764" />
               <Field Name="tb_long" Equals="1" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="acs_tb_interface" />
			<SetProperty Property="EnableDigitalCoupons" Action="Set" Value="1" />
	    <SendControl Control="Display" />
         </OnStateEnter>
      </State>
    <State Name="DIGITAL_COUPON_PROMO_ENTRY_DISABLED" Group="IGNORE_POSSTATE">
	 <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="764" />
               <Field Name="tb_long" Equals="0" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="acs_tb_interface" />
            <SetProperty Property="RecallModeWaitForMperks" Action="Set" Value="0" />	<!-- CRD 293397 -->
			<SetProperty Property="EnableDigitalCoupons" Action="Set" Value="0" />
	    <SendControl Control="Display" />
         </OnStateEnter>
    </State>
      <!-- SOTF6400 END -->
	  <!-- (+) CRD 139942 -->
	  <State Name="DIGITAL_COUPON_LOOKUP_ENABLED_TRAININGMODE">
		<Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="1831" />
            </DetectContext>
			<DetectProperty Property="IsInTrainingMode" Equals="1"/>
        </Detect>
		<OnStateEnter>
			<ResetContext Context="acs_tb_interface" />
        </OnStateEnter>
      </State>
	  <!-- (-) CRD 139942 -->
      <!-- SOTF5803 SOTF6327-->
      <!-- POS27359: Map only msg #1357 to RESTRICTED_USE_COUPON_ALREADY_USED, not msg #1360 -->
      <State Name="RESTRICTED_USE_COUPON_ALREADY_USED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1357" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="RESTRICTED_USE_COUPON_INVALID">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" RegEx="^((1354)|(1361))$" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="RESTRICTED_USE_COUPON_CONDITION_NOT_MET">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1362" />
            </DetectContext>
         </Detect>
      </State>      
      <State Name="RESTRICTED_USE_COUPON_ASSIST">
         <Detect>
            <DetectContext Context="Operator_guidance">
              <Field Name="msg_num" RegEx="^(135[5-6])|(135[8-9])$" />
            </DetectContext>
         </Detect>
      </State>            
      <!-- SOTF5803 END -->

      <!-- POS31050 MOBILE ENHANCEMENT START -->
      <State Name="MOBILE_TRANSACTION_ASSISTANCE">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
		<Field Name="dynaframe_id" Equals="618" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
	    <SetProperty Value="0" Action="Set" Property="PropIsPrcVerify" />  <!-- POS31053 - reset the IsPriceVerify flag rrs -->
	    <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
            <SetProperty Value="0" Action="Set" Property="PropIsProcessingItem" />
            <SetProperty Value="0" Action="Set" Property="PropIsVoidItem" />
	    <SetProperty Value="0" Action="Set" Property="VoidPrepaidCards" />  <!-- POS60208 rrs -->
	    <SendControl Control="Display" />

	    <ResetContext Context="DF_DynaFrame_labels" />  <!-- POS31051 Reset context DF label -->
         </OnStateEnter>
         <OnStateExit>
   	    <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />			
         </OnStateExit>
      </State>

      <State Name="MOBILE_STREAMLINE_ITEM_INFO">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="1573" />   <!-- POS42003 renumber -->
            </DetectContext>
         </Detect>
         <OnStateEnter>
	      <ResetContext Context="acs_tb_interface" />
         </OnStateEnter>
         <OnStateExit>
         </OnStateExit>
      </State>	

      <!-- e POS31050 MOBILE ENHANCEMENT START -->

      <!-- POS27359: Added RESTRICTED_USE_COUPON_ACCEPTED for msg #1363 -->
      <State Name="RESTRICTED_USE_COUPON_ACCEPTED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1363" />
            </DetectContext>
         </Detect>
      </State>
      <!-- POS27359: Added RESTRICTED_USE_COUPON_ALREADY_APPLIED_TO_TRX for msg #1360 -->
      <State Name="RESTRICTED_USE_COUPON_ALREADY_APPLIED_TO_TRX">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1360" />
            </DetectContext>
         </Detect>
      </State>
      <!-- POS11024 MOBILE SHOPPER START -->
      <State Name="MOBILE_TRANSACTION_VERIFICATION_NEEDED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1526" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
	    <SetProperty Value="1" Action="Set" Property="PropIsOperGuid" /> <!-- POS31050 rrs -->
            <SendControl Control="Display" />
  	    <ResetContext Context="Operator_guidance" /> <!-- POS31051 reset the OG context -->
         </OnStateEnter>
         <OnStateExit>
            <ResetControl Control="Display" /> <!-- POS31051 reset the OG context -->
         </OnStateExit>
      </State>
	  <!--Set Return to Shopping off during MOBILE_AUDIT-->

      <!-- POS31051 Handling mobile audit with plu rrs -->
      <State Name="MOBILE_AUDIT_WITH_PLU" Group="MOBILE_AUDIT" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="603" />
               <Field Name="leadthru_1" Contains="key-in PLU code" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="acs_tb_interface" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />	
            <SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> <!-- POS31051 Display the keypad -->		
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" /> <!-- POS73665 -->
         </OnStateEnter>
         <OnStateExit>
            <ResetContext Context="DF_DynaFrame_labels" />		     
            <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> <!-- POS31051 hide the keypad -->		
         </OnStateExit>
      </State>
      <!-- e POS31051 rrs -->

      <State Name="MOBILE_AUDIT" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="603" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="acs_tb_interface" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />			
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" /> <!-- POS73665 -->
         </OnStateEnter>
         <OnStateExit>
            <ResetContext Context="DF_DynaFrame_labels" />		     
         </OnStateExit>
      </State>
      <State Name="ITEM_NOT_FOUND_IN_MOBILE_ORDER">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1528" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateExit>
      </State>
      <State Name="CANCEL_MOBILE_TRANSACTION">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1529" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />

            <ResetControl Control="Display" /> <!-- POS31050 reset the OG context -->
         </OnStateExit>
      </State>
      <State Name="MOBILE_VERIFIED_ITEMS">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="1530" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
	        <ResetContext Context="DF_DynaFrame_labels" />
	        <ResetContext Context="acs_tb_interface" />
         </OnStateEnter>
         <OnStateExit>
         </OnStateExit>
      </State>

      <State Name="ITEM_ADDED_IN_MOBILE_ORDER">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" RegEx="^((1538)|(1550))$" />  <!-- POS31053 rrs -->
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
			<SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
            <SendControl Control="Display" />
  	    <ResetContext Context="Operator_guidance" /> <!-- POS31051 reset the OG context -->
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <ResetControl Control="Display" /> <!-- POS31051 reset the OG context -->
         </OnStateExit>
      </State>

<!-- POS31052 Handling Mobile Audit Unique Item error context -->
      <State Name="MOBILE_AUDIT_UNIQUE_ITEM" Group="MOBILE_AUDIT">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1548" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="IsSupervisorApproval" Action="Set" Value="0" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
	    <SendControl Control="Display" />

	    <ResetContext Context="Operator_guidance" /> 
	</OnStateEnter>
	<OnStateExit>
	    <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
	    <ResetControl Control="Display" /> <!-- POS31051 reset the OG context -->
	</OnStateExit>
      </State>
<!-- e POS31052 Handling Mobile Audit Unique Item error context -->

      <!-- E POS11024 MOBILE SHOPPER -->

      <!-- SOTF 7582 -->
      <State Name="ONCE_AND_DONE_COUPON_UNRECOGNIZED_PROMOTION">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1424" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="ONCE_AND_DONE_COUPON_CONDITION_NOT_MET">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1425" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="ONCE_AND_DONE_COUPON_PREVIOUSLY_REDEEMED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1426" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="ONCE_AND_DONE_PROMOTION_EXPIRED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1427" />
            </DetectContext>
         </Detect>
      </State>
       <!-- BEGIN SOTF8854 -->
       <State Name="CCM_FULL_APPROVAL">
           <Detect>
               <DetectContext Context="Operator_guidance">
                   <Field Name="msg_num" Equals="1463" />
               </DetectContext>
           </Detect>
       </State>
       <State Name="CCM_PARTIAL_APPROVAL">
           <Detect>
               <DetectContext Context="Operator_guidance">
                   <Field Name="msg_num" Equals="1464" />
               </DetectContext>
           </Detect>
       </State>
       <!-- END SOTF8854-->
      <!-- sotf 7852 -->        
      <State Name="DISABLE_MORE_BUTTON_DEPTMENU"> <!-- TAR 322891 -->
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="754" />
            </DetectContext>
            <DetectProperty Property="DK5_Grayed_Prop" Equals="1" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="1" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="ITEMMENU_DK2" Group="ITEMMENU_DK1">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="48" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="icon_desc_8" Contains="(Page 2 of" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
		    <SetProperty Property="WICTransaction" Action="Set" Value="0" />
		    <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>
      <State Name="ITEMMENU_DK3" Group="ITEMMENU_DK1">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="48" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="icon_desc_8" Contains="(Page 3 of" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
		    <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>
      <State Name="REBATE_NOT_ALLOWED">
         <Detect>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="normal_label_3" Contains="Duplicate Rebate Receipt" />
			   <Field Name="label_asa_3" Equals="1" />
            </DetectContext>
            <DetectProperty Property="RebateReceiptRequested" Equals="1" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaKey_labels" />
        </OnStateEnter>
      </State>
      <State Name="FORCE_LOAD">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="383" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels"></DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaKey_labels" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <SetProperty Property="ForceLoadRequested" Action="Set" Value="1" />
         </OnStateEnter>
      </State>
      <State Name="ITEMMENU_DEPARTMENT">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="285" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels"></DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <ResetContext Context="DF_DynaKey_labels" />
         </OnStateEnter>
      </State>
      <State Name="VARIABLE_COUPON_VALUE" Group="PRICE_REQUIRED" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="339" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels" />
            <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaKey_labels" />
            <ResetContext Context="DF_DynaFrame_labels" />
         </OnStateEnter>
         <OnStateExit>
            <ResetContext Context="DF_DynaFrame_labels" />
         </OnStateExit>
      </State>
      <State Name="VARIABLE_COUPON_VALUE_INVALID" Group="PRICE_REQUIRED_INVALID" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="339" />
            </DetectContext>
            <DetectProperty Property="IsResumeStarted" Equals="0" />
            <DetectContext Context="Error_tone" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Error_tone" />
            <ResetContext Context="DF_DynaFrame_labels" />
         </OnStateEnter>
      </State>
      <State Name="COUPON_VALUE_FAILED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="360" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="1" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Property="OP_Guidance_Txt" Action="Set" Value="TRANS LIMIT EXCEEDED" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>    
      <!--SOTF 7701 -->
      <!-- SOTF 8008 - Removed IgnoreDuplicate="true" so that repeated invalid entries will still cause a prompt -->
      <State Name="PRICE_REQUIRED_RETRY" Group="PRICE_REQUIRED">
         <Detect>           
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="leadthru_1" Contains="INVALID AMT" />
               <Field Name="dynaframe_id" Equals="90" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
	    <SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> <!-- POS31050 Display the keypad -->
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />  <!-- POS31050 enable log out button -->
         </OnStateEnter>
         <OnStateExit>
            <ResetContext Context="DF_DynaFrame_labels" />
	    <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> <!-- POS31050 rrs -->
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />  <!-- POS31050 reset the log out button -->
         </OnStateExit>
      </State>
      <!-- sotf -->
      <State Name="PRICE_REQUIRED_INVALID" Group="PRICE_REQUIRED" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="90" />
            </DetectContext>
            <DetectContext Context="Error_tone" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Error_tone" />
            <ResetContext Context="DF_DynaFrame_labels" />
         </OnStateEnter>
      </State>

<!-- POS143713 RRS -->
      <State Name="TSP_CONFIRMATION" >
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">               
               <Field Name="dynaframe_id" Equals="639" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
	</OnStateEnter>
	<OnStateExit>
		<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
	</OnStateExit>
      </State>
<!-- POS143713 RRS -->
      
	  <State Name="PRICE_REQUIRED">
         <Detect>
            <DetectContext Context="Alert_tone" />
            <DetectContext Context="DF_DynaFrame_labels">               
               <Field Name="dynaframe_id" Equals="90" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Alert_tone" />
            <ResetContext Context="DF_DynaFrame_labels" />
	    <SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> <!-- POS31050 Display the keypad -->

            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />  <!-- POS31050 enable log out button -->
            <SendControl Control="Display" />			  <!-- POS31050 reset the OG context -->
         </OnStateEnter>
         <OnStateExit>
            <ResetContext Context="DF_DynaFrame_labels" />
	    <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> <!-- POS31050 Display the keypad -->

            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />  <!-- POS31050 keep the log out button visible -->
         </OnStateExit>
      </State>
      <!-- POS55609: Added PRICE_REQUIRED_INVALID_AMOUNT state to allow transitioning of POS states during invalid amount entries -->
      <State Name="PRICE_REQUIRED_INVALID_AMOUNT">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1606" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetControl Control="Display" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="" />
            <SetProperty Property="Title2_Prop" Action="Set" Value="" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <!-- POS52017: Added PRICE_REQUIRED_COUPON to take care of coupon family code 992 which means that the coupon validation -->
      <!-- is bypassed and the cashier intervenes by entering the coupon amount. -->
      <State Name="PRICE_REQUIRED_COUPON">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">               
               <Field Name="leadthru_1" Contains="Key-in" />
               <Field Name="leadthru_2" Contains="992" />     <!-- Coupon family code 992 -->
               <Field Name="dynaframe_id" Equals="90" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
            <!-- If attendant goes into Assist Mode, use PropertyAllowAMExit to prevent exiting until coupon price is entered. -->
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SendControl Control="Display" />			  <!-- Reset the operator guidance context -->
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateExit>
      </State>
      <State Name="ENTER_NEW_PRICE" Group="PRICE_REQUIRED">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="286" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="New Item Price" />
            <SetProperty Property="Title2_Prop" Action="Set" Value="" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Enter a price for the new item" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK3_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK4_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK5_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK6_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK7_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK8_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="1" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>

      <!-- POS31050 rrs -->
      <State Name="COLLECT_CANCEL_ITEM">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1570" />
            </DetectContext>
         </Detect>
	<OnStateExit>
		<ResetControl Control="Display"/> 
         </OnStateExit>
      </State>
      <!-- e POS31050 rrs -->

      <State Name="WEIGHT_REQUIRED">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="96" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels"></DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaKey_labels" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="DUPLICATE_REBATE_RECEIPT_AMOUNT" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="844" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <ResetContext Context="DF_DynaFrame_labels" />
         </OnStateEnter>
      </State>
      <State Name="DUPLICATE_REBATE_RECEIPT_TOOMANY">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1214" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="ELECTRONIC_WARRANTY_REQUIRED" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="881" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
			<SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
			
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />  <!-- 104240 -->
			
            <SendControl Control="Display" />
            <ResetContext Context="DF_DynaFrame_labels" />			
         </OnStateEnter>
         <OnStateExit>
			<SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
         </OnStateExit>
      </State>
      <State Name="NINTENDO_WARRANTY">
         <Detect>
            <DetectContext Context="Nintendo_disply" />
	    <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />  <!-- 104240 -->
			
            <ResetContext Context="Nintendo_disply" />
         </OnStateEnter>
      </State>
      <State Name="TARE_REQUIRED">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="75" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels"></DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaKey_labels" />
            <ResetContext Context="DF_DynaFrame_labels" />
         </OnStateEnter>
      </State>
      <State Name="INVALID_CARD_NUMBER">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="58" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="normal_label_3" Equals="ELEC. PYMT SELECTED" />
               <Field Name="normal_desc_3" Contains="NOT VALID" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="EntryData_Prop" Action="Set" Value="" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>

<!-- sotf 8908 rrs -->
      <State Name="INVALID_CARD_NUMBER2">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1027" />
               <Field Name="msg_level" Equals="2" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="EntryData_Prop" Action="Set" Value="" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>
<!-- E sotf 8908 rrs -->
		<State Name="QUICKCHIP_AT_ITEMIZATION" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="802" />               
            </DetectContext>
            <DetectProperty Property="PropIsFromPayment" Equals="0" />            
         </Detect>
         <OnStateEnter>
		    <ResetContext Context="acs_tb_interface" />
            <SetProperty Property="IsQuickChipAtItemization" Action="Set" Value="1" />			
         </OnStateEnter>
      </State>
	  <State Name="QUICKCHIP_REMOVED_AT_ITEMIZATION" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="803" />               
            </DetectContext>
            <DetectProperty Property="PropIsFromPayment" Equals="0" />            
         </Detect>
         <OnStateEnter>
		    <ResetContext Context="acs_tb_interface" />
            <SetProperty Property="IsQuickChipAtItemization" Action="Set" Value="0" />			
         </OnStateEnter>
      </State>
	  <State Name="QUICKCHIP_REMOVED_AT_PAYMENTMENU" Group="PAYMENTMENU_DK1">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="803" />               
            </DetectContext>
            <DetectProperty Property="PropIsFromPayment" Equals="1" />            
         </Detect>
         <OnStateEnter>
		    <ResetContext Context="acs_tb_interface" />
            <SetProperty Property="IsQuickChipAtItemization" Action="Set" Value="0" />			
         </OnStateEnter>
      </State>
	  <State Name="WAITING_ON_PINPAD_QUICK_CHIP_WAS_INSERTED" Group="WAITING_ON_PINPAD4">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="58" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="normal_desc_3" Equals="" />
               <Field Name="icon_desc_8" Contains="(Page 1 of" />
            </DetectContext>
			<DetectProperty Property="IsQuickChipAtItemization" Equals="1" />
         </Detect>
         <OnStateEnter>
            <SetProperty Value="1" Action="Set" Property="PropIsFromPayment" /> <!-- POS320733 -->
            <SetProperty Property="IsQuickChipAtItemization" Action="Set" Value="0" />
            <SetProperty Property="EntryData_Prop" Action="Set" Value="" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <SetProperty Property="IsTendering" Action="Set" Value="1" />
            <SetProperty Property="GiftCardInUse" Action="Set" Value="1" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>
	  <State Name="WAITING_ON_PINPAD_QUICK_CHIP_INSERTED" Group="WAITING_ON_PINPAD4">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="802" />               
            </DetectContext>
            <DetectProperty Property="PropIsFromPayment" Equals="1" />            
         </Detect>
         <OnStateEnter>
		    <ResetContext Context="acs_tb_interface" />
            <SetProperty Property="IsQuickChipAtItemization" Action="Set" Value="0" />			
         </OnStateEnter>
      </State>
      <!-- POS50538 50539 OTC Tender rrs -->
      <State Name="OTC_TENDER_SELECTED" Group="CUSTOMER_TENDER_SELECTED">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="58" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="normal_label_3" Equals="ELEC. PYMT SELECTED" />
               <Field Name="normal_desc_3" Contains="(OTC CARD" />
	       	   <!-- <Field Name="label_asa_6" Equals="1" /> POS102483 CASH is in F6 -->
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="EntryData_Prop" Action="Set" Value="" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <SetProperty Property="IsTendering" Action="Set" Value="1" />
            <SetProperty Property="ForStreamlineEPaymentCredit" Action="Set" Value="" />
         </OnStateEnter>
         <OnStateExit>	
	    <SetProperty Property="CustRequestCreditBtn" Action="Set" Value="1" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>
      <!-- e POS50538 50537 rrs -->

      <State Name="GIFTCARD_TRANS" Group="CUSTOMER_TENDER_SELECTED">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="58" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="normal_label_3" Equals="ELEC. PYMT SELECTED" />
               <Field Name="normal_desc_3" Contains="(GIFT" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="EntryData_Prop" Action="Set" Value="" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <SetProperty Property="IsTendering" Action="Set" Value="1" />
            <SetProperty Property="GiftCardInUse" Action="Set" Value="1" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>
      <!-- <State Name="SET_REQUEST_FOR_CREDIT2" Group="IGNORE_POSSTATE">
         <Detect>
	    <DetectContext Context="DF_DynaKey_labels">
		<Field Name="normal_label_6" Contains="CREDIT" />
		<Field Name="label_asa_6" Equals="0" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
			<SetProperty Property="CustRequestCreditBtn" Action="Set" Value="0" />
         </OnStateEnter>
      </State> -->
      <State Name="CUSTOMER_TENDER_SELECTED">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="58" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="normal_label_3" Equals="ELEC. PYMT SELECTED" />
               <Field Name="normal_desc_3" Contains="(" />
	           <!-- <Field Name="label_asa_6" Equals="1" /> POS102483 CASH is in F6 -->
            </DetectContext>
			<DetectProperty Property="IsGoingBackToItemMenu" Equals="0" /> <!-- POS323036 -->
         </Detect>
         <OnStateEnter>
			<SetProperty Property="IsQuickChipAtItemization" Action="Set" Value="0" />
            <SetProperty Property="EntryData_Prop" Action="Set" Value="" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <SetProperty Property="IsTendering" Action="Set" Value="1" />
            <SetProperty Property="ForStreamlineEPaymentCredit" Action="Set" Value="" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" /> <!-- POS214059 rrs -->
         </OnStateEnter>
         <OnStateExit>	
	    <SetProperty Property="CustRequestCreditBtn" Action="Set" Value="1" />
            <!-- CRD 299390 <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />-->
         </OnStateExit>
      </State>
	  <!-- POS324040 / POS324438-->
	  <State Name="NEED_GOBACK_TO_ITEMMENU" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="58" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="normal_label_3" Equals="ELEC. PYMT SELECTED" />
               <Field Name="normal_desc_3" Contains="(" />
	           <!-- <Field Name="label_asa_6" Equals="1" /> POS102483 CASH is in F6 -->
            </DetectContext>
            <DetectProperty Property="IsGoingBackToItemMenu" Equals="1" /> <!-- POS323036 -->
         </Detect>		 
         <OnStateEnter>
		    <SetProperty Property="IsQuickChipAtItemization" Action="Set" Value="0" />
            <SetProperty Property="EntryData_Prop" Action="Set" Value="" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <SetProperty Property="IsTendering" Action="Set" Value="1" />
            <SetProperty Property="ForStreamlineEPaymentCredit" Action="Set" Value="" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" /> <!-- POS214059 rrs -->
			<SendInput Input="ITEM" />
         </OnStateEnter>
         <OnStateExit>	
	    <SetProperty Property="CustRequestCreditBtn" Action="Set" Value="1" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>
      <State Name="CUSTOMER_TENDER_SELECTED2" Group="CUSTOMER_TENDER_SELECTED">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="58" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="normal_label_3" Equals="ELEC. PYMT SELECTED" />
               <Field Name="normal_desc_3" Contains="(" />
	       <Field Name="normal_label_6" Contains="CREDIT" />
	       <Field Name="label_asa_6" Equals="0" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
	    <SetProperty Property="CustRequestCreditBtn" Action="Set" Value="0" />
            <SetProperty Property="EntryData_Prop" Action="Set" Value="" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <SetProperty Property="IsTendering" Action="Set" Value="1" />
            <SetProperty Property="ForStreamlineEPaymentCredit" Action="Set" Value="" />	
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" /> <!-- POS214059 rrs -->
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>
      <State Name="PROMPT_APPLY_EBT_BALANCE" Group="PAYMENTMENU_DK1">
         <Detect>
            <DetectProperty Property="IsEBTTenderInsufficient" Equals="1" />
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="58" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="normal_desc_3" Equals="" />
               <Field Name="icon_desc_8" Contains="(Page 1 of" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="EntryData_Prop" Action="Set" Value="" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="WIC_PAYMENT_NOITEMS" Group="WIC_PAYMENT">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="995" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="normal_desc_1" Equals=" .00" />
            </DetectContext>
         </Detect>            
         <OnStateEnter>
		    <SetProperty Property="WICTransaction" Action="Set" Value="1" />
			<ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
            <!-- enable the cancel tender button and redisplay by adding extra space between words to skip filter-->
            <SetProperty Property="DK8_Label_Prop" Action="Set" Value="Cancel  Tender" />
            <SendControl Control="Display" />
		 </OnStateEnter>
      </State>
      <State Name="WIC_PAYMENT">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="995" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="normal_desc_1" Equals=" .00" Negate="true" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
		    <SetProperty Property="WICTransaction" Action="Set" Value="1" />
			<ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
            <!-- enable the cancel tender button and redisplay -->
            <SetProperty Property="DK8_Label_Prop" Action="Set" Value="Cancel  Tender" />
            <SendControl Control="Display" />
		 </OnStateEnter>
      </State>
      <State Name="PAYMENTMENU_DK1_NOCASH" Group="PAYMENTMENU_DK1">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="58" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="desc_asa_6" Equals="1" />  <!-- POS102483 assign F6 key for CASH -->
               <Field Name="normal_desc_3" Equals="" />
               <Field Name="icon_desc_8" Contains="(Page 1 of" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="EntryData_Prop" Action="Set" Value="" />
            <SetProperty Property="PropTenderDynaKey" Action="Set" Value="1" />
            <SetProperty Property="ForStreamlineEPaymentCredit" Action="Set" Value="{F7}{F1}" />
            <SetProperty Value="0" Action="Set" Property="PropNegativeMedia" />
            <SetProperty Property="TRXENDDone" Action="Set" Value="0" />
            <!--<SetProperty Property="NotEBTDeclineSlip" Action="Set" Value="0" />-->
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <SetProperty Property="SignatureRequested" Action="Set" Value="" />
            <SetProperty Property="TenderType" Action="Set" Value="" />
			<SetProperty Property="TestTenderType" Action="Set" Value="" />
            <SetProperty Property="TenderTypeSelected" Action="Set" Value="" />
            <SetProperty Property="CustRequestCreditBtn" Action="Set" Value="1" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Value="1" Action="Set" Property="PropIsFromPayment" />
            <SetProperty Value="0" Action="Set" Property="IsFromAlphanumeric" />
            <!-- commented for Bug95965. This has been moved to SmSmAssistmode.cpp 
			<SetProperty Property="DK5_Label_Prop" Action="Set" Value="TRAVELER/REBATE/  ETC" /> -->
            <SendControl Control="Display" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>      
      <State Name="PAYMENTMENU_DK1">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="58" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="normal_desc_3" Equals="" />
               <Field Name="icon_desc_8" Contains="(Page 1 of" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
			<SetProperty Property="IsQuickChipAtItemization" Action="Set" Value="0" />
			<SetProperty Property="HookPropMperksPrompt" Action="Set" Value="0" />
			<SetProperty Property="IsWICTenderButton" Action="Set" Value="0" />
		    <SetProperty Property="IsEMVCardOperation" Action="Set" Value="0" />
            <SetProperty Property="EntryData_Prop" Action="Set" Value="" />
            <SetProperty Property="PropTenderDynaKey" Action="Set" Value="1" />
            <SetProperty Property="ForStreamlineEPaymentCredit" Action="Set" Value="{F7}{F1}" />
            <SetProperty Value="0" Action="Set" Property="PropNegativeMedia" />
            <SetProperty Property="TRXENDDone" Action="Set" Value="0" />
            <!--<SetProperty Property="NotEBTDeclineSlip" Action="Set" Value="0" />-->
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <SetProperty Property="SignatureRequested" Action="Set" Value="" />
            <SetProperty Property="TenderType" Action="Set" Value="" />
			<SetProperty Property="TestTenderType" Action="Set" Value="" />
            <SetProperty Property="TenderTypeSelected" Action="Set" Value="" />
            <SetProperty Property="CustRequestCreditBtn" Action="Set" Value="1" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Value="1" Action="Set" Property="PropIsFromPayment" />
            <SetProperty Value="0" Action="Set" Property="IsFromAlphanumeric" />
			<!-- commented for Bug95965. This has been moved to SmSmAssistmode.cpp 
            <SetProperty Property="DK5_Label_Prop" Action="Set" Value="TRAVELER/REBATE/  ETC" /> -->
            <SendControl Control="Display" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
         </OnStateEnter>
      </State>
      <State Name="DYNAKEY_DISPLAY_UPDATE" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="normal_label_5" Contains="TRAVELER/REBATE/ETC" />
            </DetectContext>
            <DetectProperty Property="PropTenderDynaKey" Equals="1" />
         </Detect>
         <OnStateEnter>
		    <!-- commented for Bug95965. This has been moved to SmSmAssistmode.cpp 
            <SetProperty Property="DK5_Label_Prop" Action="Set" Value="TRAVELER/REBATE/  ETC" /> -->
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
	   <!-- +POS310004 -->
	  <State Name="PAYMENTMENU_SMART_WIC_ENABLE" Group="PAYMENTMENU_DK1">
         <Detect>
           <!-- POS just provided a dynakey labels context upon switching to page 2  
		     <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="58" />
            </DetectContext> -->
            <DetectContext Context="DF_DynaKey_labels">
			   <Field Name="normal_label_4" Contains="SMART" />
			   <Field Name="label_asa_3" Equals="0" />
               <Field Name="icon_desc_8" Contains="(Page 2 of" />
            </DetectContext>
			<DetectProperty Property="IsWICTenderButton" Equals="1" />		
         </Detect>
         <OnStateEnter>
		    <SetProperty Property="IsWICTenderButton" Action="Set" Value="0" />
            <SetProperty Property="SignatureRequested" Action="Set" Value="" />
           <!-- <ResetContext Context="DF_DynaFrame_labels" /> -->
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Value="1" Action="Set" Property="PropIsFromPayment" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>
	  <State Name="PAYMENTMENU_SMART_WIC_DISABLE" Group="PAYMENTMENU_DK1">
         <Detect>
          <!--  <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="58" />
            </DetectContext> -->
            <DetectContext Context="DF_DynaKey_labels">
			   <Field Name="normal_label_4" Contains="SMART" />
			   <Field Name="label_asa_3" Equals="1" />
               <Field Name="icon_desc_8" Contains="(Page 2 of" />
            </DetectContext>
			<DetectProperty Property="IsWICTenderButton" Equals="1" />		
         </Detect>
         <OnStateEnter>
		    <SetProperty Property="IsWICTenderButton" Action="Set" Value="0" />
            <SetProperty Property="SignatureRequested" Action="Set" Value="" />
         <!--   <ResetContext Context="DF_DynaFrame_labels" /> -->
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Value="1" Action="Set" Property="PropIsFromPayment" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>
	   <!-- (+)POS328559 -->
	  <State Name="NO_WIC_INTRX">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1693" />
            </DetectContext>
         </Detect>
		 <OnStateEnter>
			<ResetContext Context="Operator_guidance" />
            <SendControl Control="Display" />
         </OnStateEnter>
	  </State>	 
	 <!-- (-)POS328559 -->
      <!-- -POS310004 -->
      <State Name="PAYMENTMENU_DK2" Group="PAYMENTMENU_DK1">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="58" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="icon_desc_8" Contains="(Page 2 of" />
            </DetectContext>
			<DetectProperty Property="IsWICTenderButton" Equals="0" /> <!-- POS310004 -->
         </Detect>
         <OnStateEnter>
            <SetProperty Property="SignatureRequested" Action="Set" Value="" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Value="1" Action="Set" Property="PropIsFromPayment" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>
      <State Name="WAITING_ON_PINPAD">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="title_1" Contains="Waiting" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="normal_label_8" Contains="Cancel Tender" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
         </OnStateEnter>
      </State>
      <State Name="WAITING_ON_PINPAD2" Group="WAITING_ON_PINPAD">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="title_1" Contains="Waiting" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="icon_label_8" Contains="Cancel Tender" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
         </OnStateEnter>
      </State>
<!-- POS139881 -->
      <State Name="WAITING_ON_PINPAD3" Group="WAITING_ON_PINPAD">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="638" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
         </OnStateEnter>
      </State>
<!-- e POS139881 -->

      <State Name="EXPIRATION_DATE">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="170"/>
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="EntryData_Prop" Action="Set" Value="" />
         </OnStateEnter>
      </State>
      <State Name="NEED_MICR" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="375" />
               <Field Name="title_1" Contains="Routing Number" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Value="1" Action="Set" Property="PropIsFromMICR" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />            
         </OnStateEnter>
      </State>
      <State Name="ACCOUNT_NUMBER_ENTRY">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="375" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels"></DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Value="0" Action="Set" Property="PropIsProbablyPINEntry" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>  
      <State Name="SET_REQUEST_FOR_CREDIT1" Group="PAYMENT_AMOUNT">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="59" />
            </DetectContext>
			<DetectContext Context="DF_DynaKey_labels">
				<Field Name="normal_label_7" Contains="Credit" />
				<Field Name="label_asa_7" Equals="0" />
            </DetectContext>
			<DetectProperty Property="PropIsOperGuid" Equals="0" />
		</Detect>
         <OnStateEnter>
			<ResetContext Context="DF_DynaKey_labels" />
			<ResetContext Context="DF_DynaFrame_labels" />
			<SetProperty Property="CustRequestCreditBtn" Action="Set" Value="0" />
         </OnStateEnter>
      </State>
	  <State Name="PAYMENT_AMOUNT_REQUEST_CREDIT" Group="PAYMENT_AMOUNT">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="759" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
                <Field Name="normal_label_7" Contains="Credit" />
                <Field Name="label_asa_7" Equals="0" />	
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="CustRequestCreditBtn" Action="Set" Value="0" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
         </OnStateEnter>
      </State>
      <State Name="PAYMENT_AMOUNT" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="59" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels" />
			<DetectProperty Property="PropIsOperGuid" Equals="0" />
         </Detect>
         <OnStateEnter>
			<SetProperty Property="TRXENDDone" Action="Set" Value="0" />
             <ResetContext Context="DF_DynaFrame_labels" />
             <ResetContext Context="DF_DynaKey_labels" />
         </OnStateEnter>
      </State>

     <!--  POS262867 use WAITING ON PINPAD for EMV process -->
      <!-- POS257231 - 261569 rrs -->
      <State Name="WAITING_ON_PINPAD4" Group="WAITING_ON_PINPAD">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" RegEx="^((58)|(12))$"  />
               <Field Name="leadthru_1" Contains="Do not remove card from PIN pad" />
            </DetectContext>
         </Detect>
         <OnStateEnter>	  
	     <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0"/>            <!-- POS290243 -->
             <SetProperty Property="LTT1_Prop" Action="Set" Value="Do not remove card from PIN pad" />
			 <SetProperty Property="IsEMVCardOperation" Action="Set" Value="1" /> <!-- POS279853 -->
             <ResetContext Context="DF_DynaFrame_labels" />
             <ResetContext Context="DF_DynaKey_labels" />	
             <SendControl Control="Display" /> 	<!-- POS290243 -->
         </OnStateEnter>
      </State>
	  <!-- POS275803 - aab -->
	  <State Name="WAITING_ON_PINPAD_ENTRY" Group="WAITING_ON_PINPAD4">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="1019" />
            </DetectContext>
			<DetectContext Context="DF_DynaKey_labels">
               <Field Name="normal_label_8" Equals="Cancel" /> <!-- POS294897 -->
            </DetectContext>
         </Detect>
         <OnStateEnter>
             <ResetContext Context="DF_DynaFrame_labels" />
             <ResetContext Context="DF_DynaKey_labels" />
         </OnStateEnter>
      </State>
      <State Name="WAITING_ON_PINPAD5" Group="WAITING_ON_PINPAD">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="59" />
               <Field Name="leadthru_1" Contains="Instruct customer to remove card" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
             <SetProperty Property="LTT1_Prop" Action="Set" Value="Instruct customer to remove card" />
             <ResetContext Context="DF_DynaFrame_labels" />
             <ResetContext Context="DF_DynaKey_labels" />
         </OnStateEnter>
      </State>
      <!-- e POS257231 -->
     <!-- e  POS262867 use WAITING ON PINPAD for EMV process -->

<!-- POS258550 - rrs -->
      <State Name="CARD_REMOVED_765" Group="WAITING_ON_PINPAD">
         <Detect>
            <DetectContext Context="Operator_guidance">
			   <Field Name="Guidance_for_operator" Contains="Rejected 765 NOT APPROVED" />
               <Field Name="msg_num" Equals="300" />
               <Field Name="msg_level" Equals="2" />
            </DetectContext>
         </Detect>
		 <OnStateEnter> <!-- POS303159 -->
            <SetProperty Property="TenderType" Action="Set" Value="" />
			<SetProperty Property="TestTenderType" Action="Set" Value="" />
            <SetProperty Property="TenderTypeSelected" Action="Set" Value="" />
         </OnStateEnter>
      </State>   
<!-- e POS258550 - rrs -->

<!-- POS273548 - rrs -->
      <State Name="EMV_PLEASE_REMOVE_CARD" > 
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1749" />
               <Field Name="msg_level" Equals="1" />
            </DetectContext>
         </Detect>
      </State>   
	  <!--POS303376-->
	  <State Name="EMV_PLEASE_REMOVE_CARD_FIPAY" Group="EMV_PLEASE_REMOVE_CARD" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
                <Field Name="dynaframe_id" RegEx="^((13)|(58))$" /> <!-- remove 59 as it is causing hang after pressing OK -->               
                <Field Name="leadthru_1" Contains="Instruct customer to remove card" />
            </DetectContext>
         </Detect>
		 <OnStateEnter> 
             <SetProperty Property="LTT1_Prop" Action="Set" Value="Instruct customer to remove card" />
             <ResetContext Context="DF_DynaFrame_labels" />
             <ResetContext Context="DF_DynaKey_labels" />
         </OnStateEnter>
      </State>
	  <State Name="EMV_CANCEL_FROM_DEVICE">
         <Detect>
            <DetectContext Context="Operator_guidance">
			   <Field Name="Guidance_for_operator" Contains="708 TRANSACTION CANCELLED BY PIN DEVICE" />
               <Field Name="msg_num" Equals="300" />
               <Field Name="msg_level" Equals="2" />
            </DetectContext>
         </Detect>
      </State>   
<!-- e POS273548 - rrs -->

<!-- POS70546 rrs -->
      <State Name="GIFTCARD_FOODONLY_NOITEM" Group="PAYMENT_AMOUNT">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="990" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
                <Field Name="normal_desc_1" Equals=" .00" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="TRXENDDone" Action="Set" Value="0" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
         </OnStateEnter>
      </State>
      <State Name="FOOD_ONLY_GC">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1618" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
<!-- e POS70546 rrs -->

      <State Name="PAYMENT_AMOUNT1" Group="PAYMENT_AMOUNT">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="990" />
            </DetectContext>
            <!-- POS70546 -->
          <DetectContext Context="DF_DynaKey_labels">
                <Field Name="normal_desc_1" Equals=" .00" Negate="true"/>
            </DetectContext>
             <!-- e POS70546 -->
         </Detect>
         <OnStateEnter>
			<SetProperty Property="TRXENDDone" Action="Set" Value="0" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
         </OnStateEnter>
      </State>

<!-- POS15989 -->
      <State Name="PAYMENT_AMOUNT_EBTFOOD_ZERO_TOTAL" Group="PAYMENT_AMOUNT">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="991" />
            </DetectContext>

	    <DetectContext Context="DF_DynaKey_labels">
                <Field Name="normal_desc_1" Equals=" .00" />
            </DetectContext>
	    </Detect>
         <OnStateEnter>
			<SetProperty Property="TRXENDDone" Action="Set" Value="0" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="EBTTenderType" Action="Set" Value="1" />
         </OnStateEnter>
      </State>
<!-- e POS15989 -->

      <State Name="PAYMENT_AMOUNT_EBTFOOD" Group="PAYMENT_AMOUNT">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="991" />
            </DetectContext>
<!-- POS15989 -->
	    <DetectContext Context="DF_DynaKey_labels">
                <Field Name="normal_desc_1" Equals=" .00" Negate="true"/>
            </DetectContext>
<!-- e POS15989 -->
         </Detect>
         <OnStateEnter>
			<SetProperty Property="TRXENDDone" Action="Set" Value="0" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="EBTTenderType" Action="Set" Value="1" />
            <SetProperty Property="TenderTypeSelected" Action="Set" Value="(EBT FOOD)" />  <!-- POS55434 rrs -->
         </OnStateEnter>
      </State>
      <State Name="PAYMENT_AMOUNT_EBTCASH" Group="PAYMENT_AMOUNT">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="992" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
			<SetProperty Property="TRXENDDone" Action="Set" Value="0" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="EBTTenderType" Action="Set" Value="1" />
         </OnStateEnter>
      </State>
      <State Name="POS_TRXEND">
         <Detect>
            <DetectContext Context="Clear_scrolling_window" />
            <DetectProperty Property="ReceiptWritten" Equals="1" />
            <DetectProperty Property="TRXENDDone" Equals="0" />
         </Detect>
         <OnStateEnter>
            <SetProperty Property="ReceiptWritten" Action="Set" Value="0" />
            <SetProperty Property="TRXENDDone" Action="Set" Value="1" />
            <SetProperty Property="CM_TenderType" Action="Set" Value="CM_TEST" />
            <SetProperty Property="CM_Tendering_Amt" Action="Set" Value="0" />
            <ResetContext Context="Clear_scrolling_window" />
            <SetProperty Property="CMDiscount_Total" Action="Set" Value="0" />
            <SetProperty Property="CMDiscount_Total_TM" Action="Set" Value="0" />
            <SetProperty Property="TMDiscount_Total" Action="Set" Value="0" />
            <SetProperty Property="TMDiscount_Total_CM" Action="Set" Value="0" />
            <SetProperty Property="GM_Total_Subtotal" Action="Set" Value="0" />
            <SetProperty Property="GM_Total_Subtotal_CM" Action="Set" Value="0" />
            <SetProperty Property="GM_Total_TMD" Action="Set" Value="0" />
            <SetProperty Property="GM_Total_TMD_CM" Action="Set" Value="0" />
         </OnStateEnter>
      </State>
      <State Name="POS_TRXEND1" Group="POS_TRXEND">
         <Detect>
            <DetectContext Context="End_of_transaction_display" />
            <DetectProperty Property="TRXENDDone" Equals="0" />
         </Detect>
         <OnStateEnter>
            <SetProperty Property="TRXENDDone" Action="Set" Value="1" />
            <SetProperty Property="CM_TenderType" Action="Set" Value="CM_TEST" />
            <ResetContext Context="End_of_transaction_display" />
            <SetProperty Property="CMDiscount_Total" Action="Set" Value="0" />
            <SetProperty Property="CMDiscount_Total_TM" Action="Set" Value="0" />
            <SetProperty Property="TMDiscount_Total" Action="Set" Value="0" />
            <SetProperty Property="TMDiscount_Total_CM" Action="Set" Value="0" />
            <SetProperty Property="GM_Total_Subtotal" Action="Set" Value="0" />
            <SetProperty Property="GM_Total_Subtotal_CM" Action="Set" Value="0" />
            <SetProperty Property="GM_Total_TMD" Action="Set" Value="0" />
            <SetProperty Property="GM_Total_TMD_CM" Action="Set" Value="0" />
         </OnStateEnter>
      </State>
	  
	  <!-- POS290538 -->
	  <State Name="POS_RECEIPTCOMPLETED" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="761" />               
            </DetectContext>            
         </Detect>
         <OnStateEnter>
			<ResetContext Context="acs_tb_interface" /> <!-- POS305064 -->
            <SetProperty Property="CM_TenderType" Action="Set" Value="CM_TEST" />
            <SetProperty Property="CM_Tendering_Amt" Action="Set" Value="0" />
            <ResetContext Context="Clear_scrolling_window" />
            <SetProperty Property="CMDiscount_Total" Action="Set" Value="0" />
            <SetProperty Property="CMDiscount_Total_TM" Action="Set" Value="0" />
            <SetProperty Property="TMDiscount_Total" Action="Set" Value="0" />
            <SetProperty Property="TMDiscount_Total_CM" Action="Set" Value="0" />
            <SetProperty Property="GM_Total_Subtotal" Action="Set" Value="0" />
            <SetProperty Property="GM_Total_Subtotal_CM" Action="Set" Value="0" />
            <SetProperty Property="GM_Total_TMD" Action="Set" Value="0" />
            <SetProperty Property="GM_Total_TMD_CM" Action="Set" Value="0" />
         </OnStateEnter>
      </State>
	<!-- POS290538 -->
	
      <!-- SOTF 8380 - O2S - RRS -->
<!-- Removed this section as its not needed sotf 8889 rrs
      <State Name="POS_TRXEND2" Group="POS_TRXEND">
         <Detect>
            <DetectContext Context="End_of_tran_dis_no_change" />
            <DetectProperty Property="TRXENDDone" Equals="0" />
         </Detect>
         <OnStateEnter>
            <SetProperty Property="TRXENDDone" Action="Set" Value="1" />
            <SetProperty Property="CM_TenderType" Action="Set" Value="CM_TEST" />
            <ResetContext Context="End_of_transaction_display" />
            <SetProperty Property="CMDiscount_Total" Action="Set" Value="0" />
            <SetProperty Property="CMDiscount_Total_TM" Action="Set" Value="0" />
            <SetProperty Property="TMDiscount_Total" Action="Set" Value="0" />
            <SetProperty Property="TMDiscount_Total_CM" Action="Set" Value="0" />
            <SetProperty Property="GM_Total_Subtotal" Action="Set" Value="0" />
            <SetProperty Property="GM_Total_Subtotal_CM" Action="Set" Value="0" />
            <SetProperty Property="GM_Total_TMD" Action="Set" Value="0" />
            <SetProperty Property="GM_Total_TMD_CM" Action="Set" Value="0" />
         </OnStateEnter>
      </State>
-->
      <!-- E SOTF 8380 - O2S - RRS -->

      <State Name="MISCMENU_DK1" Group="MISCMENU_DK1">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="40" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="icon_desc_8" Contains="(Page 1 of" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="EntryData_Prop" Action="Set" Value="" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />

            <!-- POS57465: Make sure mPerks Lookup list is not shown when backing out of lookup screens -->
            <SetProperty Value="0" Action="Set" Property="RainCheckList" />

            <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
            <SetProperty Value="0" Action="Set" Property="PropIsVoidItem" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Value="0" Action="Set" Property="PropIsProcessingItem" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="MISCMENU_DK1_REFRESH" Group="MISCMENU_DK1">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="40" />
            </DetectContext>
            <DetectProperty Property="RefreshDisplay" Equals="1" />
         </Detect>
         <OnStateEnter>
			<SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="0" /> 
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <SetProperty Property="EntryData_Prop" Action="Set" Value="" />
            <SendControl Control="Display" />
			<ResetContext Context="DF_DynaFrame_labels" />
         </OnStateEnter>
		 <OnStateExit>
            <SetProperty Property="RefreshDisplay" Action="Set" Value="0" />
         </OnStateExit>
      </State>
      <State Name="MISCMENU_DK2">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="40" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="icon_desc_8" Contains="(Page 2 of" />
            </DetectContext>
         </Detect>
      </State>
	  <State Name="MISCMENU_STOREPHONENUM">
         <Detect>
			<DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="764" />
            </DetectContext>
			<DetectContext Context="DF_DynaKey_labels">
               <Field Name="normal_label_1" Equals="Phone Number" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="Phone Number (A - M)" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="Phone Number (N - Z)" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="MISCMENU_DUPL_RCPT">
         <Detect>
            <DetectContext Context="DF_Dupl_term_num"></DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_Dupl_term_num" />
         </OnStateEnter>
      </State>
      <State Name="MISCMENU_DUPL_RCPT_NUM">
         <Detect>
            <DetectContext Context="DF_Dupl_trans_num"></DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_Dupl_trans_num" />
         </OnStateEnter>
      </State>
      <!-- POS57465: Added MPERKS_LOOKUP to make sure mPerks Lookup list is not shown when backing out of lookup screens -->
      <State Name="MPERKS_LOOKUP">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="626" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
            <SetProperty Value="0" Action="Set" Property="RainCheckList" />
         </OnStateEnter>
      </State>
      <State Name="TRXMENU_DK1">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="25" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="icon_desc_8" Contains="(Page 1 of" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="EntryData_Prop" Action="Set" Value="" />
            <SetProperty Property="IsResumeTrxInProgress" Action="Set" Value="0" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
            
            <!-- pos57686 <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" /> -->
             <SetProperty Value="0" Action="Set" Property="RainCheckList" />

            <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
            <SetProperty Value="0" Action="Set" Property="PropIsVoidItem" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Value="0" Action="Set" Property="PropIsProcessingItem" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="TRXMENU_DK2">
         <Detect>
            <DetectContext Context="DF_DynaKey_labels">
			   <Field Name="icon_label_1" Contains="Taxes" />
               <Field Name="icon_desc_8" Contains="(Page 2 of" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="TRXMENU_DK3">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="25" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="icon_desc_8" Contains="(Page 3 of" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="OTHER_MENU">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="1" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="VOIDMENU_DK1">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="60" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="icon_desc_8" Contains="(Page 1 of" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
            <SetProperty Value="0" Action="Set" Property="PropIsVoidItem" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Value="0" Action="Set" Property="PropIsProcessingItem" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="VOIDMENU_DK2">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="60" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="icon_desc_8" Contains="(Page 2 of" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="LOOKUP_MENU">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="97" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
            <SetProperty Value="0" Action="Set" Property="PropIsVoidItem" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Value="0" Action="Set" Property="PropIsProcessingItem" />
         </OnStateEnter>
      </State>
      <State Name="PRICEINQUIRY_MENU" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="147" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
            <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
            <SetProperty Value="0" Action="Set" Property="PropIsVoidItem" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Value="0" Action="Set" Property="PropIsProcessingItem" />
         </OnStateEnter>
      </State>
      <State Name="DEPARTMENT_MENU">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="61" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
            <SetProperty Value="0" Action="Set" Property="PropIsVoidItem" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Value="0" Action="Set" Property="PropIsProcessingItem" />
			<SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
	        <SetProperty Value="1" Action="Set" Property="PropertyAllowAMExit"/>
            <SendControl Control="Display" />
         </OnStateEnter>
		 <OnStateExit>
			<SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
		 </OnStateExit>
      </State>
      <State Name="COUPON_MENU">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="7" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
            <SetProperty Value="0" Action="Set" Property="PropIsVoidItem" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Value="0" Action="Set" Property="PropIsProcessingItem" />
         </OnStateEnter>
      </State>
	  <!-- Madz 377685-->
	<State Name="CASHIER_COUPON_OVERRIDE" IgnoreDuplicate="true">
		<Detect>
			<DetectContext Context="DF_DynaFrame_labels">
				<Field Name="dynaframe_id" Equals="883" />
			</DetectContext>
		</Detect>
	</State>
	<!-- End -->
      <State Name="CHANGEQTY_MENU">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="50" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
            <SetProperty Value="0" Action="Set" Property="PropIsVoidItem" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Value="0" Action="Set" Property="PropIsProcessingItem" />
         </OnStateEnter>
      </State>
      <State Name="CHANGEPRICE_MENU">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="51" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="COUPON_CHANGED_PRICE">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="title_2" Contains="Coupon" />
               <Field Name="leadthru_1" Equals="Key-in new unit price." />
               <Field Name="dynaframe_id" Equals="161" />
            </DetectContext>
	    <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
         </OnStateEnter>
      </State>
      <State Name="COUPON_CHANGED_PRICE_VARIANT">
         <Detect>
            <DetectContext Context="Item_entry_display">
               <Field Name="item_code" Contains="VOID" />
               <Field Name="Item_descriptor" Contains="Coupon" />
            </DetectContext>
            <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
            <!-- Bug fixed during POS33020 enhancements: Reset Item_entry_display context so that      -->
            <!-- VENDOR_COUPON_CHOICE can be activated when an mPerks entry is done after coupon entry -->
            <ResetContext Context="Item_entry_display" />
         </OnStateEnter>
      </State>
      <State Name="FOID_ITEM">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="title_1" Equals="FOID CARD EXPIRATION DATE" />
               <Field Name="dynaframe_id" Equals="996" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="FOID CARD EXPIRATION" />
            <SetProperty Property="Title2_Prop" Action="Set" Value="DATE" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="FOID_ID">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="997" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="normal_label_1" Equals="No FOID Card" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="FOID CARD ID" />
            <SetProperty Property="Title2_Prop" Action="Set" Value="" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Key-in FOID ID Number:" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="CHANGEPRICE_UNIT">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="161" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
			<SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
			<SendControl Control="Display" />
         </OnStateEnter>
		 <OnStateExit>
			<SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
		 </OnStateExit>
      </State>
      <State Name="CHANGEPRICE_PKG_QTY">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="162" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
			<SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
			<SendControl Control="Display" />
         </OnStateEnter>
		 <OnStateExit>
			<SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
		 </OnStateExit>
      </State>
      <State Name="CHANGEPRICE_PKG_PRICE">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="163" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
			<SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
			<SendControl Control="Display" />
         </OnStateEnter>
		 <OnStateExit>
			<SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
		 </OnStateExit>
      </State>
      <State Name="CHANGEPRICE_REASON">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="195" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="" Action="Set" Property="PropVerifyItemPrice" />
            <SetProperty Value="" Action="Set" Property="PriceVerifyItemDesc" />
            <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="NEXT_DAY_SEPARATE_MEDIA">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="037" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="SeparateMedia" Action="Set" Value="1" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="NEXT_DAY_SEPARATE_MEDIA1" Group="NEXT_DAY_SEPARATE_MEDIA">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="035" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="SeparateMediaExceptLastTrxn" Action="Set" Value="1" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="NEXT_DAY_SEPARATE_MEDIA2" Group="NEXT_DAY_SEPARATE_MEDIA">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1037" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="SeparateMedia" Action="Set" Value="1" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="NEXT_DAY_SEPARATE_MEDIA3" Group="NEXT_DAY_SEPARATE_MEDIA">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1035" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="SeparateMediaExceptLastTrxn" Action="Set" Value="1" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="ERROR_PIN_INPUT">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="403" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="PLEASE_SIGN_OUT">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="625" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="STORE_CLOSE_REQUESTED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="624" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="StoreCloseRequested" Action="Set" Value="1" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
	  <!-- +CRD185924 -->
	  <State Name="NEW_POS_SOFTWARE_AVAILABLE" Group="STORE_CLOSE_REQUESTED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1845" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="IsNewPOSSoftwareAvailable" Action="Set" Value="1" />
			<SetProperty Property="IsQuickRestart" Action="Set" Value="1" /> <!-- CRD200711 -->
            <SendControl Control="Display" />
         </OnStateEnter>
      </State> <!-- -CRD185924 -->
      <State Name="ADMSG_LOAD_FAIL">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="478" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="SCFORM_LOAD_FAIL" Group="ADMSG_LOAD_FAIL">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="479" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="REALLY_CANCEL_TRX">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="428" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="INVALID_DEPT_NUM">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="149" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="OVER_MAXIMUM_CARD_RECHARGE_AMOUNT">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="213" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="MSR_NOT_AVAILABLE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="414" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="SCANNER_DEVICE_ERROR">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="395" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="WARNING_SUSPENDED_TRANSACTION">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="231" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="PRICE_EMBED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="265" />
               <Field Name="msg_level" Equals="1" />
            </DetectContext>
            <!-- <DetectProperty Property="PrevEntryID" Equals="1"/>  -->
         </Detect>
      </State>
      <State Name="WEIGHT_OUT_OF_RANGE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="379" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="SIGN_ON_OFFLINE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="100" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="SIGN_ON_OFFLINE_REJECTED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="276" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="SIGN_OFF_OFFLINE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="102" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="OFFLINE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="563" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="ACSRunningOffline" Action="Set" Value="OFF-LINE" />
         </OnStateEnter>
      </State>
      <State Name="SELL_ITEM_MANUALLY">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="470" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="MESSAGE_377">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="377" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="FREQ_BUYER">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="348" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="FREQ_BUYER_ACTIVE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1215" />
            </DetectContext>
         </Detect>
      </State>
	  <State Name="ITEM_UNKNOWN_MOBILE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="38" />
            </DetectContext>
			<DetectProperty Property="IsSCOFLMS" Equals="1" />		
         </Detect>
         <!--POS44624/POS51734 Reset display so Enhanced Store Mode has correct display after handling guidance -->
	     <OnStateEnter>
			<SendControl Control="Display" />
			<ResetContext Context="Operator_guidance"/>
		 </OnStateEnter>
		 <OnStateExit>
			<ResetControl Control="Display" />
		 </OnStateExit>
         <!-- e POS44624/POS51734 -->
      </State>
      <!--POS11024:New state for Mobile shopper Unknown item handling-->
      <!--POS28644:Use ITEM_UNKNOWN State for both Mobile resume and regular transaction -->
      <State Name="ITEM_UNKNOWN">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="38" />
            </DetectContext>
			<DetectProperty Property="IsSCOFLMS" Equals="0" />		
         </Detect>
         <!--POS44624/POS51734 Reset display so Enhanced Store Mode has correct display after handling guidance -->
	     <OnStateEnter>
			<ResetContext Context="Operator_guidance"/>
		 </OnStateEnter>
		 <OnStateExit>
			<ResetControl Control="Display" />
		 </OnStateExit>
         <!-- e POS44624/POS51734 -->
      </State>
      <!--POS11024-End:New state for Mobile shopper resume-->
      <!-- POS19072 POS25874: Added  INVALID_WIC_FREE_ITEM state -->
      <State Name="INVALID_WIC_FREE_ITEM">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1519" />
            </DetectContext>
         </Detect>
      </State>
      <!-- POS19073 -->
      <State Name="FRAUDULENT_COUPON">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1517" />
            </DetectContext>
         </Detect>
      </State>
      <!-- POS39475 -->
      <State Name="HIGHVALUE_PROMO_CHOICE">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="621" />
            </DetectContext>
			<DetectProperty Property="IsHighValueBack2BackPromo" Equals="0" />
         </Detect>
         <OnStateEnter>
			<SetProperty Property="IsGoingBackToItemMenu" Action="Set" Value="0" /> <!-- POS323036 -->
		    <SetProperty Property="IsHighValueBack2BackPromo" Action="Set" Value="1" /> <!-- POS250985 aab -->
		    <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" /> <!-- CRD 289150 reset previous operator guidance -->
            <SendControl Control="Total" /> <!-- POS55263 rrs -->
            <ResetContext Context="acs_tb_interface" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <SetProperty Property="HighValuePromoChoice" Action="Set" Value="1" />
            <!-- If attendant goes into Assist Mode, use PropertyAllowAMExit to prevent exiting until promo is responded to. -->
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <!-- Do not clear properties related to acs_tb_interface because it is possible that another acs_tb_interface -->
            <!-- could occur while exiting the HIGHVALUE_PROMO_CHOICE POS state.                                           -->
         </OnStateExit>
      </State>
	  <!-- +POS250985 aab -->
	  <State Name="B2B_HIGHVALUE_PROMO_CHOICE" Group="HIGHVALUE_PROMO_CHOICE">
         <Detect>
            <!-- CRD 289150 detect the tb_int for the high value promo instead of the dynaframe
	    	avoiding OOS issues
	    <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="621" />
            </DetectContext>-->
			<DetectContext Context="acs_tb_interface">
	             <Field Name="tb_int" Equals="780" />
			</DetectContext>
			<DetectProperty Property="IsHighValueBack2BackPromo" Equals="1" />
			<DetectProperty Property="HighValuePromoChoice" Equals="0" /> <!-- it means the previous has already been answered -->
         </Detect>
         <OnStateEnter>
            <SendControl Control="Total" /> <!-- POS55263 rrs -->
            <ResetContext Context="acs_tb_interface" />
            <ResetContext Context="DF_DynaFrame_labels" />
			<SetProperty Property="PropIsOperGuid" Action="Set" Value="0" /> <!-- CRD 289150 reset property from previous operator guidance context -->
            <SetProperty Property="HighValuePromoChoice" Action="Set" Value="1" />
            <!-- If attendant goes into Assist Mode, use PropertyAllowAMExit to prevent exiting until promo is responded to. -->
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <!-- Do not clear properties related to acs_tb_interface because it is possible that another acs_tb_interface -->
            <!-- could occur while exiting the HIGHVALUE_PROMO_CHOICE POS state.                                           -->
         </OnStateExit>
      </State>
	  <!-- -POS250985 aab -->
      <!-- POS33020: Added VENDOR_COUPON_CHOICE_FEATURE_OFF -->
      <State Name="VENDOR_COUPON_CHOICE_FEATURE_OFF" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="774" />
               <Field Name="tb_long" Equals="0" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="acs_tb_interface" />
            <SetProperty Property="CouponChoiceFeatureEnabled" Action="Set" Value="0" />
         </OnStateEnter>
      </State>
      <!-- POS33020: Added VENDOR_COUPON_CHOICE_FEATURE_ON -->
      <State Name="VENDOR_COUPON_CHOICE_FEATURE_ON" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="774" />
               <Field Name="tb_long" Equals="1" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="acs_tb_interface" />
            <SetProperty Property="CouponChoiceFeatureEnabled" Action="Set" Value="1" />
         </OnStateEnter>
      </State>
      <!-- POS33020: Added VENDOR_COUPON_CHOICE -->
      <State Name="VENDOR_COUPON_CHOICE">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="623" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="acs_tb_interface" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <SetProperty Property="CouponChoice" Action="Set" Value="1" />
            <!-- If attendant goes into Assist Mode, use PropertyAllowAMExit to prevent exiting until coupon choice is responded to. -->
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="CouponChoice" Action="Set" Value="0" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <!-- Do not clear properties related to acs_tb_interface because it is possible that another acs_tb_interface -->
            <!-- could occur while exiting the VENDOR_COUPON_CHOICE POS state.                                           -->
         </OnStateExit>
      </State>
      <!-- POS33020: Added RETURN_COUPON -->
	   <State Name="RETURN_COUPON">
		   <Detect>
			   <DetectContext Context="Operator_guidance">
				   <Field Name="msg_num" Equals="1587" />    <!-- POS49567 change msg ID following POS message id rrs -->
			   </DetectContext>
		   </Detect>
	   </State>
      <State Name="INVALID_ITEM">
         <!-- invalid item code msg same as unknown, no longer grouped -->
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="32" />
            </DetectContext>
         </Detect>
      </State>
      <!-- POS41473: Added SERIAL_NUMBER_ENTRY -->
      <State Name="SERIAL_NUMBER_ENTRY">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="624" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
            <SetProperty Property="AppleSerialNumberEntry" Action="Set" Value="1" />
            <!-- When attendant goes into Assist Mode, use PropertyAllowAMExit to prevent exiting until serial number is entered. -->
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <!-- PropertyAllowAMExit will be set to 1 when the Item Menu appears after the serial number is entered. -->
         </OnStateExit>
      </State>
      <State Name="WIC_INVALID_ITEM">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" RegEx="^((1239)|(1248))$" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="WIC_BALANCE_EXCEEDED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" RegEx="^((1251)|(1252))$" />
            </DetectContext>
         </Detect>
      </State>                        
      <State Name="INVALID_TENDER_2">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="2" />
               <Field Name="msg_level" Equals="2" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="TenderType" Action="Set" Value="" />
            <SetProperty Property="TenderTypeSelected" Action="Set" Value="" />
            <SetProperty Property="CustRequestCreditBtn" Action="Set" Value="1" />
         </OnStateEnter>
      </State>
      <State Name="INVALID_TENDER">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="2" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="TenderType" Action="Set" Value="" />
            <SetProperty Property="TenderTypeSelected" Action="Set" Value="" />
            <SetProperty Property="CustRequestCreditBtn" Action="Set" Value="1" />
         </OnStateEnter>
      </State>
      <State Name="PIN_REQUIRED_2">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="405" />
               <Field Name="msg_level" Equals="2" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="PIN_REQUIRED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="405" />
            </DetectContext>
         </Detect>
      </State>
	  <!-- EFT_DENIED_DFLT occurs as a message 300 BEFORE receiving any response code therefore the
                      message300 handler does not apply.  Need to treat this as a regular OG requiring AM. -->
      <State Name="EFT_DENIED_DFLT">
         <Detect>
            <DetectContext Context="Operator_guidance">
			   <Field Name="Guidance_for_operator" Contains="DENIED DFLT" />
               <Field Name="msg_num" Equals="300" />
               <Field Name="msg_level" Equals="2" />
            </DetectContext>
         </Detect>
      </State>      	  
      <State Name="MESSAGE_300_2_APPROVED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="300" />
               <Field Name="msg_level" Equals="2" />
            </DetectContext>
            <DetectProperty Property="EftCardResponseCode" Contains="NL33" />
         </Detect>
         <OnStateEnter>
            <SetProperty Property="TenderType" Action="Set" Value="" />
            <SetProperty Property="TenderTypeSelected" Action="Set" Value="" />
         </OnStateEnter>
      </State>
      <State Name="MESSAGE_300_APPROVED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="300" />
            </DetectContext>
            <DetectProperty Property="EftCardResponseCode" Contains="NL13" />
         </Detect>
         <OnStateEnter>
            <SetProperty Property="TenderType" Action="Set" Value="" />
            <SetProperty Property="TenderTypeSelected" Action="Set" Value="" />
         </OnStateEnter>
      </State>
      <State Name="MESSAGE_300_APPROVED1" Group="MESSAGE_300_APPROVED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="300" />
            </DetectContext>
            <DetectProperty Property="EftCardResponseCode" Contains="NL33" />
         </Detect>
         <OnStateEnter>
            <SetProperty Property="TenderType" Action="Set" Value="" />
            <SetProperty Property="TenderTypeSelected" Action="Set" Value="" />
         </OnStateEnter>
      </State>

      <!-- POS42533 Handling OTC MEssages rrs -->
      <State Name="MESSAGE_300_1_PARTIAL_OTC">
         <Detect>
            <DetectContext Context="Operator_guidance">
		<Field Name="Guidance_for_operator" Contains="Partial MBA Approval" />
               <Field Name="msg_num" Equals="300" />
               <Field Name="msg_level" Equals="1" />
            </DetectContext>
         </Detect>
      </State>  
      <State Name="MESSAGE_300_1_PARTIAL_OTC">
         <Detect>
            <DetectContext Context="Operator_guidance">
		<Field Name="Guidance_for_operator" Contains="Partial MBA Approval" />
               <Field Name="msg_num" Equals="300" />
               <Field Name="msg_level" Equals="1" />
            </DetectContext>
         </Detect>
      </State>  

      <State Name="MESSAGE_300_2_OTC_DENIED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="300" />
               <Field Name="msg_level" Equals="2" />
            </DetectContext>
            <DetectProperty Property="EftCardResponseCode" RegEx="^((RMO2)|(RM91))$" />
         </Detect>
         <OnStateEnter>
            <SetProperty Property="TenderType" Action="Set" Value="" />
            <SetProperty Property="TenderTypeSelected" Action="Set" Value="" />
         </OnStateEnter>
      </State>
      <!-- POS42533 Handling OTC MEssages rrs -->      

      <State Name="MESSAGE_300_DENIED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="300" />
               <Field Name="msg_level" Equals="2" />
            </DetectContext>
            <DetectProperty Property="EftCardResponseCode" RegEx="^((NL28)|(NL11)|(NL29))$" />
         </Detect>
         <OnStateEnter>
            <SetProperty Property="TenderType" Action="Set" Value="" />
            <SetProperty Property="TenderTypeSelected" Action="Set" Value="" />
         </OnStateEnter>
      </State>
      <State Name="EBT_INSUFFICIENT_FUND" Group="MESSAGE_300">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="300" />
            </DetectContext>
            <DetectProperty Property="TenderType" Contains="EBT" />
            <DetectProperty Property="EftCardResponseCode" Contains="RM51" />
         </Detect>
         <OnStateEnter>
            <SetProperty Property="IsEBTTenderInsufficient" Action="Set" Value="1" />
            <SetProperty Property="TenderType" Action="Set" Value="" />
            <SetProperty Property="TenderTypeSelected" Action="Set" Value="" />
         </OnStateEnter>
      </State>
      <State Name="MESSAGE_300">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="300" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="TenderType" Action="Set" Value="" />
            <SetProperty Property="TenderTypeSelected" Action="Set" Value="" />
         </OnStateEnter>
      </State>
      <State Name="MESSAGE_8_5_ABOVE_LIMIT">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="8" />
               <Field Name="msg_level" Equals="5" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="TenderType" Action="Set" Value="" />
            <SetProperty Property="TenderTypeSelected" Action="Set" Value="" />
         </OnStateEnter>
      </State>
      <State Name="COUPON_VALIDATION_FAILED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="501" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="PRICE_DIFF_OVER_LIMIT">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="30" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="INVALID_SIGNATURE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="473" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="1" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Property="PropIsInvalidSignature" Action="Set" Value="0" />
         </OnStateEnter>
      </State>
      <State Name="BAD_SWIPE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="445" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="CANNOT_COMPLETE_TENDER">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="408" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="TenderType" Action="Set" Value="" />
            <SetProperty Property="TenderTypeSelected" Action="Set" Value="" />
         </OnStateEnter>
      </State>
      <State Name="MESSAGE_449">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="449" />
            </DetectContext>
         </Detect>
<!-- POS212941 rrs dont decline the OG message 449 but trigger AM intervention -->
<!--
         <OnStateEnter>
            <SetProperty Property="TenderType" Action="Set" Value="" />
            <SetProperty Property="TenderTypeSelected" Action="Set" Value="" />
         </OnStateEnter>
-->
      </State>
      <State Name="FMS_ITEM_MISSING">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1203" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="DEACTIVATING_PHONE_GIFT_CARD">
         <Detect>
            <DetectContext Context="Operator_prompt">
               <Field Name="Prompt_for_operator" Contains="Deactivating Phone" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Operator_prompt" />
         </OnStateEnter>
      </State>
      <State Name="OPERATOR_PROMPT_APPROVED">
         <Detect>
            <DetectContext Context="Operator_prompt">
               <Field Name="Prompt_for_operator" Equals="APPROVED        " />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Operator_prompt" />
         </OnStateEnter>
      </State>
	  <!-- SSCOI-47815: In suspending a transaction there's a change that multiple item restriction occures like the visual price verify. </State>IgnoreDuplicate="true"> -->
      <State Name="PRICE_VISUAL_VALIDATE" > 
         <Detect>
            <DetectContext Context="DF_Prc_method"></DetectContext>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="92" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_Prc_method" />
            <SetProperty Value="1" Action="Set" Property="PropIsPrcVerify" />

	    <!-- POS31050 rrs -->
   	    <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />			
	    <!-- e POS31050 rrs -->
            <!--  <SendInput Input="F8" /> -->
         </OnStateEnter>
	<!-- POS31050 -->
	<OnStateExit>
         </OnStateExit>
	<!-- e POS31050 -->
      </State>
      <State Name="CHANGE_UNIT_PRICE">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="93" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
			<SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
			<SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
         </OnStateExit>
      </State>
      <State Name="CHANGE_PACKAGE_QTY">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="94" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="CHANGE_PACKAGE_PRICE">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="95" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
			<SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
			<SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
         </OnStateExit>
      </State>
      <State Name="WEIGHT_PACKAGE_PRICE" Group="ITEMMENU_DK1">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="74" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
            <SendControl Control="Display" />
            <ResetContext Context="DF_DynaFrame_labels" />
         </OnStateEnter>
      </State>
      <State Name="DELAYED_OVERRIDE">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="392" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SendControl Control="Display" />
            <ResetContext Context="DF_DynaFrame_labels" />
         </OnStateEnter>
      </State>
	  <!-- DL POS251563 -->
	  <!-- (+)CRD136007 -->
	  <State Name="DELAYED_AGE_VERIFY_WHILE_RECALLING_ITEMS">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="1010" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
                <Field Name="normal_label_4" Contains="Delay" />
				<Field Name="label_asa_4" Equals="0" />
            </DetectContext>
			<DetectProperty Property="IsSCOFLMS" Equals="1" />			
         </Detect>
         <OnStateEnter>
	  <!-- REMOVE the AlcoholLimitExceeded CRD 407954 -->
	  <!-- <SetProperty Property="AlcoholLimitExceeded" Action="Set" Value="1" /> --> <!-- CRD 291250 -->
		    <SetProperty Property="IsDelayedAgeRestrictedProp" Action="Set" Value="1" />
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
			<SetProperty Property="PropIsOperGuid" Action="Set" Value="0" /> <!-- CRD 289150 reset from previous operator guidance context -->
            <SendControl Control="Display" />
            <ResetContext Context="DF_DynaFrame_labels" />
			<ResetContext Context="DF_DynaKey_labels" />		
         </OnStateEnter>
      </State>
<!-- Start CRD 157372 -->
<State Name="DELAYED_AGE_VERIFY_SND">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="1010" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
                <Field Name="normal_label_4" Contains="Delay" />
				<Field Name="label_asa_4" Equals="0" />
            </DetectContext>	
	   <DetectProperty Property="IsSND" Equals="1" />		
         </Detect>
         <OnStateEnter>
		    <SetProperty Property="IsDelayedAgeRestrictedProp" Action="Set" Value="1" />
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SendControl Control="Display" />
            <ResetContext Context="DF_DynaFrame_labels" />
			<ResetContext Context="DF_DynaKey_labels" />		
         </OnStateEnter>
      </State>

<!-- End CRD 157372 -->
	  <!-- (-)CRD136007 -->
	  <State Name="DELAYED_AGE_VERIFY">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="1010" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
                <Field Name="normal_label_4" Contains="Delay" />
				<Field Name="label_asa_4" Equals="0" />
            </DetectContext>			
         </Detect>
         <OnStateEnter>
		    <SetProperty Property="IsDelayedAgeRestrictedProp" Action="Set" Value="1" />
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SendControl Control="Display" />
            <ResetContext Context="DF_DynaFrame_labels" />
			<ResetContext Context="DF_DynaKey_labels" />		
         </OnStateEnter>
      </State>
	  <State Name="AGE_VERIFY_DK1">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="1010" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
                <Field Name="normal_label_4" Contains="Delay" />
				<Field Name="label_asa_4" Equals="1" />
            </DetectContext>
			<!-- <DetectProperty Property="IsDelayedAgeRestrictedProp" Equals="1" /> commented for POS306203 -->
         </Detect>
         <OnStateEnter>
			<SetProperty Property="IsDelayedAgeRestrictedProp" Action="Set" Value="1" /> <!-- added for POS306203 -->
		    <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
			<SendControl Control="Display" />
            <ResetContext Context="DF_DynaFrame_labels" />
			<ResetContext Context="DF_DynaKey_labels" />	
         </OnStateEnter>
      </State>
	    <State Name="AGE_VERIFY_SCAN_DL">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="1012" />
            </DetectContext>
			<DetectContext Context="DF_DynaKey_labels" />
			<DetectProperty Property="IsDelayedAgeRestrictedProp" Equals="1" />
         </Detect>
         <OnStateEnter>
		    <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
			<SendControl Control="Display" />
            <ResetContext Context="DF_DynaFrame_labels" />
			<ResetContext Context="DF_DynaKey_labels" />	
         </OnStateEnter>
      </State>
	  <State Name="AGE_VERIFY_SELECT_STATE">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="1011" />
            </DetectContext>
			<DetectContext Context="DF_DynaKey_labels" />
			<DetectProperty Property="IsDelayedAgeRestrictedProp" Equals="1" />
         </Detect>
         <OnStateEnter>
		    <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
			<SendControl Control="Display" />
            <ResetContext Context="DF_DynaFrame_labels" />
			<ResetContext Context="DF_DynaKey_labels" />	
         </OnStateEnter>
      </State>
      <State Name="RESTRICTED_ITEM_AGE" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_Birth_date">
               <Field Name="required_age" Equals="16" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_Birth_date" />
            <SetProperty Property="IsRestricted_Prop" Action="Set" Value="1" />
            <ResetContext Context="DF_Birth_date" />
            <ResetControl Control="Display" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Age Verify" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Key in Date of Birth from driver's license" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="in (MMDDYY) format to verify age 16" />
            <SetProperty Property="DK1_Label_Alt_Prop" Action="Set" Value="Date of Birth Not Needed" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="1" />
            <SendControl Control="Display" />
            <!--SendInput Input="F1"/-->
         </OnStateEnter>
      </State>
      <!-- sotf 6823 -->
      <State Name="NEED_BIRTH_DATE_16_NEW" Group="RESTRICTED_ITEM_AGE">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="182" />
               <Field Name="leadthru_2" Contains="16" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
            <SetProperty Property="IsRestricted_Prop" Action="Set" Value="1" />
            <SetProperty Property="RestrictedAge_Prop" Action="Set" Value="16" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
         	<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
 	        <SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> <!-- POS31050 Display the keypad -->
		</OnStateEnter>
		<OnStateExit>
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
	  	        <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> <!-- POS31050 Display the keypad -->
		</OnStateExit>
      </State>
      <!-- sotf 6823 -->
      <State Name="NEED_BIRTH_DATE_17_NEW" Group="RESTRICTED_ITEM_AGE">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="182" />
               <Field Name="leadthru_2" Contains="17" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
            <SetProperty Property="IsRestricted_Prop" Action="Set" Value="1" />
            <SetProperty Property="RestrictedAge_Prop" Action="Set" Value="17" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
           	<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
		  	        <SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> <!-- POS31050 Display the keypad -->
		</OnStateEnter>
		<OnStateExit>
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
	  	        <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> <!-- POS31050 Display the keypad -->
		</OnStateExit>
      </State>
      <State Name="NEED_BIRTH_DATE_18_NEW" Group="RESTRICTED_ITEM_AGE">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="182" />
               <Field Name="leadthru_2" Contains="18" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
            <SetProperty Property="IsRestricted_Prop" Action="Set" Value="1" />
            <SetProperty Property="RestrictedAge_Prop" Action="Set" Value="18" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
           	<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
		  	        <SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> <!-- POS31050 Display the keypad -->
		</OnStateEnter>
		<OnStateExit>
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
	  	        <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> <!-- POS31050 Display the keypad -->
		</OnStateExit>
      </State>
      <!-- sotf 6823 -->
      <State Name="NEED_BIRTH_DATE_19_NEW" Group="RESTRICTED_ITEM_AGE">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="182" />
               <Field Name="leadthru_2" Contains="19" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
            <SetProperty Property="IsRestricted_Prop" Action="Set" Value="1" />
            <SetProperty Property="RestrictedAge_Prop" Action="Set" Value="19" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
          	<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
	  	        <SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> <!-- POS31050 Display the keypad -->
		</OnStateEnter>
		<OnStateExit>
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
	  	        <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> <!-- POS31050 Display the keypad -->
		</OnStateExit>
      </State>
      <!-- sotf 6823 -->
      <State Name="NEED_BIRTH_DATE_21_NEW" Group="RESTRICTED_ITEM_AGE">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="182" />
               <Field Name="leadthru_2" Contains="21" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
            <SetProperty Property="IsRestricted_Prop" Action="Set" Value="1" />
            <SetProperty Property="RestrictedAge_Prop" Action="Set" Value="21" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
          	<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
	  	        <SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> <!-- POS31050 Display the keypad -->
		</OnStateEnter>
		<OnStateExit>
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
	  	        <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> <!-- POS31050 Display the keypad -->
		</OnStateExit>
      </State>
      <!-- SOTF 7538 -->
      <State Name="RESTRICTED_ITEM_AGE_NEW" Group="RESTRICTED_ITEM_AGE">
			<Detect>
				<DetectContext Context="DF_DynaFrame_labels">
					<Field Name="dynaframe_id" Equals="182"/>
				</DetectContext>
			</Detect>
			<OnStateEnter>
				<ResetContext Context="DF_DynaFrame_labels"/>
				 <SetProperty Property="IsRestricted_Prop" Action="Set" Value="1" />
                <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
          	    <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
		  	        <SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> <!-- POS31050 Display the keypad -->
			</OnStateEnter>
            <OnStateExit>
			    <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
		  	        <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> <!-- POS31050 Display the keypad -->
		    </OnStateExit>	
	  </State>
      <State Name="UNDER_RESTRICTED_AGELIMIT">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="490" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <!--SendInput Input="F2"/-->
            <SetProperty Property="IsRestricted_Prop" Action="Set" Value="0" />
            <SetProperty Property="RestrictedAge_Prop" Action="Set" Value="0" />
         </OnStateEnter>
      </State>
      <!--State Name="NEED_BIRTH_DATE_16">
			<Detect>
				<DetectContext Context="DF_Birth_date">
					<Field Name="required_age" Equals="16"/>
				</DetectContext>
			</Detect>
			<OnStateEnter>
				<ResetContext Context="DF_Birth_date"/>
				<ResetControl Control="Display"/>
				<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0"/>
				<SetProperty Property="Title1_Prop" Action="Set" Value="Age Verify"/>
				<SetProperty Property="LTT1_Prop" Action="Set" Value="Key in Date of Birth from driver's license"/>
				<SetProperty Property="LTT2_Prop" Action="Set" Value="in (MMDDYY) format to verify age 16"/>
				<SetProperty Property="DK1_Label_Alt_Prop" Action="Set" Value="Date of Birth Not Needed"/>
				<SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0"/>
				<SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1"/>
				<SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1"/>
				<SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1"/>
				<SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1"/>
				<SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1"/>
				<SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1"/>
				<SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="1"/>
				<SendControl Control="Display"/>
				<SetProperty Property="IsRestricted_Prop Action="Set" Value="1"/>
			</OnStateEnter>
		</State-->
      <State Name="NEED_BIRTH_DATE_17" Group="RESTRICTED_ITEM_AGE" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_Birth_date">
               <Field Name="required_age" Equals="17" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="IsRestricted_Prop" Action="Set" Value="1" />
            <ResetContext Context="DF_Birth_date" />
            <ResetControl Control="Display" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Age Verify" />
            <SetProperty Property="Title2_Prop" Action="Set" Value="" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Key in Date of Birth from driver's license" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="in (MMDDYY) format to verify age 17" />
            <SetProperty Property="DK1_Label_Alt_Prop" Action="Set" Value="Date of Birth Not Needed" />
            <SetProperty Property="DK2_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK3_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK4_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK5_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK6_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK7_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK8_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="1" />
            <SendControl Control="Display" />
        </OnStateEnter>
		<OnStateExit>
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
		</OnStateExit>
      </State>
      <State Name="NEED_BIRTH_DATE_18" Group="RESTRICTED_ITEM_AGE" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_Birth_date">
               <Field Name="required_age" Equals="18" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="IsRestricted_Prop" Action="Set" Value="1" />
            <ResetContext Context="DF_Birth_date" />
            <ResetControl Control="Display" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Age Verify" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Key in Date of Birth from driver's license" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="in (MMDDYY) format to verify age 18" />
            <SetProperty Property="DK1_Label_Alt_Prop" Action="Set" Value="Date of Birth Not Needed" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="1" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
		</OnStateExit>
      </State>
      <State Name="NEED_BIRTH_DATE_19" Group="RESTRICTED_ITEM_AGE" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_Birth_date">
               <Field Name="required_age" Equals="19" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="IsRestricted_Prop" Action="Set" Value="1" />
            <ResetContext Context="DF_Birth_date" />
            <ResetControl Control="Display" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Age Verify" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Key in Date of Birth from driver's license" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="in (MMDDYY) format to verify age 19" />
            <SetProperty Property="DK1_Label_Alt_Prop" Action="Set" Value="Date of Birth Not Needed" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="1" />
            <SendControl Control="Display" />
        </OnStateEnter>
		<OnStateExit>
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
		</OnStateExit>
      </State>
      <State Name="NEED_BIRTH_DATE_21" Group="RESTRICTED_ITEM_AGE" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_Birth_date">
               <Field Name="required_age" Equals="21" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="IsRestricted_Prop" Action="Set" Value="1" />
            <ResetContext Context="DF_Birth_date" />
            <ResetControl Control="Display" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Age Verify" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Key in Date of Birth from driver's license" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="in (MMDDYY) format to verify age 21" />
            <SetProperty Property="DK1_Label_Alt_Prop" Action="Set" Value="Date of Birth Not Needed" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="1" />
            <SendControl Control="Display" />
         </OnStateEnter>
		<OnStateExit>
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
		</OnStateExit>
      </State>
      <State Name="ITEM_NEEDQTY">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="91" />
            </DetectContext>
<!--- POS11024 Mobile Shopper will prompt for quantity on resume
	        <DetectProperty Property="IsResumeStarted" Equals="0" />
-->
            <DetectContext Context="DF_DynaKey_labels"/>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
         </OnStateEnter>
      </State>
      <State Name="CMOS_RESET">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="451" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="BAD_SUPERVISOR_ID">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="19" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />
            <SetProperty Value="1" Action="Set" Property="HideInput" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Invalid supervisor number" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="Press the clear key" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
 	    <SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" />  <!-- POS31050 display keypad -->
            <SendControl Control="Display" />
  	    <ResetContext Context="Operator_guidance" /> <!-- POS31051 reset the OG context -->
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Value="0" Action="Set" Property="HideInput" />
 	    <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />  <!-- POS31050 hide keypad -->
            <ResetControl Control="Display" /> <!-- POS31051 reset the OG context -->
         </OnStateExit>
      </State>
      <State Name="BAD_SUPERVISOR_PWD">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="47" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />
            <SetProperty Value="1" Action="Set" Property="HideInput" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Supervisor Override" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Invalid password" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="Press the clear key" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <SetProperty Property="OP_Guidance_Txt" Action="Set" Value="INVALID PASSWORD" />
            <SetProperty Property="OP_Guidance_Prompt" Action="Set" Value="" />
            <SetProperty Value="1" Action="Set" Property="PropIsOperGuid" />
 	    <SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" />  <!-- POS31050 display keypad -->
            <SendControl Control="Display" />
  	    <ResetContext Context="Operator_guidance" /> <!-- POS31051 reset the OG context -->
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Value="0" Action="Set" Property="HideInput" />
 	    <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />  <!-- POS31050 hide keypad -->
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" /> <!-- POS31051/31053 reset the OG context -->
         </OnStateExit>
      </State>
      <State Name="TENDER_VOIDED">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="leadthru_2" Contains="INVALID" />
            </DetectContext>
            <DetectContext Context="DF_Mode">
               <Field Name="mode" Contains="tranmode" />
            </DetectContext>
            <DetectProperty Property="PropAllTendersVoided" Equals="1" />
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropAllTendersVoided" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <!--
      <State Name="CLEAR_INVALID_SUPERVISOR_DISPLAY">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="leadthru_2" Contains="INVALID" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="1" Action="Set" Property="HideInput" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Supervisor Override" />
            <SetProperty Property="Title2_Prop" Action="Set" Value="" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Key in supervisor number." />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      -->
      <State Name="SUPERVISOR_PWD">
         <Detect>
            <DetectContext Context="DF_Error_sup_psswd" />
         </Detect>
         <OnStateEnter>
            <SetProperty Value="1" Action="Set" Property="HideInput" />
			<SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
			<SetProperty Value="1" Action="Set" Property="HHRapDataNeeded" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Supervisor Password" />
            <SetProperty Property="Title2_Prop" Action="Set" Value="" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Key in supervisor password." />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
            <ResetContext Context="DF_Error_sup_psswd" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Value="0" Action="Set" Property="HideInput" />
			<SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
			<SetProperty Value="0" Action="Set" Property="HHRapDataNeeded" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
		
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" /> <!-- POS31051/31053 reset the OG context -->
         </OnStateExit>
      </State>
      <!-- <State Name="SUPERVISOR_PWD_TEST" Group="SUPERVISOR_PWD">
         <Detect>
            <DetectContext Context="DF_Mode">
               <Field Name="mode" Contains="passmode" />
            </DetectContext>
            <DetectProperty Property="IsSupervisorApproval" Equals="1" />
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />
            <SetProperty Value="1" Action="Set" Property="HideInput" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Supervisor Password" />
            <SetProperty Property="Title2_Prop" Action="Set" Value="" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Key in supervisor password." />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
            <ResetContext Context="DF_Mode" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Value="0" Action="Set" Property="HideInput" />
            <ResetControl Control="Display"/> 
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State> -->
      <State Name="SUPERVISOR_ID">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="17" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SetProperty Value="1" Action="Set" Property="HideInput" />
			<SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
			<SetProperty Value="1" Action="Set" Property="HHRapDataNeeded" />            
            <ResetContext Context="DF_DynaFrame_labels" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Value="0" Action="Set" Property="HideInput" />
			<SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
			<SetProperty Value="0" Action="Set" Property="HHRapDataNeeded" />
         </OnStateExit>
      </State>
      <State Name="OVERQTY_LIMIT">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="33" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="BAG_ITEM_ALONE_28">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num"   RegEx="^((1058)|(1066)|(1531))$" /> <!-- POS11024 add msgs -->
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="{F1}" Action="Set" Property="ResponseCodeToSendToPOS" />
         </OnStateEnter>         
      </State>
	  <!-- Start CRD 231416 -->
	<State Name="MEP_AVAILABLE_MOBILE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1852"/> <!-- POS11024 add msgs -->
            </DetectContext>
			<DetectProperty Property="IsSCOFLMS" Equals="1" />	<!-- CRD 263529 -->
         </Detect>
		<OnStateEnter>
            <SetProperty Property="IsFromMEPAvailable" Action="Set" Value="1" />
         </OnStateEnter> 		 
      </State>	  
	<!-- End CRD 231416 -->	  
      <State Name="MEP_AVAILABLE"> <!-- Group="ITEMMENU_DK1" IgnoreDuplicate="true">-->
         <Detect>
            <!-- POS85378 MEP_AVAILABLE is the POS state for bag scale stations (which is not MobilePayStation) -->
            <DetectProperty Property="FastLaneConfiguration_Prop" Equals="MobilePayStation" Negate="true" />

           <!-- CRD 269544 instead of detecting softkey to prompt customer, we would detect and operator message
		   <DetectProperty Property="Prop_Last_DK_normal_label_7" Contains="Protection Available" />
            <DetectProperty Property="Prop_Last_DK_icon_desc_8" Contains="(Page 1 of" />
            <DetectProperty Property="Prop_Last_DK_label_asa_7" Equals="0" />
			-->
			<DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1852"/> <!-- POS11024 add msgs -->
            </DetectContext>		
<!-- POS94866 -->
			<!-- CRD 461118 - removing this check to prevent SCO from going to UNHANDLED_OG when scanning SIMPLR
			Warranty items consecutively. 
			<DetectProperty Property="IsFromMEPAvailable" Equals="0" /> -->
			<DetectProperty Property="IsSCOFLMS" Equals="0" />	<!-- CRD 263529 -->
			<DetectProperty Property="IsResumeTrxInProgress" Equals="0" />
         </Detect>
         <OnStateEnter>
<!-- POS94866 -->
            <SetProperty Property="IsFromMEPAvailable" Action="Set" Value="1" />       
            <SetProperty Value="1" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Property="EntryData_Prop" Action="Set" Value="" />
            <SetProperty Property="SeparateMedia" Action="Set" Value="0" /> 
            <SetProperty Value="0" Action="Set" Property="IsPromptForServiceDeskCode" />
            <SetProperty Value="0" Action="Set" Property="PropNegativeMedia" />
            <SetProperty Property="SignatureRequested" Action="Set" Value="" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="StoreCloseRequested" Action="Set" Value="" />
            <SetProperty Property="ForceLoadRequested" Action="Set" Value="0" />
            <SetProperty Value="0" Action="Set" Property="HideInput" />
            <SetProperty Property="Scale_Weight_Prop" Value="0" Action="Set" />
            <SendControlToApp Control="Scale" />
            <SetProperty Property="CustRequestCreditBtn" Action="Set" Value="1" />
            <SetProperty Property="TenderType" Action="Set" Value="" />
            <SetProperty Property="TenderTypeSelected" Action="Set" Value="" />
<!-- POS15302 don't disable the DK7 MEP Available button
            <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
-->
            <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
            <SetProperty Value="0" Action="Set" Property="PropIsProcessingItem" />
            <SetProperty Value="0" Action="Set" Property="PropIsVoidItem" />
            <SetProperty Value="0" Action="Set" Property="PropCMPromoLinked" />
            <SetProperty Property="IsEBTTenderInsufficient" Action="Set" Value="0" />
            <SetProperty Value="0" Action="Set" Property="IsFromAlphanumeric" />
            <SetProperty Property="PropIsFromMICR" Action="Set" Value="0" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
		
         </OnStateExit>
      </State>    
      <!-- -SOTF6417 Moved MEP_AVAILABLE state below all Operator_Guidance states -->      

      <!-- POS85378 Added MEP_AVAILABLE_NON_BAG for non bag scale stations (such as MobilePayStation)-->
      <State Name="MEP_AVAILABLE_NON_BAG">
         <Detect>
			<DetectProperty Property="IsResumeTrxInProgress" Equals="0" />
            <DetectProperty Property="FastLaneConfiguration_Prop" Equals="MobilePayStation" />
			<DetectProperty Property="IsSCOFLMS" Equals="0" />	<!-- CRD 263529 -->
            <!-- CRD 269544 instead of detecting softkey to prompt customer, we would detect and operator message
			<DetectProperty Property="Prop_Last_DK_normal_label_7" Contains="Protection Available" />
            <DetectProperty Property="Prop_Last_DK_icon_desc_8" Contains="(Page 1 of" />
            <DetectProperty Property="Prop_Last_DK_label_asa_7" Equals="0" />-->
			<DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1852"/> <!-- POS11024 add msgs -->
            </DetectContext>					
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Property="EntryData_Prop" Action="Set" Value="" />
            <SetProperty Property="SeparateMedia" Action="Set" Value="0" /> 
            <SetProperty Value="0" Action="Set" Property="IsPromptForServiceDeskCode" />
            <SetProperty Value="0" Action="Set" Property="PropNegativeMedia" />
            <SetProperty Property="SignatureRequested" Action="Set" Value="" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="StoreCloseRequested" Action="Set" Value="" />
            <SetProperty Property="ForceLoadRequested" Action="Set" Value="0" />
            <SetProperty Value="0" Action="Set" Property="HideInput" />
            <SetProperty Property="Scale_Weight_Prop" Value="0" Action="Set" />
            <SendControlToApp Control="Scale" />
            <SetProperty Property="CustRequestCreditBtn" Action="Set" Value="1" />
            <SetProperty Property="TenderType" Action="Set" Value="" />
            <SetProperty Property="TenderTypeSelected" Action="Set" Value="" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
            <SetProperty Value="0" Action="Set" Property="PropIsProcessingItem" />
            <SetProperty Value="0" Action="Set" Property="PropIsVoidItem" />
            <SetProperty Value="0" Action="Set" Property="PropCMPromoLinked" />
            <SetProperty Property="IsEBTTenderInsufficient" Action="Set" Value="0" />
            <SetProperty Value="0" Action="Set" Property="IsFromAlphanumeric" />
            <SetProperty Property="PropIsFromMICR" Action="Set" Value="0" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>    
	<!-- Start CRD 265301 -->
	  <State Name="SAS_TIMEOUT">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1853" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
		   <SetProperty Value="1" Action="Set" Property="IsSASTimeOut" />
		   <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
            <SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />	
            <SetProperty Property="IsFromUnHandledOG" Action="Set" Value="1" />
			<SendControl Control="Display" />
			<ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
	  <!-- End CRD 265301 -->
	
	  <State Name="UNMATCH_COUPON">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" RegEx="^(50[4-7])$" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="TERMINAL_DISABLED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="28" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="INVALID_OPER_NUM">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="46" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="ENTER_PASSWORD">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" RegEx="^((120)|(1273)|(1301))$" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_Signon_password" />
         </OnStateEnter>
      </State>
      <State Name="NEW_PASSWORD">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="295" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Operator_guidance" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Password" />
            <SetProperty Property="Title2_Prop" Action="Set" Value="" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Key in password" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Label_Alt_Prop" Action="Set" Value="Backup" />
            <SetProperty Property="DK2_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK3_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK4_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK5_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK6_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK7_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK8_Label_Alt_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="OG_Guidance_Prop" Action="Set" Value="NEW PASSWORD NEEDED" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>

<!-- POS223750 EMV rrs -->
     <State Name="CHIPCARD_DETECTED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1748" />
            </DetectContext>
         </Detect>
      </State>
<!-- e POS223750 EMV rrs -->

      <State Name="CONFIRM_PASSWORD">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="296" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="INVALID_PASSWORD">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="47" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="INVALID_PASSWORD_LEN">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="498" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="DUPLICATE_LOGIN">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="101" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="DUPLICATE_LOGIN_REMAIN_SIGNEDON">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="480" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="DUPLICATE_LOGIN_ALLOW">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="457" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="ILLEGAL_IN_TRX">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="257" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="ENTER_WEIGHT_KYBD">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="454" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="ENTER_WEIGHT_SCALE_KYBD">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="455" />
            </DetectContext>
         </Detect>
      </State>
	   <State Name="RESTRICTED_ITEM_MOBILE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1860" />
            </DetectContext>
         </Detect>
         <!--POS44624/POS51734 Reset display so Enhanced Store Mode has correct display after handling guidance -->
	     <OnStateEnter>
			<SendControl Control="Display" />
			<ResetContext Context="Operator_guidance"/>
		 </OnStateEnter>
		 <!--CRD 291248 <OnStateExit>
			<ResetControl Control="Display" />
		 </OnStateExit>-->
         <!-- e POS44624/POS51734 -->
      </State>
      <State Name="RESTRICTED_ITEM">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="485" />
            </DetectContext>
			<DetectProperty Property="IsSCOFLMS" Equals="0" />		
         </Detect>
      </State>
      <State Name="TARE_TOO_LARGE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="372" />
               <Field Name="msg_level" Equals="2" />
            </DetectContext>
         </Detect>
      </State>
	  <!-- Start CRD 291250 -->
	    <State Name="ALCOHOL_LIMIT_EXCEEDED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" RegEx="^((1861)|(1862)|(1863))$" />
            </DetectContext>
         </Detect>
	     <OnStateEnter>
			<SetProperty Property="AlcoholLimitExceeded" Action="Set" Value="1" />
			<SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
            <SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />	
            <SetProperty Property="IsFromUnHandledOG" Action="Set" Value="1" />
			<SendControl Control="Display" />
			<ResetContext Context="Operator_guidance"/>
		 </OnStateEnter>
      </State>
	  <!-- End CRD 291250 -->
      <State Name="RECALLED_ITEM">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" RegEx="^((59)|(1060))$" />
               <Field Name="msg_level" Equals="2" />
            </DetectContext>
			<!--POS11024:Behavior must be same for regular/resume mode for recalled items-->
			<!--Commented out detection of IsResumeStarted property-->
			<!--
	        <DetectProperty Property="IsResumeStarted" Equals="0" />
			-->
         </Detect>
	 <OnStateExit>
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" /> <!-- POS31051/31053 reset the OG context -->
         </OnStateExit>
      </State>
      <State Name="ADD_TO_PLU" Group="IGNORE_POSSTATE">
         <!-- If detect AddToPlu OG then automatically press Cancel -->
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="471" />
               <Field Name="msg_level" Equals="3" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SendInput Input="F2" />
         </OnStateEnter>
      </State>
      <State Name="CASHIER_TENDER">
         <!-- If detect "NOT GUEST SELECTED TENDER" OG  -->
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="452" />
               <Field Name="msg_level" Equals="3" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="RESUME_GIFT_CARD" Group="RESUME_GIFT_CARD">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="11" />
            </DetectContext>
            <DetectProperty Property="ReactivateGiftCardSwipe" Equals="1" />
         </Detect>
         <OnStateEnter>
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="Cancel" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="OP_Guidance_Prompt" Action="Set" Value="" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Swipe Card or Select CANCEL" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="1" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="CARD_NEEDS_REACTIVATION" Group="RESUME_GIFT_CARD">
         <!-- After resume  -->
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1023" />
               <Field Name="msg_level" Equals="3" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="LOCATE_CARD" Group="RESUME_GIFT_CARD">
         <!-- After resume  -->
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="212" />
               <Field Name="msg_level" Equals="1" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="Cancel" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="OP_Guidance_Prompt" Action="Set" Value="" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Swipe Card or Select CANCEL" />
            <SetProperty Property="ReactivateGiftCardSwipe" Action="Set" Value="1" />
            <SendInput Input="F1" />
         </OnStateEnter>
      </State>
      <State Name="ALL_CARDS_REACTIVATED" Group="RESUME_GIFT_CARD">
         <!-- After resume  -->
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1024" />
               <Field Name="msg_level" Equals="1" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="ReactivateGiftCardSwipe" Action="Set" Value="0" />
         </OnStateEnter>
      </State>

      <!-- SOTF 7718 -->
      <State Name="END_TRXN">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="92" />
            </DetectContext>            
         </Detect>         
      </State>

     <!-- POS68773  -->
     <State Name="CARD_SALE_RESTRICTED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1626" />
            </DetectContext>
         </Detect>         
         <OnStateEnter>
            <SetProperty Property="PropSaleRestricted" Action="Set" Value="1" />
            <ResetContext Context="acs_tb_interface" />
         </OnStateEnter>
      </State>
     <!-- e POS68773  -->

      <!-- sotf -->
      <State Name="SALE_RESTRICTED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="967" />
            </DetectContext>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_level" Equals="1" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropSaleRestricted" Action="Set" Value="1" />
         </OnStateEnter>
      </State>
      <!--POS12624:Added new state for Linked item-->
      <State Name="SALE_RESTRICTED_LINK">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="967" />
            </DetectContext>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_level" Equals="2" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropSaleRestricted" Action="Set" Value="1" />
         </OnStateEnter>
      </State>

      <State Name="INVALID_RECEIPT_OG">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1117" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="PSEUDOPHEDRINE_LIMIT">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1062" />
            </DetectContext>
         </Detect>
      </State>

<!-- sotf 8851 rrs -->
      <State Name="PSEUDOPHEDRINE_NOT_ALLOWED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1478" />
               <Field Name="msg_level" Equals="2" />
            </DetectContext>
         </Detect>
      </State>
<!-- sotf 8851 rrs -->

      <State Name="INVALID_ITEM_DATA">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="41" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="DISREGARD_OG" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="SPENT_DISPLAY">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="42" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
      <State Name="ZERO_AMT_ILLEGAL">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="391" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
      <State Name="CORRUPTED_PASSWORD">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="494" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Operator_guidance" />
            <SetProperty Property="ForceLoadRequested" Action="Set" Value="1" />
         </OnStateEnter>
      </State>
      <State Name="AGE_RESTRICTED_CANCELED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="139" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="IsRestricted_Prop" Action="Set" Value="0" />
            <ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
      <State Name="TM_DISCOUNT_ACTIVE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="12" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
      <State Name="RESUME_ERROR">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" RegEx="^((199)|(226)|(20[1-8]))$" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
      <State Name="INVALID_STATE_ID">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="76" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
      <State Name="INVALID_DATE" Group="INVALID_STATE_ID">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="489" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
	  <State Name="PLACE_CHECK_IN_DRAWER" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1001" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
			<SetProperty Property="PlaceCheckDrawerMsg" Action="Set" Value="PLACE CHECK IN DRAWER" />
            <ResetContext Context="Operator_guidance" />
            <SendInput Input="F1" />
         </OnStateEnter>
      </State>
<!-- POS15885 group the fingerprint pos message as ignore_posstate -->
      <State Name="FINGERPRINT_READER_UNAVAILABLE" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1270" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Operator_guidance" />
            <SendInput Input="F1" />
         </OnStateEnter>
      </State>
      <State Name="VPIM_ERROR">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="116" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
      <!-- ECHECK start -->

      <State Name="ECHECK_RETURNCHECK1">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1000" />
            </DetectContext>            
         </Detect>
         <OnStateEnter>
            <SetProperty Property="SawReturnCheckToGuest" Action="Set" Value="1" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0"/>
            <ResetContext Context="Operator_guidance" />
            <SendControl Control="Display" />
         </OnStateEnter>         
      </State>
      <State Name="ECHECK_VERIFY">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="763" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="normal_label_1" Contains="Signature Complete" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0"/>
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <!-- ECHECK end -->
      <State Name="RESUME_TRX_CONFIRM">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1021" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
      <State Name="WIC_TENDER_INVALID">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="415" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
                <ResetContext Context="Operator_guidance" />
		 </OnStateEnter>
      </State>
      <!-- SOTF 7261 -->
      <State Name="AGE_DELAY_STOP_GAP">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1404" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0"/>
            <ResetContext Context="Operator_guidance" />
            <SendControl Control="Display" />
         </OnStateEnter>     
      </State>
      <!-- SOTF 7044 -->
      <State Name="DUPLICATE_ACTIVATED_CARD">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1413" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0"/>
            <ResetContext Context="Operator_guidance" />
            <SendControl Control="Display" />
         </OnStateEnter>     
      </State>
<!--POS11024: Mobile Shopper - Start -->
<!--Added Reset of Display so that msg does not show up in AM interventions-->
      <State Name="MOB_SHOP_ORDER_PENDING_MSG">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1523" />
            </DetectContext>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_level" Equals="3" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropMobShopOrderPrompt" Action="Set" Value="1" />
            <ResetControl Control="Display" />
         </OnStateEnter>
      </State>
	  <!--Set Return to Shopping off during EAS deactivation-->
	<!-- POS31050 turn on the IgnoreDuplicate flag rrs -->
      <State Name="MOB_SHOP_EAS_DEACT" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="604" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels"/>            
   	    <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateEnter>
	 <OnStateExit>
	    </OnStateExit>
      </State>
<!--POS11024: Mobile Shopper - End -->

<!-- POS31050 Mobile Shoppert Enhancement -->
     <State Name="MOB_SHOP_SCAN_AND_COLLECT">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="607" /> <!-- POS31051 change the DF to 607 from 620 /> -->
            </DetectContext>
         </Detect>
         <OnStateEnter>
         </OnStateEnter>
      </State>
<!-- e  POS31050 Mobile Shoppert Enhancement -->

<!--POS48277 Mobile PayStation -->
      <State Name="MOB_SHOP_ORDER_NOT_FOUND">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1524" />
            </DetectContext>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_level" Equals="3" />
            </DetectContext>
            <DetectProperty Property="FastLaneConfiguration_Prop" Equals="MobilePayStation" />  <!-- POS78133: Activate MOB_SHOP_ORDER_NOT_FOUND POS state only if Mobile PayStation -->
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropMobShopOrderPrompt" Action="Set" Value="1" />
            <ResetControl Control="Display" />
         </OnStateEnter>
      </State>
<!--e POS48277 Mobile PayStation -->

      <!--POS78133: Added MOB_SHOP_ORDER_NOT_FOUND_AT_NONMOBILEPAYSTATION but handle it as if it were a UNHANDLED_OG POS state. -->
      <State Name="MOB_SHOP_ORDER_NOT_FOUND_AT_NONMOBILEPAYSTATION">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1524" />
            </DetectContext>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_level" Equals="3" />
            </DetectContext>
            <DetectProperty Property="FastLaneConfiguration_Prop" Equals="MobilePayStation" Negate="true" />
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
            <SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />	
            <SetProperty Property="IsFromUnHandledOG" Action="Set" Value="1" />
            <SendControl Control="Display" />
            <ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
	  <!--CRD 297752 put back {1}** +POS149725**{1}-->
      <State Name="SHIPTBARCODE_SCANNED_LVL1"> 
         <Detect>
            <DetectContext Context="Operator_guidance">
				<Field Name="msg_num" Equals="1841" />
			</DetectContext>
             <DetectContext Context="Operator_guidance">
               <Field Name="msg_level" Equals="1" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
		    <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
			<SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />	
			<SetProperty Value="1" Action="Set" Property="ShiptBarcodeScanned" />
			<SendControl Control="Display" />
			<ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>     
      <State Name="SHIPTBARCODE_SCANNED_LVL3"> 
         <Detect>
            <DetectContext Context="Operator_guidance">
				<Field Name="msg_num" Equals="1841" />
			</DetectContext>
             <DetectContext Context="Operator_guidance">
               <Field Name="msg_level" Equals="3" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
		    <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
			<SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />	
			<SetProperty Value="1" Action="Set" Property="ShiptBarcodeScanned" />
			<SendControl Control="Display" />
			<ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
	  <!-- Start CRD 313052 -->
	   <State Name="SHIPT_MEIJERCOM_SCANNED"> 
         <Detect>
            <DetectContext Context="Operator_guidance">
				<Field Name="msg_num" Equals="1871" />
			</DetectContext>
         </Detect>
         <OnStateEnter>
		    <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
			<SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />	
			<SetProperty Value="1" Action="Set" Property="ShiptBarcodeScanned" />
			<SendControl Control="Display" />
			<ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
	  <!-- End CRD 313052 -->
	   <State Name="SHIPTBARCODE_ALREADY_SCANNED">
         <Detect>
            <DetectContext Context="Operator_guidance">
				<Field Name="msg_num" Equals="1842" />
			</DetectContext>
         </Detect>
         <OnStateEnter>
		    <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
			<SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />	
			<SendControl Control="Display" />
			<ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
	   <State Name="SHIPTBARCODE_SCANNED_NOTALLOW_MPERKS">
         <Detect>
            <DetectContext Context="Operator_guidance">
				<Field Name="msg_num" Equals="1843" />
			</DetectContext>
         </Detect>
         <OnStateEnter>
		    <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
			<SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />	
			<SendControl Control="Display" />
			<ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>      <!-- -POS149725-->
	  <State Name="HOMEDLVRY_TRANS_MPERKS_NOT_ALLOWED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1884" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
	  <!-- Start Everseen CRD 313027 -->
	  <State Name="MISS_SCAN_ALERT">
         <Detect>
            <DetectContext Context="Operator_guidance">
				<Field Name="msg_num" Equals="1868" />
			</DetectContext>
         </Detect>
         <OnStateEnter>
		    <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
			<SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />	
			<SetProperty Value="1" Action="Set" Property="IsEverseenAlert" />	<!-- CRD 347846 -->
			<SendControl Control="Display" />
			<ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
	  <State Name="PRODUCT_SWITCH_ALERT">
         <Detect>
            <DetectContext Context="Operator_guidance">
				<Field Name="msg_num" Equals="1869" />
			</DetectContext>
         </Detect>
         <OnStateEnter>
		    <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
			<SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />	
			<SetProperty Value="1" Action="Set" Property="IsEverseenAlert" />	 <!-- CRD 347846 -->
			<SendControl Control="Display" />
			<ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>	  
	  <State Name="BASKET_LOSS_ALERT">
         <Detect>
            <DetectContext Context="Operator_guidance">
				<Field Name="msg_num" Equals="1870" />
			</DetectContext>
         </Detect>
         <OnStateEnter>
		    <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
			<SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />	
			<SetProperty Value="1" Action="Set" Property="IsEverseenAlert" />	 <!-- CRD 347846 -->
			<SendControl Control="Display" />
			<ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>	
	  <!-- End Everseen CRD 313027 -->
	  
	  <!-- Start CRD 335964 -->
	   <State Name="COUPON_992_FAMILY_CODE">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1654" />
            </DetectContext>
         </Detect>
		 <OnStateEnter>
			<ResetContext Context="Operator_guidance" />
         </OnStateEnter>
      </State>
	  <!-- End CRD 335964 -->	  
	  
	<State Name="RESUME_TRANS_NOTALLOWED">
         <Detect>
            <DetectContext Context="Operator_guidance">
               <Field Name="msg_num" Equals="1852" />
            </DetectContext>
			<OnStateEnter>
				<SetProperty Property="PropIsOperGuid" Action="Set" Value="1" />
			</OnStateEnter>
         </Detect>
      </State>
      <State Name="UNHANDLED_OG">
         <Detect>
            <DetectContext Context="Operator_guidance"></DetectContext>
         </Detect>
         <OnStateEnter>
		    <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
			<SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />	
            <SetProperty Property="IsFromUnHandledOG" Action="Set" Value="1" />
			<SendControl Control="Display" />
			<ResetContext Context="Operator_guidance" />
         </OnStateEnter>
		<!-- CRD 299390 caused to show Go Back button at Operator Message screen
		 <OnStateExit>
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
		</OnStateExit>-->
      </State>
	  <State Name="UNHANDLED_OG1" Group="IGNORE_POSSTATE">
         <Detect>
             <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="15" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
		    <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
			<SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />	
            <SetProperty Property="IsFromUnHandledOG" Action="Set" Value="1" />
			<ResetContext Context="DF_DynaFrame_labels" />
         </OnStateEnter>
      </State>
      <State Name="REQUEST_GIFT_RECEIPT">
         <Detect>
           <DetectContext Context="New_item_prompt" />
           <DetectContext Context="DF_DynaFrame_labels">  <!-- POS154789 -->
               <Field Name="dynaframe_id" Equals="48" />
            </DetectContext>
            <DetectProperty Property="PrintGiftReceipt" Equals="0" Negate="true"/>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="New_item_prompt" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropChangeDue" Action="Set" Value="" />
         </OnStateExit>
      </State>
      <State Name="NEW_ITEM_PROMPT" Group="ITEMMENU_DK1">
         <Detect>
            <DetectContext Context="New_item_prompt" />
            <DetectProperty Property="PrintGiftReceipt" Equals="0"/>	<!-- POS154789 -->
			<DetectProperty Property="IsQuickRestart" Equals="0"/>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="New_item_prompt" />
			<SetProperty Property="IsQuickChipAtItemization" Action="Set" Value="0" />
			<SetProperty Property="IsHighValueBack2BackPromo" Action="Set" Value="0" /> <!-- POS250985 aab -->
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <SetProperty Property="PropFSChange" Action="Set" Value="0" />
            <SetProperty Property="SeparateMedia" Action="Set" Value="0" /> <!-- TAR320495 -->
            <!--<SetProperty Property="RebateReceiptRequested" Action="Set" Value="0" />-->
            <SetProperty Value="0" Action="Set" Property="IsResumeStarted" />
            <SetProperty Value="0" Action="Set" Property="IsResumeReady" />		

            <SetProperty Value="0" Action="Set" Property="PropHasRebateCheck" /> <!-- POS18905 -->
	    <SetProperty Value="" Action="Set" Property="PropTransMode" /> <!-- POS18905 -->
            <SetProperty Property="ReceiptWritten" Action="Set" Value="0" />
            <SetProperty Property="CustomerHasWICFreeItems" Action="Set" Value="0" /> <!-- POS19072 -->
            <SetProperty Property="WICFreeItemPhaseActive" Action="Set" Value="0" />  <!-- POS19072 -->
            <SetProperty Property="AppleSerialNumberEntry" Action="Set" Value="0" />  <!-- POS41473 -->
            <SetProperty Property="WaitForPosScannerReady" Action="Set" Value="0" />  <!-- POS83168 -->
			<SetProperty Property="IsDelayedAgeRestrictedProp" Action="Set" Value="0" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SetProperty Property="PropChangeDue" Action="Set" Value="" />
         </OnStateExit>
      </State>
      <State Name="TENDER_ACCEPTED">
         <Detect>
            <DetectContext Context="Tender_display" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Tender_display" />
			<SetProperty Property="IsQuickChipAtItemization" Action="Set" Value="0" />
            <SetProperty Value="" Action="Set" Property="NSC4Mnemonic" />
            <SetProperty Value="" Action="Set" Property="NSC4Account" />
            <SetProperty Property="PropAllTendersVoided" Action="Set" Value="1" />
            <SetProperty Property="TenderTypeSelected" Action="Set" Value="" />
            <SetProperty Property="TenderType" Action="Set" Value="" />
			<SetProperty Property="PropWasTenderAccepted" Action="Set" Value="1" /> <!-- POS244229, reset on attract screen -->
            <!-- <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" /> SOTF 8094 -->
         </OnStateEnter>
         <OnStateExit>
            <!-- <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" /> SOTF 8094 -->
            <SendControl Control="Display" />
         </OnStateExit>
      </State>
      <State Name="FOOD_STAMP_CHANGE">
         <Detect>
            <DetectContext Context="Food_stamp_change" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Food_stamp_change" />
            <SetProperty Property="FoodStampChangeDisplay" Action="Set" Value="1" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="TRAINING_MODE_ENTRY">
         <Detect>
            <DetectContext Context="Training_mode_entry" />
         </Detect>
         <OnStateEnter>
            <SetProperty Property="IsInTrainingMode" Action="Set" Value="1" />
            <ResetContext Context="Training_mode_entry" />
         </OnStateEnter>
      </State>
      <State Name="TRAINING_MODE_EXIT">
         <Detect>
            <DetectContext Context="Training_mode_exit" />
         </Detect>
         <OnStateEnter>
            <SetProperty Property="IsInTrainingMode" Action="Set" Value="0" />
            <ResetContext Context="Training_mode_exit" />
         </OnStateEnter>
      </State>
      <State Name="GIFT_REGISTRY_SCANNED" Group="ITEMMENU_DK1">
         <Detect>
            <DetectContext Context="NSC4_account_disp">
               <Field Name="mnemonic" Contains="Registry" />
            </DetectContext>
	    <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1"/>
            <SetProperty Property="PropertyAllowMSGVoid" Action="Set" Value="1"/>
            <SendControl Control="Display"/>
            <ResetContext Context="NSC4_account_disp"/> 
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>
      <State Name="GUEST_CARD_VOIDED">
		<Detect>
            <DetectContext Context="NSC4_account_disp">
               <Field Name="void_indicator" Equals="167" />
            </DetectContext>
            <DetectProperty Property="IsResumeStarted" Equals="0" />
		</Detect>
		<OnStateEnter>
            <ResetContext Context="NSC4_account_disp"/> 
        </OnStateEnter>
      </State>
	
      <State Name="GUEST_CARD_SCANNED" Group="ITEMMENU_DK1">
         <Detect>
            <DetectContext Context="NSC4_account_disp">
               <Field Name="mnemonic" Contains="GUEST" />
            </DetectContext>
	    <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>             
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1"/>
            <SetProperty Property="PropertyAllowMSGVoid" Action="Set" Value="1"/>
            <SetProperty Property="PropertyAllowMSGEntryID" Action="Set" Value="1"/>
            <SetProperty Property="TMDOrGuestCardScanned" Action="Set" Value="1"/>
            <SendControl Control="Display"/>
            <ResetContext Context="NSC4_account_disp"/> 
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>
      <State Name="NSC4_SCANNED" Group="GUEST_CARD_SCANNED">
         <Detect>
            <DetectContext Context="NSC4_account_disp" />
			<DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>             
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1"/>
            <SetProperty Property="IsAfterNSC4Scanned" Action="Set" Value="1"/>
            <SetProperty Property="TMDOrGuestCardScanned" Action="Set" Value="1"/>
	    <SetProperty Property="PropertyAllowMSGEntryID" Action="Set" Value="1"/>  <!-- POS 10242 RRS -->
            <SendControl Control="Display"/>
            <ResetContext Context="NSC4_account_disp"/> 
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>
      <!-- POS17261: Added MEIJER_REWARD_CARD_RESUMED, so resumed Meijer Reward Card gets displayed on e-receipt -->
      <State Name="MEIJER_REWARD_CARD_RESUMED" Group="ITEMMENU_DK1">
         <Detect>
            <DetectContext Context="NSC4_account_disp">
               <Field Name="mnemonic" Contains="Meijer Card" />
            </DetectContext>
            <DetectProperty Property="IsResumeStarted" Equals="1" />
         </Detect>
         <OnStateEnter>             
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1"/>
            <SetProperty Property="PropertyAllowMSGEntryID" Action="Set" Value="1"/>
            <SetProperty Property="TMDOrGuestCardScanned" Action="Set" Value="1"/>
            <SendControl Control="Display"/>
            <ResetContext Context="NSC4_account_disp"/> 
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>
      <State Name="NEGATIVE_MEDIA" Group="ITEMMENU_DK1" IgnoreDuplicate="true">
         <Detect>
            <DetectProperty Property="PropIsFromPayment" Equals="0" />
            <DetectProperty Property="PropIsProcessingItem" Equals="0" />
            <DetectContext Context="Item_entry_display">
		       <!-- POS36319 Remove the bottle slip and coinstar rrs -->
               <!-- Misc Credit | Commercial Charge | Refundable Check | Layaway Voucher -->
               <Field Name="Department_number" RegEx="^((160)|(168)|(399)|(538))$" />
               <Field Name="item_type" Equals="9" />
			   <Field Name="item_code" Equals="VOID" Negate="true"/> <!-- if item_code is not equal to VOID -->
            </DetectContext>
	    <DetectProperty Property="IsResumeTrxInProgress" Equals="0" />
         </Detect>
         <OnStateEnter>
		    <ResetContext Context="Item_entry_display" />
            <SetProperty Value="1" Action="Set" Property="PropIsProcessingItem" />
            <SetProperty Value="1" Action="Set" Property="PropNegativeMedia" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>

<!-- POS36319 Handling bottle slip and coinstar collection rrs -->
      <State Name="NEGATIVE_MEDIA_COLLECTION" Group="ITEMMENU_DK1" IgnoreDuplicate="true">
         <Detect>
            <DetectProperty Property="PropIsFromPayment" Equals="0" />
            <DetectProperty Property="PropIsProcessingItem" Equals="0" />
            <DetectContext Context="Item_entry_display">
               <!-- Bottle Refund | Coinstar -->
               <Field Name="Department_number" RegEx="^((110)|(412))$" />
               <Field Name="item_type" Equals="9" />
			   <Field Name="item_code" Equals="VOID" Negate="true"/> <!-- if item_code is not equal to VOID -->
            </DetectContext>
	    <DetectProperty Property="IsResumeTrxInProgress" Equals="0" />
         </Detect>
         <OnStateEnter>
		    <ResetContext Context="Item_entry_display" />
            <SetProperty Value="1" Action="Set" Property="PropIsProcessingItem" />
            <SetProperty Value="1" Action="Set" Property="PropNegativeMedia" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>

      <State Name="NEGATIVE_MEDIA_AT_PAYMENT_COLLECTION" IgnoreDuplicate="true">
         <Detect>
            <DetectProperty Property="PropIsFromPayment" Equals="1" />
            <DetectProperty Property="PropIsProcessingItem" Equals="0" />
            <DetectContext Context="Item_entry_display">
                <!-- Bottle Refund | Coinstar -->
               <Field Name="Department_number" RegEx="^((110)|(412))$" />
               <Field Name="item_type" Equals="9" />
			   <Field Name="item_code" Equals="VOID" Negate="true"/>
            </DetectContext>
         </Detect>
         <OnStateEnter>
		    <ResetContext Context="Item_entry_display" />
            <SetProperty Value="1" Action="Set" Property="PropIsProcessingItem" />
            <SetProperty Value="1" Action="Set" Property="PropNegativeMedia" />
         </OnStateEnter>
      </State>
<!-- e POS36319 rrs -->

      <State Name="NEGATIVE_MEDIA_AT_PAYMENT" IgnoreDuplicate="true">
         <Detect>
            <DetectProperty Property="PropIsFromPayment" Equals="1" />
            <DetectProperty Property="PropIsProcessingItem" Equals="0" />
            <DetectContext Context="Item_entry_display">
                <!-- POS36319 Remove the bottle slip and coinstar rrs -->
                <!-- Bottle Refund | Misc Credit | Commercial Charge | Refundable Check | Coinstar | Layaway Voucher -->
               <Field Name="Department_number" RegEx="^((160)|(168)|(399)|(538))$" />
               <Field Name="item_type" Equals="9" />
			   <Field Name="item_code" Equals="VOID" Negate="true"/>
            </DetectContext>
         </Detect>
         <OnStateEnter>
		    <ResetContext Context="Item_entry_display" />
            <SetProperty Value="1" Action="Set" Property="PropIsProcessingItem" />
            <SetProperty Value="1" Action="Set" Property="PropNegativeMedia" />
         </OnStateEnter>
      </State>
      <State Name="PROMOCOUPON_MEDIA" Group="ITEMMENU_DK1" IgnoreDuplicate="true">
         <Detect>
            <DetectProperty Property="IsResumeTrxInProgress" Equals="0" />
            <DetectProperty Property="PropIsFromPayment" Equals="0" />
            <DetectProperty Property="PropIsProcessingItem" Equals="0" />
            <DetectContext Context="Item_entry_display">
               <Field Name="Department_number" Equals="420" />
			   <Field Name="item_code" Equals="VOID" Negate="true"/>
            </DetectContext>
         </Detect>
         <OnStateEnter>
			<ResetContext Context="Item_entry_display" />
            <SetProperty Property="PropIsProcessingItem" Action="Set" Value="1" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State>
      <State Name="PROMOCOUPON_MEDIA_AT_PAYMENT" IgnoreDuplicate="true">
         <Detect>
            <DetectProperty Property="PropIsFromPayment" Equals="1" />
            <DetectProperty Property="PropIsProcessingItem" Equals="0" />
            <DetectContext Context="Item_entry_display">
               <Field Name="Department_number" Equals="420" />
			   <Field Name="item_code" Equals="VOID" Negate="true"/>
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Item_entry_display" />
            <SetProperty Property="PropIsProcessingItem" Action="Set" Value="1" />
         </OnStateEnter>
      </State>
	  <State Name="TMD_CARD_VOIDED">
         <Detect>
            <DetectContext Context="TMD_ack_message">
				<Field Name="tmd_void" Equals="167" />
            </DetectContext>
			<DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
			<SetProperty Property="TMDiscount_Total" Action="Set" Value="0" />
			<!-- +SSCOI-47562 -->
			<SetProperty Property="IsTMD_Only" Action="Set" Value="0" />
			<SetProperty Property="IsCM_TMDPresent" Action="Set" Value="0" />
			<SetProperty Property="IsCMDPresent" Action="Set" Value="0" />
			<!-- -SSCOI-47562 -->
            <ResetContext Context="TMD_ack_message" />
         </OnStateEnter>
      </State>		
      <State Name="TMD_DISCOUNT_PERCENT">
         <Detect>
            <DetectContext Context="TMD_ack_message" />
			<DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="TMD_ack_message" />
            <SetProperty Property="DisplayTMDCard" Action="Set" Value="1" />
         </OnStateEnter>
      </State>
      <State Name="TMD_CARD_SCANNED" Group="ITEMMENU_DK1">
         <Detect>
            <DetectContext Context="TMD_member_info_dyna" />
			<DetectProperty Property="IsResumeStarted" Equals="0" />
			<DetectProperty Property="DisplayTMDCard" Equals="1" />
         </Detect>
         <OnStateEnter>
            <SetProperty Property="TMDOrGuestCardScanned" Action="Set" Value="1" />
            <SetProperty Property="IsAfterNSC4Scanned" Action="Set" Value="1" />
            <ResetContext Context="TMD_member_info_dyna" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <SetProperty Property="PropertyAllowMSGVoid" Action="Set" Value="1" />
            <SetProperty Property="PropertyAllowMSGEntryID" Action="Set" Value="1"/>
			</OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SetProperty Property="DisplayTMDCard" Action="Set" Value="0" />
         </OnStateExit>
      </State>
      <!-- POS17261: Added TMD_CARD_RESUMED, so resumed TMD Card gets displayed on e-receipt -->
      <State Name="TMD_CARD_RESUMED" Group="ITEMMENU_DK1">
         <Detect>
            <DetectContext Context="TMD_member_info_dyna" />
               <DetectProperty Property="IsResumeStarted" Equals="1" />
         </Detect>
         <OnStateEnter>
            <SetProperty Property="TMDOrGuestCardScanned" Action="Set" Value="1" />
            <ResetContext Context="TMD_member_info_dyna" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <SetProperty Property="PropertyAllowMSGVoid" Action="Set" Value="1" />
            <SetProperty Property="PropertyAllowMSGEntryID" Action="Set" Value="1"/>
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SetProperty Property="DisplayTMDCard" Action="Set" Value="0" />
         </OnStateExit>
      </State>
      <State Name="SALES_TRAINING_ON">
        <Detect>
            <DetectContext Context="Status_window_update">
                <Field Name="training_mode" Equals="TRAINING" />
            </DetectContext>
            <DetectProperty Property="IsInTrainingMode" Equals="0"/>
        </Detect>
        <OnStateEnter>
            <SetProperty Property="IsInTrainingMode" Action="Set" Value="1" />
        </OnStateEnter>
      </State>
      <State Name="SALES_TRAINING_OFF">
        <Detect>
            <DetectContext Context="Status_window_update">
                <Field Name="training_mode" Equals="TRAINING" Negate="1" />
            </DetectContext>
            <DetectProperty Property="IsInTrainingMode" Equals="1"/>
        </Detect>
        <OnStateEnter>
            <SetProperty Property="IsInTrainingMode" Action="Set" Value="0" />
        </OnStateEnter>
      </State>
      <State Name="LINKED_ITEM_RESUMETRX" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="752" />
            </DetectContext>
			<DetectProperty Property="IsResumeStarted" Equals="1" />
         </Detect>
         <OnStateEnter>
            <SetProperty Value="1" Action="Set" Property="LinkedItem_Prop" />
            <ResetContext Context="acs_tb_interface" />
         </OnStateEnter>
      </State>
      <State Name="LINKED_ITEM" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="752" />
            </DetectContext>
	    <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <SetProperty Value="1" Action="Set" Property="LinkedItem_Prop" />
            <ResetContext Context="acs_tb_interface" />
         </OnStateEnter>
      </State>
	  <!-- SOTF 8105
      <State Name="ITEMMENU" Group="ITEMMENU_DK1">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="48" />
            </DetectContext>
			<DetectProperty Property="ItemMenuFlag" Equals="1" />
         </Detect>
         <OnStateEnter>
		    <SetProperty Value="0" Action="Set" Property="ItemMenuFlag" />
		    <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
            <SetProperty Value="0" Action="Set" Property="PropIsProcessingItem" />
            <SetProperty Value="0" Action="Set" Property="PropIsVoidItem" />
            <SetProperty Value="0" Action="Set" Property="PropCMPromoLinked" />
            <SetProperty Value="0" Action="Set" Property="PropIsPrcVerify" />
            <SetProperty Property="PropIsFromMICR" Action="Set" Value="0" />

	    <ResetContext Context="DF_DynaFrame_labels" />
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         </OnStateExit>
      </State> -->
     

	  <State Name="ITEMMENU_DK1" Group="ITEMMENU_DK1" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="48" />
            </DetectContext>
	    <!--POS12463:Change Tare button on Page2 should not be disabled-->
	    <!--by action on DK7_Grayed_Prop-->
            <DetectProperty Property="Prop_Last_DK_icon_desc_8" Contains="(Page 1 of" />
         </Detect>
         <OnStateEnter>
			<SetProperty Property="HookPropMperksPrompt" Action="Set" Value="0" />
		    <ResetContext Context="FSCardEntered_display" /> <!-- POS277166 -->
			<ResetContext Context="FSCardEntered" /> <!-- POS277166 -->
		    <SetProperty Property="IsEMVCardOperation" Action="Set" Value="0" />
		    <SetProperty Property="IsFrom800acs_tb_interface" Action="Set" Value="0" />
		    <SetProperty Property="IsTendering" Action="Set" Value="0" />
		    <SetProperty Property="IsHighValueBack2BackPromo" Action="Set" Value="0" />
		    <SetProperty Property="WICTransaction" Action="Set" Value="0" />
			<SetProperty Property="PlaceCheckDrawerMsg" Action="Set" Value="" />
		    <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Property="EntryData_Prop" Action="Set" Value="" />
            <SetProperty Property="SeparateMedia" Action="Set" Value="0" /> <!-- TAR320495 -->
            <SetProperty Value="0" Action="Set" Property="IsPromptForServiceDeskCode" />
            <SetProperty Value="0" Action="Set" Property="PropNegativeMedia" />
            <!-- <SetProperty Value="0" Action="Set" Property="ScanNegMediaState" /> -->
            <SetProperty Property="SignatureRequested" Action="Set" Value="" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SetProperty Property="StoreCloseRequested" Action="Set" Value="" />
            <SetProperty Property="ForceLoadRequested" Action="Set" Value="0" />
            <SetProperty Value="0" Action="Set" Property="HideInput" />
            <SetProperty Property="Scale_Weight_Prop" Value="0" Action="Set" />
            <SendControlToApp Control="Scale" />
            <SetProperty Property="CustRequestCreditBtn" Action="Set" Value="1" />
            <SetProperty Property="TenderType" Action="Set" Value="" />
            <SetProperty Property="TenderTypeSelected" Action="Set" Value="" />
            <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
            <SetProperty Value="0" Action="Set" Property="PropIsProcessingItem" />
            <SetProperty Value="0" Action="Set" Property="PropIsVoidItem" />
            <SetProperty Value="0" Action="Set" Property="PropCMPromoLinked" />
            <SetProperty Value="0" Action="Set" Property="PropIsPrcVerify" />
            <SetProperty Property="IsEBTTenderInsufficient" Action="Set" Value="0" />
            <SetProperty Value="0" Action="Set" Property="IsFromAlphanumeric" />
            <SetProperty Property="PropIsFromMICR" Action="Set" Value="0" />
            <SetProperty Property="DisplayTMDCard" Action="Set" Value="0" />
            <SetProperty Property="SawReturnCheckToGuest" Action="Set" Value="0" />

            <!-- pos 12727 rrs -->
	    <SetProperty Value="0" Action="Set" Property="TaxListReceipt" />             
	    <!-- e pos 12727 rrs --> 
            <SetProperty Value="0" Action="Set" Property="RainCheckList" />  <!-- POS59850 rrs -->

            <SendControl Control="Display" />
			<ResetContext Context="DF_DynaFrame_labels" />
			<SetProperty Property="IsGoingBackToItemMenu" Action="Set" Value="0" /> <!-- POS323036 -->	
			<SetProperty Property="IsPOSRestartInprogress" Action="Set" Value="0" />
            <SetProperty Property="IsQuickRestart" Action="Set" Value="0" />			
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SetProperty Property="PropTenderDynaKey" Action="Set" Value="0" />
         </OnStateExit>
      </State>	 	
      <State Name="PRINT_MATCH" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="812" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="acs_tb_interface" />         
            <!-- Using slipStatus function to send endorsement description -->
            <ResetContext Context="Tender_franking_1_MICR" />
            <ResetContext Context="Tender_franking_1" />
            <SetProperty Value="8" Action="Set" Property="Printer_Function" />
            <SetProperty Value="2" Action="Set" Property="Printer_Station" />
            <SetProperty Value="0" Action="Set" Property="Printer_Argument" />
            <SendControl Control="Printer" />
            <SetProperty Value="Unknown" Action="Set" Property="Printer_Data" />
         </OnStateEnter>
      </State>
	  <State Name="USE_PINPAD" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="788" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="acs_tb_interface" />            
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="PIN Entry" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Enter PIN at MSR" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK3_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK4_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK5_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK6_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK7_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK8_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="1" />
			<SendControl Control="Display" />            
         </OnStateEnter>
      </State>

      <State Name="VERIFY_SIGNATURE">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="787" />
            </DetectContext>
            <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="acs_tb_interface" />
            <ResetControl Control="Display" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SetProperty Property="SignatureRequested" Action="Set" Value="1" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Verify Signature" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="Use pinpad to input signature" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="Signature Complete" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="Sign Form" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="0" />
            <SendControl Control="Display" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="" />
         </OnStateEnter>
      </State>
      <State Name="EFT_COMPLETED">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="770" />
            </DetectContext>
            <DetectProperty Property="EftCardResponseCode" Contains="NL13" />
            <DetectProperty Property="PropIsFromMICR" Equals="0" />
            <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="acs_tb_interface" />
            <ResetControl Control="Display" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SetProperty Property="SignatureRequested" Action="Set" Value="1" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Verify Signature" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="Use pinpad to input signature" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="Signature Complete" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="Sign Form" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="0" />
            <SendControl Control="Display" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="" />
         </OnStateEnter>
      </State>
	  <State Name="TENDER_FINISH" Group="EFT_COMPLETED">
         <Detect>
            <DetectContext Context="Operator_prompt">
               <Field Name="Prompt_for_operator" Contains="TENDER ACCEPTED" />
            </DetectContext>	    
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Operator_prompt"/> 
<!-- POS15437 -->
            <SetProperty Property="DK8_Label_Alt_Prop" Action="Set" Value="" />
<!-- POS15437 -->

         </OnStateEnter>
      </State>	
      <State Name="CM_PROMO_LINKEDITEM">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="800" />
            </DetectContext>
	    <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
            <SetProperty Property="PropCMPromoLinked" Action="Set" Value="1" />
         </OnStateEnter>
      </State>
      <State Name="EFT_COMPLETED2" Group="EFT_COMPLETED">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="770" />
            </DetectContext>
            <DetectProperty Property="EftCardResponseCode" Contains="RM00" />
            <DetectProperty Property="TenderType" Contains="GIFT" />
            <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="acs_tb_interface" />
            <ResetControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="EFT_COMPLETED3" Group="EFT_COMPLETED">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="770" />
            </DetectContext>
            <DetectProperty Property="EftCardResponseCode" Contains="RM00" />
            <DetectProperty Property="EBTTenderType" Contains="1" />
            <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="acs_tb_interface" />
            <ResetControl Control="Display" />
            <SetProperty Property="EBTTenderType" Action="Set" Value="0" />
         </OnStateEnter>
      </State>
      <State Name="EFT_COMPLETED4" Group="EFT_COMPLETED">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="770" />
            </DetectContext>
            <DetectProperty Property="EftCardResponseCode" Contains="RM00" />
            <DetectProperty Property="ReactivateGiftCardSwipe" Contains="1" />
            <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="acs_tb_interface" />
            <ResetControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="EFT_COMPLETED5" Group="EFT_COMPLETED">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="770" />
            </DetectContext>
            <DetectProperty Property="EftCardResponseCode" Contains="RM00" />
            <DetectProperty Property="CM_TenderType" Contains="GIFT" />
            <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="acs_tb_interface" />
            <ResetControl Control="Display" />
         </OnStateEnter>
      </State>
      <!-- <State Name="EFT_COMPLETED1" Group="EFT_COMPLETED">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="770" />
            </DetectContext>
            <DetectProperty Property="EftCardResponseCode" Contains="RM00" />
            <DetectProperty Property="PropIsFromMICR" Equals="0" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="acs_tb_interface" />
            <ResetControl Control="Display" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SetProperty Property="SignatureRequested" Action="Set" Value="1" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="Verify Signature" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="Use pinpad to input signature" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="Signature Complete" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="Sign Form" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="0" />
            <SendControl Control="Display" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="" />
            <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="" />
         </OnStateEnter>
      </State> -->
      <State Name="GIFT_PHONE_CARD_SALE">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="776" />
            </DetectContext>
	    <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="acs_tb_interface" />
         </OnStateEnter>
      </State>

      <!-- POS65108/6300 cellphone 2 step rs -->
      <State Name="CELL_PHONE_2_STEP">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="648" />
            </DetectContext>
        </Detect>
         <OnStateEnter>            
         </OnStateEnter>
      </State>
      <!-- e POS6300 cellphone 2 step rs -->

      <State Name="COUPON_ONLY_TRX">
         <Detect>
            <DetectContext Context="Item_entry_display">
               <Field Name="EntryID" Equals="1" />
               <Field Name="item_type" RegEx="^((6)|(7)|(10))$" />
            </DetectContext>
            <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Item_entry_display"/> <!-- VSTS-162023 -->
         </OnStateEnter>
      </State>
      <State Name="TOTAL_UPDATE" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="Balance_due_display" />
            <DetectProperty Property="TenderDisplaySeen" Equals="1" />
	    <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
            <SendControl Control="Total" />
            <SetProperty Value="0" Action="Set" Property="TenderDisplaySeen" />
            <ResetControl Control="Total" />
         </OnStateEnter>
      </State>
	  <State Name="REMOVE_CHECK_NO_ENDORSE">
        <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="799" />
            </DetectContext>
            <DetectProperty Property="CheckEndorsed" Equals="0" />
            <DetectProperty Property="SawReturnCheckToGuest" Equals="1" />
         </Detect>
         <OnStateEnter>
		    <ResetContext Context="acs_tb_interface" />
            <SetProperty Value="0" Action="Set" Property="SawReturnCheckToGuest" />
         </OnStateEnter>
      </State>

      <!-- <State Name="REMOVE_CHECK_NO_ENDORSE">
        <Detect>
            <DetectContext Context="serv_prt_prompt">
               <Field Name="prt_prompt_var" Contains="REMOVE" />
            </DetectContext>
            <DetectProperty Property="CheckEndorsed" Equals="0" />
            <DetectProperty Property="SawReturnCheckToGuest" Equals="1" />
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="SawReturnCheckToGuest" />
         </OnStateEnter>
      </State>
      <State Name="ENDORSE_CHECK">
         <Detect>
            <DetectContext Context="serv_prt_prompt">
               <Field Name="prt_prompt_var" Contains="REMOVE" />
            </DetectContext>
            <DetectProperty Property="CheckEndorsed" Equals="1" />
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="CheckEndorsed" />
         </OnStateEnter>
      </State>	 -->  
      
      <State Name="SENIOR_DISCOUNT">
         <Detect>
            <DetectContext Context="Discount_rt_display"></DetectContext>
	    <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Discount_rt_display" />
         </OnStateEnter>
      </State>
      <State Name="DEPARTMENT_NUMBER">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="380" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <ResetContext Context="DF_DynaKey_labels" />

	    <SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> <!-- POS31050 Display the keypad -->
         </OnStateEnter>
	 <OnStateExit>
	    <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> <!-- POS31050 Display the keypad -->
	 </OnStateExit>
      </State>
      <State Name="CALL_REFERRAL" IgnoreDuplicate="true">
         <Detect>
            <DetectProperty Property="EftCardResponseCode" Equals="" />         
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="370" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0"/>
            <ResetContext Context="DF_DynaKey_labels" />
         </OnStateEnter>
      </State>
	  <State Name="NO_SALE">
         <Detect>
            <DetectContext Context="Open_drawer_output" />
         </Detect>
         <OnStateEnter>
			<SetProperty Property="RefreshDisplay" Action="Set" Value="1" />
            <ResetContext Context="Open_drawer_output" />
         </OnStateEnter>
      </State>
	 <!-- +SSCOI-46452 -->
	 <State Name="NO_SALE">
         <Detect>
            <DetectContext Context="Balance_inquiry_quit" />
         </Detect>
         <OnStateEnter>
			<SetProperty Property="RefreshDisplay" Action="Set" Value="1" />
            <ResetContext Context="Balance_inquiry_quit" />
         </OnStateEnter>
      </State>
	  <!-- -SSCOI-46452 -->	  
      <State Name="PIN_ENTRY" Group="IGNORE_POSSTATE">
         <!-- This is a pretty hard here because the POS did not give us the new dynaframe labels
                     informing us that it is a Pin Entry now -->
         <Detect>
            <DetectContext Context="DF_Mode">
               <Field Name="mode" Contains="paymode" />
            </DetectContext>
            <DetectProperty Property="PropIsProbablyPINEntry" Equals="1" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_Mode" />
            <ResetContext Context="DF_DynaFrame_labels" />
            <ResetContext Context="DF_DynaKey_labels" />
            <ResetControl Control="Display" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Value="0" Action="Set" Property="PropIsProbablyPINEntry" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="PIN Entry" />
            <SetProperty Property="Title2_Prop" Action="Set" Value="Enter PIN at the Lane" />
            <SetProperty Value="0" Action="Set" Property="IsFromAlphanumeric" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="GONE_WITH_ALPHANUMERIC" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="normal_label_1" Contains="Backspace" />
            </DetectContext>
            <DetectProperty Property="IsFromAlphanumeric" Equals="0" />
            <DetectProperty Property="CM_TenderType" Contains="EBT" />
         </Detect>
         <OnStateEnter>
            <SetProperty Value="1" Action="Set" Property="IsFromAlphanumeric" />
         </OnStateEnter>
      </State>
      <!-- expected to be executed always. We after only here with the succeding DF_Mode of waitmode and paymode with the
                      alphanumeric dynakey detected previously and then we can say that its a pin pad entry -->
      <State Name="SET_PIN_PROP" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_Mode">
               <Field Name="mode" Contains="waitmode" />
            </DetectContext>
            <DetectProperty Property="IsFromAlphanumeric" Equals="1" />
            <DetectProperty Property="PropIsProbablyPINEntry" Equals="0" />
	    <DetectProperty Property="IsResumeStarted" Equals="0" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_Mode" />
            <SetProperty Value="1" Action="Set" Property="PropIsProbablyPINEntry" />
         </OnStateEnter>
      </State>
<!--      
      <State Name="SET_PIN_PROP_2" IgnoreDuplicate="true" Group="SET_PIN_PROP">
         <Detect>
            <DetectContext Context="DF_DynaKey_labels">
               <Field Name="normal_label_2" Contains="Cancel" />
            </DetectContext>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="12" />
            </DetectContext>
            <DetectProperty Property="EftCardResponseCode" Contains="RM55" />
         </Detect>
         <OnStateEnter>
            <SetProperty Value="1" Action="Set" Property="PropIsProbablyPINEntry" />
         </OnStateEnter>
      </State>
-->      
      <State Name="WIC_INVALID_CLEAR">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="776" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="REBATE_PRINT" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="Duplicate_rebate_receipt" />
            <DetectProperty Property="ReceiptWritten" Equals="1" />
         </Detect>
         <OnStateEnter>
            <!-- <SetProperty Property="RebateReceiptRequested" Action="Set" Value="0"/> -->
            <SetProperty Property="ReceiptWritten" Action="Set" Value="0" />
            <ResetContext Context="Duplicate_rebate_receipt" />
			<SetProperty Property="PropChangeDue" Action="Set" Value="" />
         </OnStateEnter>
      </State>
      <State Name="GIFT_PRINT">
         <Detect>
            <DetectContext Context="gift_receipt" />
            <DetectProperty Property="ReceiptWritten" Equals="1" />
         </Detect>
         <OnStateEnter>
            <!-- TAR 392580 -->
            <!-- <SetProperty Property="PrintGiftReceipt" Action="Set" Value="0" /> -->
            <SetProperty Property="ReceiptWritten" Action="Set" Value="0" />
            <ResetContext Context="gift_receipt" />
         </OnStateEnter>
      </State>

<!--        (+) POS149583 	 -->
     <State Name="WIC_CONFIRM_RECEIPT_DONE">
	<Detect>
		<DetectContext Context="tWIC_transaction_trailer"/>
	</Detect>
<!--        (+) POS215380        -->
         <OnStateEnter>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <ResetContext Context="tWIC_transaction_trailer" />
         </OnStateEnter>
	 <OnStateExit>
	    <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
	</OnStateExit>         
<!--        (-) POS215380        -->
     </State>

<!--        (-) POS149583 	 -->
      <State Name="ALL_TENDERS_VOIDED">
         <Detect>
            <DetectContext Context="Void_all_tenders_output" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Void_all_tenders_output" />
            <SendControl Control="Tender" />
         </OnStateEnter>
      </State>

<!-- POS36880 modify the LTT1 and LTT2 rrs -->
      <State Name="NEED_SECOND_BARCODE_RETRY" Group="NEED_SECOND_BARCODE" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="847" />
            </DetectContext>
            <DetectContext Context="Error_tone" />
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
			<SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
	    <!-- sotf 9402 rrs -->
            <ResetContext Context="DF_DynaFrame_labels" /> 
	    <!-- e sotf 9402 rrs -->
            <ResetContext Context="DF_DynaKey_labels" />
            <ResetContext Context="Error_tone" />
	    <SetProperty Property="LTT1_Prop" Action="Set" Value="Invalid second Barcode, please" />
	    <SetProperty Property="LTT2_Prop" Action="Set" Value="re-enter and then press ENTER" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
			<SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
         </OnStateExit>
      </State>
<!-- e POS36880 modify the LTT1 and LTT2 rrs -->

      <State Name="NEED_SECOND_BARCODE" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="847" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
			<SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
			
			<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
			
	    <!-- sotf 9402 rrs -->
            <ResetContext Context="DF_DynaFrame_labels" /> 
	    <!-- e sotf 9402 rrs -->
            <ResetContext Context="DF_DynaKey_labels" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
			<SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
         </OnStateExit>
      </State>
      <State Name="FOID_DISPLAY">
         <Detect>
            <DetectContext Context="Item_entry_foid_display"></DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Item_entry_foid_display" />
         </OnStateEnter>
      </State>
      <State Name="PRICE_INQUIRY_DISPLAY">
         <Detect>
            <DetectContext Context="Price_enquiry_normal"></DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Price_enquiry_normal" />
         </OnStateEnter>
      </State>
      <State Name="PRICE_INQUIRY_PRICE_REQ">
         <Detect>
            <DetectContext Context="Price_enquiry_price_req_nml"></DetectContext>
         </Detect>
         <OnStateEnter>
            <ResetContext Context="Price_enquiry_price_req_nml" />
         </OnStateEnter>
      </State>
      <State Name="STATE_NAME_ENTRY">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="335" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="STATE_NAME_ENTRY">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="335" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="CUSTOMER_ID_SELECTION">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="376" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="IsFromUnHandledOG" Action="Set" Value="0" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="ENTER_STATE_ID">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="377" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Property="IsFromUnHandledOG" Action="Set" Value="0" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <ResetContext Context="DF_DynaKey_labels" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
      <State Name="ID_ALPHA">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="337" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="ID_ALPHA1" Group="ID_ALPHA">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="373" />
            </DetectContext>
         </Detect>
      </State>
      <State Name="ID_REQUIRED" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="336" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <ResetContext Context="DF_DynaKey_labels" />
            <!-- <SendControl Control="Display"/> it cause a blank display of verify signature after DL scan -->
         </OnStateEnter>
      </State>
      <State Name="ID_REQUIRED1" IgnoreDuplicate="true" Group="ID_REQUIRED">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="372" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <ResetContext Context="DF_DynaKey_labels" />
            <!-- <SendControl Control="Display"/> it cause a blank display of verify signature after DL scan -->
         </OnStateEnter>
      </State>
      <State Name="SERVICE_DESK_BARCODE_REQUIRED" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="709" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
            <SetProperty Value="1" Action="Set" Property="IsPromptForServiceDeskCode" />
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <ResetContext Context="DF_DynaKey_labels" />
         </OnStateEnter>
         <OnStateExit>
	<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateExit>
      </State>
      <State Name="UPDATE_FLSCREEN_FROM_INVPASS">
         <Detect>
            <DetectContext Context="DF_Signon_password">
               <Field Name="leadthru1" Equals="Key in password" />
            </DetectContext>
            <DetectContext Context="DF_Mode" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_Signon_password" />
            <ResetControl Control="Display" />
            <SetProperty Property="Title1_Prop" Action="Set" Value="PASSWORD" />
            <SetProperty Property="Title2_Prop" Action="Set" Value="" />
            <SetProperty Property="LTT1_Prop" Action="Set" Value="Key in Password" />
            <SetProperty Property="DK1_Label_Prop" Action="Set" Value="BACKUP" />
            <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
            <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
            <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="1" />
            <SetProperty Property="PropChangeDue" Action="Set" Value="" />
            <SetProperty Property="PropIsOperGuid" Action="Set" Value="1" />
            <SetProperty Property="OP_Guidance_Txt" Action="Set" Value="PLEASE ENTER PASSWORD" />
            <SetProperty Property="OP_Guidance_Prompt" Action="Set" Value="" />
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
		<!-- STATE IGNORE_POSSTATE should NEVER be matched! Needed to satisfy use of 
		     IGNORE_POSSTATE group  -->
		<State Name="IGNORE_POSSTATE">
			<Detect>
				<DetectProperty Property="DoNotChange_POSSTATE" Equals="12345678"/>
			</Detect>
		</State>
		<State Name="CMTOTAL_UPDATE" Group="IGNORE_POSSTATE">
			<Detect>
				<DetectContext Context="CM_Total_update">
					<Field Name="Transaction_total" Equals="0" Negate="1"/>
				</DetectContext>
				<DetectProperty Property="IsResumeStarted" Equals="0" />
			</Detect>
			<OnStateEnter>
				<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
				<ResetContext Context="CM_Total_update" />
				<SendControl Control="Total"/>
			</OnStateEnter>
		</State>
		<State Name="SET_CHECKHANDLING_OFF" Group="IGNORE_POSSTATE">
            <Detect>
                <DetectContext Context="acs_tb_interface">
                    <Field Name="tb_int" Equals="794" />
                    <Field Name="tb_long" Equals="0" />
                </DetectContext>
            </Detect>
            <OnStateEnter>
                <ResetContext Context="acs_tb_interface" />
                <SetProperty Property="SlipCheckHandling" Action="Set" Value="0" />
            </OnStateEnter>
         </State>
		 <State Name="SET_CHECKHANDLING_ON" Group="IGNORE_POSSTATE">
            <Detect>
                <DetectContext Context="acs_tb_interface">
                    <Field Name="tb_int" Equals="794" />
                    <Field Name="tb_long" Equals="1" />
                </DetectContext>
            </Detect>
            <OnStateEnter>
                <ResetContext Context="acs_tb_interface" />
                <SetProperty Property="SlipCheckHandling" Action="Set" Value="1" />
            </OnStateEnter>
         </State>
         <State Name="SET_CHECK21_OFF" Group="IGNORE_POSSTATE">
            <Detect>
                <DetectContext Context="acs_tb_interface">
                    <Field Name="tb_int" Equals="795" />
                    <Field Name="tb_long" Equals="0" />
                </DetectContext>
            </Detect>
            <OnStateEnter>
                <ResetContext Context="acs_tb_interface" />
                <SetProperty Property="SlipCheck21" Action="Set" Value="0" />
            </OnStateEnter>
         </State>
		 <State Name="SET_CHECK21_ON" Group="IGNORE_POSSTATE">
            <Detect>
                <DetectContext Context="acs_tb_interface">
                    <Field Name="tb_int" Equals="795" />
                    <Field Name="tb_long" Equals="1" />
                </DetectContext>
            </Detect>
            <OnStateEnter>
                <ResetContext Context="acs_tb_interface" />
                <SetProperty Property="SlipCheck21" Action="Set" Value="1" />
            </OnStateEnter>
         </State>
         <State Name="SET_CHECKFLIP_OFF" Group="IGNORE_POSSTATE">
            <Detect>
                <DetectContext Context="acs_tb_interface">
                    <Field Name="tb_int" Equals="796" />
                    <Field Name="tb_long" Equals="0" />
                </DetectContext>
            </Detect>
            <OnStateEnter>
                <ResetContext Context="acs_tb_interface" />
                <SetProperty Property="SlipCheckFlip" Action="Set" Value="0" />
            </OnStateEnter>
         </State>
		 <State Name="SET_CHECKFLIP_ON" Group="IGNORE_POSSTATE">
            <Detect>
                <DetectContext Context="acs_tb_interface">
                    <Field Name="tb_int" Equals="796" />
                    <Field Name="tb_long" Equals="1" />
                </DetectContext>
            </Detect>
            <OnStateEnter>
                <ResetContext Context="acs_tb_interface" />
                <SetProperty Property="SlipCheckFlip" Action="Set" Value="1" />
            </OnStateEnter>
         </State>
		 <State Name="SET_WICEBT_OFF" Group="IGNORE_POSSTATE">
            <Detect>
                <DetectContext Context="acs_tb_interface">
                    <Field Name="tb_int" Equals="797" />
                    <Field Name="tb_long" Equals="0" />
                </DetectContext>
            </Detect>
            <OnStateEnter>
                <ResetContext Context="acs_tb_interface" />
                <SetProperty Property="IsWIC_EBT_ON" Action="Set" Value="0" />
				<SetProperty Property="IsTEXAS_WIC_ON" Action="Set" Value="0" />  <!-- CRD 345698 -->
            </OnStateEnter>
         </State>
		 <State Name="SET_WICEBT_ON" Group="IGNORE_POSSTATE">
            <Detect>
                <DetectContext Context="acs_tb_interface">
                    <Field Name="tb_int" Equals="797" />
                    <Field Name="tb_long" Equals="1" />
                </DetectContext>
            </Detect>
            <OnStateEnter>
                <ResetContext Context="acs_tb_interface" />
                <SetProperty Property="IsWIC_EBT_ON" Action="Set" Value="1" />
				<SetProperty Property="IsTEXAS_WIC_ON" Action="Set" Value="0" /> <!-- CRD 345698 -->
            </OnStateEnter>
         </State>
		 <!-- Start CRD 345698 -->
		  <State Name="SET_TEXASWIC_ON" Group="IGNORE_POSSTATE">
            <Detect>
                <DetectContext Context="acs_tb_interface">
                    <Field Name="tb_int" Equals="797" />
                    <Field Name="tb_long" Equals="2" />
                </DetectContext>
            </Detect>
            <OnStateEnter>
                <ResetContext Context="acs_tb_interface" />
                <SetProperty Property="IsWIC_EBT_ON" Action="Set" Value="0" />
                <SetProperty Property="IsTEXAS_WIC_ON" Action="Set" Value="1" />
            </OnStateEnter>
         </State>
		 <!-- End CRD 345698 -->
		 <!-- Start CRD 313027 313028 -->
	    <State Name="EVERSEEN_ENABLED" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="1836" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
	 <SetProperty Property="EverseenEnabled" Action="Set" Value="1" />
	 <SendControl Control="EverseenProperties"/>
	 <ResetContext Context="acs_tb_interface" />
         </OnStateEnter>
		</State>
	  <!-- End CRD 313028 -->
	    <State Name="SVCARD_LEGAL_TENDER">
            <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="708" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
			<SetProperty Value="1" Action="Set" Property="PropIsPrcMethod" />
			<SetProperty Property="IsItSVCardLegalTender" Action="Set" Value="1" />
            <ResetContext Context="DF_DynaFrame_labels" />
         </OnStateEnter>
		 <OnStateExit>
            <SetProperty Property="PropIsPrcMethod" Action="Set" Value="0" />
			<SetProperty Property="IsItSVCardLegalTender" Action="Set" Value="0" />
         </OnStateExit>
      </State>
	  <State Name="SVCARD_LEGAL_TENDER_DETAILS" Group="IGNORE_POSSTATE">
         <Detect>
            <DetectContext Context="acs_tb_interface">
               <Field Name="tb_int" Equals="900" />
            </DetectContext>
         </Detect>
         <OnStateEnter>
			<SetProperty Property="IsItSVCardLegalTender" Action="Set" Value="1" />
			<SendControl Control="ACSReward" />
            <ResetContext Context="acs_tb_interface" />
         </OnStateEnter>
		 <OnStateExit>
            <SetProperty Property="IsItSVCardLegalTender" Action="Set" Value="0" />
         </OnStateExit>
      </State>      
      <State Name="VOID_PREPAID_CARDS">
			<Detect>
				<DetectContext Context="DF_DynaFrame_labels">
					<Field Name="dynaframe_id" Equals="773" />
				</DetectContext>
			</Detect>
			<OnStateEnter>
				<SetProperty Value="1" Action="Set" Property="VoidPrepaidCards" />
				<ResetContext Context="DF_DynaFrame_labels" />
				<ResetContext Context="DF_DynaKey_labels" />			
			</OnStateEnter>
			<OnStateExit>
				<SetProperty Value="0" Action="Set" Property="VoidPrepaidCards" />
				<SetProperty Value="" Action="Set" Property="PrepaidCardList" />
			</OnStateExit>
		</State>

<!-- pos57686   -->
      <State Name="RAIN_CHECK_LIST">
			<Detect>
				<DetectContext Context="DF_DynaFrame_labels">
					<Field Name="dynaframe_id" Equals="188" />
				</DetectContext>
			</Detect>
			<OnStateEnter>
				<SetProperty Value="0" Action="Set" Property="VoidPrepaidCards" />
				<ResetContext Context="DF_DynaFrame_labels" />				
 	          		                <SendControl Control="Display" />
			</OnStateEnter>
			<OnStateExit>				
			</OnStateExit>
		</State>
<!-- e pos57686 rrs  -->

<!-- SOTF 8380 - O2S Robert -->
	<State Name="STORE_2_GO" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="788" />  	       
            </DetectContext>
	    <!-- <DetectProperty Property="IsResumeStarted" Equals="0"/> -->

         </Detect>
         <OnStateEnter>
            <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
	    <!-- <SetProperty Value="1" Action="Set" Property="HHRapVirtualKeyboardNeeded" /> -->
	    <!-- SOTF 9070 rrs -->
	    <SetProperty Value="1" Action="Set" Property="VoidPrepaidCards" />
	    <!-- E SOTF 9070 rrs -->
            <ResetContext Context="DF_DynaFrame_labels" />
            <SendControl Control="Display" />
         </OnStateEnter>
         <OnStateExit>
			<SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
			<SetProperty Value="0" Action="Set" Property="VoidPrepaidCards" />
         </OnStateExit>
      </State>


      <State Name="SIGNATURE_VERIFY" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="786" />  
            </DetectContext>
         </Detect>
         <OnStateEnter>
	    <!-- SOTF 9034 RRS -->
	    <SetProperty Value="0" Action="Set" Property="IsResumeStarted" />
	    <!-- E SOTF 9034 RRS -->

            <ResetContext Context="DF_DynaFrame_labels" />
         </OnStateEnter> 
	<OnStateExit>
		<SetProperty Value="1" Action="Set" Property="PropertyAllowAMExit" />	
       </OnStateExit>
      </State> 
<!-- E SOTF 8380 O2S Robert -->

<!-- POS6135 CopyFileFromServer Robert -->
      <State Name="POS_RELOAD_OPTION_START" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="Reload_options_start">
            </DetectContext>
         </Detect>
         <OnStateEnter>
	    <SetProperty Value="0" Action="Set" Property="IsPOSReloadOptionDone" /> 
            <ResetContext Context="Reload_options_start" />
         </OnStateEnter> 
      </State> 
      <State Name="POS_RELOAD_OPTION_END" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="Reload_options">
            </DetectContext>
         </Detect>
         <OnStateEnter>
	    <SetProperty Value="1" Action="Set" Property="IsPOSReloadOptionDone" /> 
            <ResetContext Context="Reload_options" />
         </OnStateEnter> 
      </State> 
<!-- POS6135 CopyFileFromServer Robert -->

<!-- (+) POS101707  -->

    <State Name="COUPON_PRICE_VALIDATION" IgnoreDuplicate="true">
         <Detect>
            <DetectContext Context="DF_Cpn_prc_val">
            </DetectContext>
         </Detect>
	<OnStateEnter>
 	  <SendControl Control="Display" />
         </OnStateEnter> 

    </State>

<!-- (-) POS101707  -->

<!-- POS138630  -->
<State Name="WIC_CUSTOMER_CONFIRMATION1">
	<Detect>
<!-- (+) POS153885  -->
	    <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="568" />
            </DetectContext>
               <DetectContext Context="DF_DynaKey_labels">
	 <Field Name="label_asa_1" Equals="1" />
            </DetectContext>
         </Detect>
<!-- (+) POS154789 -->
	<OnStateEnter>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SendControl Control="Display" />
         </OnStateEnter>
	 <OnStateExit>
	    <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
	</OnStateExit>         

<!-- (-) POS154789 -->
      </State>

       <State Name="WIC_CUSTOMER_CONFIRMATION2">
         <Detect>
	    <DetectContext Context="DF_DynaFrame_labels">
               <Field Name="dynaframe_id" Equals="568" />
            </DetectContext>
               <DetectContext Context="DF_DynaKey_labels">
	 <Field Name="label_asa_1" Equals="0" />
            </DetectContext>
<!-- (-) POS153885  -->
         </Detect>
         <OnStateEnter>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SendControl Control="Display" />
         </OnStateEnter>
	 <OnStateExit>
	    <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
	</OnStateExit>
      </State>

<!-- POS138630  -->

<!-- (+) POS189696  -->
<State Name="WIC_ACCOUNT_ENTRY">
        		<Detect>
				<DetectContext Context="DF_DynaFrame_labels">
					<Field Name="dynaframe_id" Equals="562" />
				</DetectContext>
			</Detect>
         <OnStateEnter>
            <SendControl Control="Display" />
         </OnStateEnter>
      </State>
<!-- (-) POS189696  -->

<!-- (+) POS235150 -->
      <State Name="PRICE_REQUIRED_VENDOR_COUPON">
         <Detect>
            <DetectContext Context="DF_DynaFrame_labels">               
               <Field Name="title_1" Contains="Price Required" />
               <Field Name="title_2" Contains="VENDOR COUPON" />
               <Field Name="leadthru_1" Contains="Key-in unit price." />
               <Field Name="dynaframe_id" Equals="90" />
            </DetectContext>
            <DetectContext Context="DF_DynaKey_labels" />
         </Detect>
         <OnStateEnter>
            <ResetContext Context="DF_DynaFrame_labels" />
            <!-- If attendant goes into Assist Mode, use PropertyAllowAMExit to prevent exiting until coupon price is entered. -->
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
            <SendControl Control="Display" />			  <!-- Reset the operator guidance context -->
         </OnStateEnter>
         <OnStateExit>
            <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="1" />
         </OnStateExit>
      </State>
<!-- (-) POS235150  -->
	<State Name="SIGNIN_MENU_TOMORROWMODE" Group="SIGNIN_MENU">
	 <Detect>
        <DetectContext Context="acs_tb_interface">
            <Field Name="tb_int" Equals="766" />
        </DetectContext>
	</Detect>
		<OnStateEnter>
            <ResetContext Context="acs_tb_interface" />
         </OnStateEnter>
    </State>
  </States>
   <Properties>
	  <Property Name="IsSCOFLMS" InitialValue="0"/> <!-- CRD136007 -->
	  <Property Name="DOBEntry" InitialValue="0"/> <!-- SSCOI-45255 -->
<Property Name="IsSND" InitialValue="0"/> <!-- CRD 157372 -->
<!-- POS94866 -->
      <Property Name="IsFromMEPAvailable" InitialValue="0"/>
      <Property Name="HHRapVirtualKeyboardNeeded" InitialValue="0"/>
      <Property Name="HHRapDataNeeded" InitialValue="0"/>
	  <Property Name="PropItemType" MapContext="Item_entry_display" MapContextField="item_type" InitialValue=""/>	
      <Property Name="NeedAMProcessing" InitialValue="0"/>
      <Property Name="PropTenderDynaKey" InitialValue="0" />

<!-- (+) POS111636   -->
      <Property Name="Prop_Last_DK_normal_desc_1" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="normal_desc_1" />
      <Property Name="Prop_Last_DK_normal_desc_2" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="normal_desc_2" />
      <Property Name="Prop_Last_DK_normal_desc_3" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="normal_desc_3" />
      <Property Name="Prop_Last_DK_normal_desc_4" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="normal_desc_4" />
      <Property Name="Prop_Last_DK_normal_desc_5" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="normal_desc_5" />
      <Property Name="Prop_Last_DK_normal_desc_6" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="normal_desc_6" />
      <Property Name="Prop_Last_DK_normal_desc_7" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="normal_desc_7" />
      <Property Name="Prop_Last_DK_normal_desc_8" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="normal_desc_8" />
      <Property Name="Prop_Last_DK_normal_label_7" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="normal_label_7" />
<!-- (-) POS111636   -->
      <Property Name="Prop_Last_DK_icon_desc_8" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="icon_desc_8" />
      <Property Name="Prop_Last_DK_label_asa_7" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="label_asa_7" />
      <Property Name="CMPromoLinked_LTT1" InitialValue="" MapContext="DF_DynaFrame_labels" MapContextField="leadthru_1" />
      <Property Name="PropCMPromoLinked" InitialValue="0" />
      <Property InitialValue="" Name="Item_descriptor_Prop" MapContext="Item_entry_display" MapContextField="Item_descriptor" />
      <Property Name="PropSaleRestricted" InitialValue="0" />
      <Property Name="PropFromRTS" InitialValue="0" />
      <Property Name="PropEnterPressed" InitialValue="0" />
      <Property Name="PropNegativeMedia" InitialValue="0" />
      <!-- <Property Name="ScanNegMediaState" InitialValue="0" /> -->
      <Property Name="PropIsInvalidSignature" InitialValue="0" />
      <Property Name="PropFSChange" InitialValue="0" />
      <Property InitialValue="" Name="Prop_item_code" MapContext="Item_entry_display" MapContextField="item_code" />
      <Property InitialValue="" Name="PropVoidIndicator" MapContext="Item_entry_display" MapContextField="void_indicator" />
      <Property InitialValue="" Name="PropGiftRebateInd" MapContext="Item_entry_display" MapContextField="GiftRebateInd" />
      <Property InitialValue="" Name="PropGiftRebateInd2" MapContext="Item_entry_pkg_price_display"
         MapContextField="RebateR" />
      <Property InitialValue="" Name="PropRebateReceiptNums" MapContext="Item_entry_pkg_price_display"
         MapContextField="RebateReceiptNums" />
      <Property InitialValue="" Name="PropChangeDue" />
      <Property Name="PropIsProcessingItem" InitialValue="0" />
      <Property Name="PropAllTendersVoided" InitialValue="0" />
      <Property Name="Scale_Weight_Prop" InitialValue="0" />
      <Property Name="PropEntryId" InitialValue="" />
      <Property Name="PropFLNotifyId" InitialValue="" />
      <Property Name="PropFLNotifyData" InitialValue="" />
      <Property Name="OG_Guidance_Prop" InitialValue="" MapContext="Operator_guidance" MapContextField="Guidance_for_operator" />
      <Property Name="OG_MsgLevel_Prop" InitialValue="" MapContext="Operator_guidance" MapContextField="msg_level" />
      <Property Name="OG_MsgNum_Prop" InitialValue="" MapContext="Operator_guidance" MapContextField="msg_num" />
      <Property Name="Orig_price_display" InitialValue="" MapContext="Item_entry_orig_price_display"
         MapContextField="original_price" />
      <Property Name="FS_Change_Prop" InitialValue="" MapContext="Food_stamp_change" MapContextField="fs_change" />
      <Property Name="tb_int" InitialValue="" MapContext="acs_tb_interface" MapContextField="tb_int" />
      <Property Name="EftCardResponseCode" InitialValue="" MapContext="acs_tb_interface" MapContextField="EFTCardResponseCode" />
<!-- POS11024 Mobile Shopper store tb_char and item_code value -->
      <Property Name="tb_char" InitialValue="" MapContext="acs_tb_interface" MapContextField="tb_char" />
      <Property Name="item_code" InitialValue="" MapContext="acs_tb_interface" MapContextField="item_code" />
      <Property Name="EftTenderDescription" InitialValue="" MapContext="acs_tb_interface" MapContextField="EFTTenderDescription" />

<!-- POS31050 Mobile Enhancement rrs -->
      <Property Name="tb_long" InitialValue="0" MapContext="acs_tb_interface" MapContextField="tb_long" />
      <Property Name="number_of_sold_item" InitialValue="0" />
      <Property Name="transaction_subtotal_from_tb_int" InitialValue="0" MapContext="acs_tb_interface" MapContextField="Transaction_subtotal" />
      <Property Name="transaction_subtotal_mobile_item" InitialValue="0" />
<!-- e POS31050 Mobile Enhancement rrs -->

<!-- POS39475 High Value mPerks Promo Choice -->
      <Property Name="HighValuePromoChoice" InitialValue="0" />
      <Property Name="tb_ExpirationDate" InitialValue="" MapContext="acs_tb_interface" MapContextField="EFTCardExpirationDate" />
      <Property Name="HighValuePromoResponseYes" InitialValue="{F1}" />
      <Property Name="HighValuePromoResponseNo" InitialValue="{F2}" />
      <Property Name="TenderSelectedSoftkey" InitialValue="{F3}" />

<!-- POS33020 Vendor Coupon Choice -->
<!-- output_tb_data.acs_tb_interface.tb_char = ECouponDescAndCode; -->
<!-- output_tb_data.acs_tb_interface.EFTCardExpirationDate = ECouponValueAndExpDate; -->
<!-- output_tb_data.acs_tb_interface.item_code = PaperCouponDescAndCode; -->
<!-- output_tb_data.acs_tb_interface.mnemonic = PaperCouponValueAndExpDate; -->
<!-- output_tb_data.acs_tb_interface.Item_rec_flags = (LG *)&coupon_reversal; -->
      <Property Name="CouponChoiceFeatureEnabled" InitialValue="0" />
      <Property Name="CouponChoice" InitialValue="0" />
      <Property Name="tb_mnemonic" InitialValue="" MapContext="acs_tb_interface" MapContextField="mnemonic" />
      <Property Name="tb_Item_rec_flags" InitialValue="" MapContext="acs_tb_interface" MapContextField="Item_rec_flags" />
      <Property Name="CouponChoiceResponseMperks" InitialValue="{F1}" />
      <Property Name="CouponChoiceResponseVendor" InitialValue="{F2}" />

<!-- POS41473 AppleCare Warranty -->
      <Property Name="AppleSerialNumberEntry" InitialValue="0" />

      <Property Name="PropertyAllowAMExit" InitialValue="0" />
      <Property Name="PropIsOperGuid" InitialValue="0" />
      <Property Name="PropIsPrcMethod" InitialValue="0" />
      <Property Name="PropIsVoidItem" InitialValue="0" />
      <Property Name="Title1_Prop" InitialValue="" />
      <Property Name="Title2_Prop" InitialValue="" />
      <Property Name="LTT1_Prop" InitialValue="" />
      <Property Name="LTT2_Prop" InitialValue="" />
      <Property Name="DK1_Grayed_Prop" InitialValue="" />
      <Property Name="DK2_Grayed_Prop" InitialValue="" />
      <Property Name="DK3_Grayed_Prop" InitialValue="" />
      <Property Name="DK4_Grayed_Prop" InitialValue="" />
      <Property Name="DK5_Grayed_Prop" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="label_asa_5" />
      <Property Name="DK6_Grayed_Prop" InitialValue="" />
      <Property Name="DK7_Grayed_Prop" InitialValue="" />
<!-- POS15437 -->
      <Property Name="DK8_Grayed_Prop" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="label_asa_8" />
<!-- e POS15437 -->
      <Property Name="DK1_Label_Prop" InitialValue="" />
      <Property Name="DK2_Label_Prop" InitialValue="" />
      <Property Name="DK3_Label_Prop" InitialValue="" />
      <Property Name="DK4_Label_Prop" InitialValue="" />
      <Property Name="DK5_Label_Prop" InitialValue="" />
      <Property Name="DK6_Label_Prop" InitialValue="" />
      <Property Name="DK7_Label_Prop" InitialValue="" />
      <Property Name="DK8_Label_Prop" InitialValue="" />
      <Property Name="AgeVerifyValue" InitialValue="0" />
      <Property Name="RewardContextNum" InitialValue="0" />
      <Property Name="LinkedItem_Prop" InitialValue="0" />
      <Property Name="DK1_Label_Alt_Prop" InitialValue="" />
      <Property Name="DK2_Label_Alt_Prop" InitialValue="" />
      <Property Name="DK3_Label_Alt_Prop" InitialValue="" />
      <Property Name="DK4_Label_Alt_Prop" InitialValue="" />
      <Property Name="DK5_Label_Alt_Prop" InitialValue="" />
      <Property Name="DK6_Label_Alt_Prop" InitialValue="" />
      <Property Name="DK7_Label_Alt_Prop" InitialValue="" />
<!-- POS15437 -->
      <Property Name="DK8_Label_Alt_Prop" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="icon_label_8" />
<!-- POS15437 -->
      <Property Name="TenderTypeSelected" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="normal_desc_3" />
      <Property Name="TenderType" InitialValue="" MapContext="Tender_total_display" MapContextField="Tender_descriptor" />
      <Property Name="TestTenderType" InitialValue="" MapContext="Tender_total_display" MapContextField="Tender_descriptor" />
	  <Property Name="CM_TenderType" InitialValue="CM_Test" MapContext="Tender_total_display" MapContextField="Tender_descriptor" />
      <Property Name="CustRequestCreditBtn" InitialValue="1" /> <!-- MapContext="DF_DynaKey_labels" MapContextField="label_asa_6" /> -->
      <Property Name="NSC4Mnemonic" InitialValue="" MapContext="NSC4_account_disp" MapContextField="mnemonic" />
      <Property Name="NSC4Account" InitialValue="" MapContext="NSC4_account_disp" MapContextField="account_number" />
      <Property Name="NSC4MemberEntryID" InitialValue="" MapContext="NSC4_account_disp" MapContextField="EntryID" />
      <Property Name="TMDDiscountPercent" InitialValue="" MapContext="TMD_ack_message" MapContextField="tmd_disc_percent" />
      <Property Name="TMDMemberEntryID" InitialValue="" MapContext="TMD_ack_message" MapContextField="EntryID" />
      <Property Name="TMDMemberName" InitialValue="" MapContext="TMD_member_info_dyna" MapContextField="tmd_name" />
      <Property Name="TMDMemberNumber" InitialValue="" MapContext="TMD_member_info_dyna" MapContextField="tmd_num" />
      <Property Name="GM_Total_Subtotal" InitialValue="0" MapContext="Subtotal_running_display"
         MapContextField="gm_total" />
      <Property Name="GM_Total_Subtotal_CM" InitialValue="0" MapContext="Subtotal_running_display_CM"
         MapContextField="gm_total" />
      <Property Name="GM_Total_TMD" InitialValue="0" MapContext="TMD_running_discount_amt_TM" MapContextField="gm_total" />
      <Property Name="GM_Total_TMD_CM" InitialValue="0" MapContext="TMD_running_discount_amt_CM"
         MapContextField="gm_total" />
      <Property Name="TMDiscount_Total" InitialValue="0" MapContext="TMD_running_discount_amt_TM"
         MapContextField="tmd_discount" />
      <Property Name="TMDiscount_Total_CM" InitialValue="0" MapContext="TMD_running_discount_amt_CM"
         MapContextField="tmd_discount" />
      <Property Name="Printer_Station" InitialValue="0" />
      <Property Name="Printer_Argument" InitialValue="0" />
      <Property Name="Printer_Function" InitialValue="0" />
      <Property Name="Printer_Data" InitialValue="" />
      <Property Name="TenderDisplaySeen" InitialValue="0" />
      <Property Name="HideInput" InitialValue="0" />
      <Property Name="CheckEndorsed" InitialValue="0" />
      <Property Name="OP_Guidance_Txt" InitialValue="" />
      <Property Name="OP_Guidance_Prompt" InitialValue="" />
      <Property Name="ForceLoadRequested" InitialValue="" />
      <Property Name="ReceiptWritten" InitialValue="0" />
      <Property Name="StoreCloseRequested" InitialValue="" />
      <Property Name="SeparateMedia" InitialValue="" />
      <Property Name="SeparateMediaExceptLastTrxn" InitialValue="" />
      <Property Name="NintendoSerialNum" InitialValue="" MapContext="Nintendo_disply" MapContextField="nintendo_warranty" />
      <Property Name="DiscountRate" InitialValue="" MapContext="Discount_rt_display" MapContextField="discount_rate" />
      <Property Name="SignatureRequested" InitialValue="" />
      <Property Name="SignPaperForm" InitialValue="0" />
<!-- POS51551 Use DF_Alphanum_display instead of DF_Alphanum_display_lc context -->
      <Property Name="EntryData_Prop" InitialValue="" MapContext="DF_Alphanum_display" MapContextField="buffer" />
      <Property Name="DealQuantity" InitialValue="0" MapContext="Item_entry_display" MapContextField="deal_quantity" />
      <!--<Property Name="NotEBTDeclineSlip" InitialValue="0" />-->
      <Property Name="ItemWeight" InitialValue="0" />
      <Property Name="SuppressAmountAudio" InitialValue="0" />
      <Property Name="RefreshDisplay" InitialValue="0" />
      <Property Name="ResponseCodeToSendToPOS" InitialValue="" />
      <Property Name="ACSRunningOffline" InitialValue="" MapContext="Status_window_update" MapContextField="offline" />
      <Property Name="PropIsProbablyPINEntry" InitialValue="0" />
      <Property Name="TRXENDDone" InitialValue="0" />
      <Property Name="IsTendering" InitialValue="0" />
      <Property Name="IsRestricted_Prop" InitialValue="0" />
      <!-- <Property Name="RestrictedAge_Prop" InitialValue="0" MapContext="DF_Birth_date" MapContextField="required_age" /> -->
      <Property Name="RestrictedAge_Prop" InitialValue="0" />
      <Property Name="CM_Tendering_Amt" InitialValue="0" MapContext="CM_Total_update" MapContextField="Transaction_total" />
      <Property Name="ItemFlag" InitialValue="" MapContext="Item_entry_display" MapContextField="fam_vend_del_indicator" />
      <Property Name="PrintGiftReceipt" InitialValue="0" />
      <Property Name="RebateReceiptRequested" InitialValue="0" />
      <Property Name="OperatorNumber" InitialValue="0" MapContext="Signon" MapContextField="Operator_number" />
      <Property Name="PropIsFromPayment" InitialValue="0" />
      <Property Name="ReactivateGiftCardSwipe" InitialValue="0" />
      <Property Name="PropertyAllowMSGVoid" InitialValue="0" />
      <Property Name="PropertyAllowMSGEntryID" InitialValue="0" />      
      <Property Name="PropertyAllowMSGVoidsBTYPE" InitialValue="0" />
      <Property Name="IsTransactionVoided_Prop" InitialValue="0" />
      <Property Name="EBTTenderType" InitialValue="0" />
      <Property Name="IsAgeRestrictedFromStoreMode" InitialValue="0" />
      <Property Name="EFTCardNumber_Prop" InitialValue="" MapContext="acs_tb_interface" MapContextField="EFTCardNumber" />
      <Property Name="IsEBTTenderInsufficient" InitialValue="0" />
      <Property Name="IsFromAlphanumeric" InitialValue="0" />
      <Property Name="GiftCardInUse" InitialValue="0" />
      <Property Name="IsItemNotVoidable" InitialValue="0" MapContext="DF_DynaKey_labels" MapContextField="label_asa_3" />
	  <Property Name="Label3Text" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="icon_label_3" />
      <Property Name="Foidmonth" InitialValue="" MapContext="Item_entry_foid_display" MapContextField="month" />
      <Property Name="Foidday" InitialValue="" MapContext="Item_entry_foid_display" MapContextField="day" />
      <Property Name="Foidyear" InitialValue="" MapContext="Item_entry_foid_display" MapContextField="year" />
      <Property Name="FoidID" InitialValue="" MapContext="Item_entry_foid_display" MapContextField="id_number" />
      <Property Name="PriceInq_Desc" InitialValue="" MapContext="Price_enquiry_normal" MapContextField="Item_descriptor" />
      <Property Name="PriceInq_Price" InitialValue="" MapContext="Price_enquiry_normal" MapContextField="calculated_price" />
      <Property Name="PriceInq_Desc_Price_req" InitialValue="" MapContext="Price_enquiry_price_req_nml"
         MapContextField="Item_descriptor" />
      <Property Name="IsSupervisorApproval" InitialValue="0" />
      <Property Name="CMDiscount_Total" InitialValue="0" MapContext="Subtotal_running_display_CM"
         MapContextField="cm_tran_disc" />
      <Property Name="CMDiscount_Total_TM" InitialValue="0" MapContext="TMD_running_discount_amt_CM"
         MapContextField="cm_tran_disc" />
      <Property Name="IsCM_TMDPresent" InitialValue="0" />
      <Property Name="IsCMDPresent" InitialValue="0" />
      <Property Name="IsTMD_Only" InitialValue="0" />
      <Property Name="IsFromUnHandledOG" InitialValue="0" />
      <Property Name="PropDynaFrameID" InitialValue="" MapContext="DF_DynaFrame_labels" MapContextField="dynaframe_id" />
      <Property Name="IsCustomerSelectedActive" InitialValue="0" MapContext="DF_DynaKey_labels"
         MapContextField="label_asa_3" />
      <Property Name="ForStreamlineEPaymentCredit" InitialValue="" />
      <Property Name="IsPromptForServiceDeskCode" InitialValue="0" />
      <Property Name="PropIsFromMICR" InitialValue="0" />
      <Property Name="IsAfterNSC4Scanned" InitialValue="0" />
      <Property Name="TMDOrGuestCardScanned" InitialValue="0" />
      <Property Name="FoodStampChangeDisplay" InitialValue="0" />
      <Property Name="IsVoidingPhoneGift" InitialValue="0" />
      <Property Name="IsResumeTrxInProgress" InitialValue="0" />
      <Property Name="IsResumeComplete" InitialValue="0" />
	  <Property Name="IsResumeReady" InitialValue="0" />
	  <Property Name="IsResumeCompleteLocal" InitialValue="0" /> <!-- this is locally use in application model, not in TB or SSF-->
      <Property Name="AgeRequiredLeadThru" InitialValue="0" MapContext="DF_DynaFrame_labels" MapContextField="leadthru_2" />
	  <Property Name="IsACSIgnoreItemsOnResume" InitialValue="1" /> 	
      <Property Name="DoNotChange_POSSTATE" InitialValue="0" />
	  <Property Name="IsResumeStarted" InitialValue="0" />
	  <Property Name="IsItSVCardLegalTender" InitialValue="0" />	
	  <Property Name="PlaceCheckDrawerMsg" InitialValue="" />	
	  <Property Name="IsVoiding" InitialValue="0" />
      <Property Name="Item_descriptor_last" InitialValue="" MapContext="Last_item_entry_display" MapContextField="item_descriptor" />
      <Property Name="PropVerifyItemPrice" InitialValue="" MapContext="DF_Prc_method" MapContextField="pricing_desc" />
      <Property Name="PriceVerifyItemDesc" InitialValue="" MapContext="DF_Prc_method" MapContextField="desc" />
	  <!-- POS11024 Mobile Shopper get item upc -->
      <Property Name="PriceVerifyItemUPC" InitialValue="" MapContext="DF_Prc_method" MapContextField="item_upc" />
	  <Property Name="PropIsPrcVerify" InitialValue="0" />
	  <Property Name="DisplayTMDCard" InitialValue="0" />
      <Property Name="SuspendingCurrentTransaction" InitialValue="0" />
      <Property Name="IsInTrainingMode" InitialValue="0" />
      <Property Name="ItemMenuFlag" InitialValue="0" />
<!-- POS240201 -->
      <Property Name="PropTransMode" InitialValue="" MapContext="Status_window_update" MapContextField="trans_bitmap" />
<!-- e POS240201 -->
      <Property Name="IsWIC_EBT_ON" InitialValue="0" />
	  <Property Name="WICTransaction" InitialValue="0" />
      <Property Name="CustomerHasWICFreeItems" InitialValue="0" /> <!-- POS19072 -->
      <Property Name="WICFreeItemPhaseActive" InitialValue="0" />  <!-- POS19072 -->
	  <Property Name="TrxChangeDue" InitialValue="0" MapContext="End_of_tran_dis_no_change" MapContextField="Change_due" />
	  <Property Name="SlipCheckHandling" InitialValue="0" />
      <Property Name="SlipCheck21" InitialValue="0" />
      <Property Name="SlipCheckFlip" InitialValue="0" />      
      <Property Name="SawReturnCheckToGuest" InitialValue="0" />
 	  <Property Name="VoidPrepaidCards" InitialValue="0" />
	  <Property Name="PrepaidCardList" InitialValue="" />
	  <Property Name="WICList" InitialValue="" />	<!-- POS154826 -->

      <Property Name="RainCheckList" InitialValue="" /> <!-- pos57686 -->
      <Property Name="WICItemList" InitialValue="" /> <!-- POS154826 -->

      <Property Name="PropBiometricData" InitialValue = "" />
      <Property Name="PropBiometricCount" InitialValue = "0" />
      <Property Name="PropTenderAmountDue" InitialValue="0" MapContext="Tender_total_display" MapContextField="Subtotal" />
      <Property Name="EnableDigitalCoupons" InitialValue="0" /> <!-- SOTF6400 -->
      <Property Name="DigitalCouponAccountNo" InitialValue="" MapContext="FSCardEntered_display" MapContextField="account_number" /> <!-- SOTF6400 -->
	  <Property Name="FSCardAccountNo" InitialValue="" MapContext="FSCardEntered" MapContextField="account_number" /> <!-- bug265521 -->
      <Property Name="DigitalCouponAccountNo" InitialValue="" MapContext="FSCardEntered_display" MapContextField="account_number" /> <!-- +SSCOI-45881+-->
      <Property Name="ACSDelayedAgeRestricted" InitialValue="0" MapContext="acs_sco_options1" MapContextField="reservedch1" />   <!-- SOTF 6226 -->
	  <!-- Start CRD 345698 -->
      <Property Name="RAPAttendantTrackingGrocery" InitialValue="0" MapContext="acs_sco_options1" MapContextField="reservedch2" />
      <Property Name="RAPAttendantTrackingGM" InitialValue="0" MapContext="acs_sco_options1" MapContextField="reservedch3" /> 
      <Property Name="RAPAttendantTrackingScanPortal" InitialValue="0" MapContext="acs_sco_options1" MapContextField="reservedch4" /> 
      <Property Name="RAP1" InitialValue="0" MapContext="acs_sco_options1" MapContextField="reservedch5" /> 
      <Property Name="RAP2" InitialValue="0" MapContext="acs_sco_options1" MapContextField="reservedch6" /> 
      <Property Name="RAP3" InitialValue="0" MapContext="acs_sco_options1" MapContextField="reservedch7" /> 
      <Property Name="RAP4" InitialValue="0" MapContext="acs_sco_options1" MapContextField="reservedch8" /> 
      <Property Name="RAP5" InitialValue="0" MapContext="acs_sco_options1" MapContextField="reservedch9" /> 
      <Property Name="RAP6" InitialValue="0" MapContext="acs_sco_options1" MapContextField="reservedch10" /> 
      <Property Name="RAP7" InitialValue="0" MapContext="acs_sco_options1" MapContextField="reservedch11" /> 
      <Property Name="RAPAttendantTrackingEnabled" InitialValue="0" MapContext="acs_sco_options1" MapContextField="reservedch21" /> <!-- CRD 392418 -->
	  <!-- End CRD 345698 -->
      <!-- SOTF 7042 -->
      <Property Name="DK1_Label_Text" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="normal_label_1" />
      <Property Name="DK2_Label_Text" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="normal_label_2" />
      <Property Name="DK3_Label_Text" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="normal_label_3" />
      <Property Name="DK4_Label_Text" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="normal_label_4" />
      <Property Name="DK5_Label_Text" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="normal_label_5" />
      <Property Name="DK6_Label_Text" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="normal_label_6" />
      <Property Name="DK7_Label_Text" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="normal_label_7" />
      <Property Name="DK8_Label_Text" InitialValue="" MapContext="DF_DynaKey_labels" MapContextField="normal_label_8" />
	  <!-- sotf -->
      <!-- pos 12127 tax table rrs -->
      <Property Name="TaxListReceipt" InitialValue="" />
      <Property Name="TaxTableHeaderTitle" InitialValue="" MapContext="TaxToggle_Scroll_Title" MapContextField="TaxToggleHeader1" />
      <!-- e pos 12127 tax table rrs -->

      <!-- pos 6135 copyfilefromserver rrs -->
      <Property Name="IsPOSReloadOptionDone" InitialValue="1" />
      <!-- e pos 6135 copyfilefromserver rrs -->

      <!-- pos 18905 WIC Rebate Check rrs -->
      <Property Name="PropHasRebateCheck" InitialValue="0" />
      <!-- e pos 18905 WIC Rebate Check rrs -->

      <Property Name="PropMobShopOrderPrompt" InitialValue="0" /><!--POS11024 Mobile Shopper-->  
      <Property Name="PropItemDesc" InitialValue="" MapContext="DF_DynaFrame_labels" MapContextField="title_2" /><!--POS11024 Mobile Shopper -->
      <Property Name="PropEASDeact" InitialValue="0" /><!--POS11024 Mobile Shopper-->  	
      <Property Name="FastLaneConfiguration_Prop" InitialValue="" /><!--POS78133: Initially indicate that FastLane configuration is not known -->  	
      <Property Name="WaitForPosScannerReady" InitialValue="0" /><!--POS83168: Initially indicate that no waiting is needed before enabling the scanner -->

      <Property Name="ACSVersion" InitialValue="" MapContext="DF_Main_menu" MapContextField="pkg_version" /><!--POS145373 Additional Information on SSCO -->
	  <Property Name="IsDelayedAgeRestrictedProp" InitialValue="0" />
	  <Property Name="IsHighValueBack2BackPromo" InitialValue="0" />
	  <Property Name="IsFromResumeTrx" InitialValue="0" /> <!--POS253532-->
	   <!-- POS277295 -->
	  <Property Name="IsFrom800acs_tb_interface" InitialValue="0" />
	   <!-- POS277295 -->
	   
	  <Property Name="PropWasTenderAccepted" InitialValue="0" /> <!-- POS244229, reset on attract screen -->
	  <Property Name="IsEMVCardOperation" InitialValue="0" />
	  <Property Name="IsWICTenderButton" InitialValue="0" />
	  <Property Name="HookPropMperksPrompt" InitialValue="0" />
	  <Property Name="IsQuickChipAtItemization" InitialValue="0" />
	  <Property Name="IsGoingBackToItemMenu" InitialValue="0" /><!-- POS323036 -->
	  <!-- Start CRD 130212 -->
	  <Property Name="IsAnEASItem" InitialValue="0" /> 
	  <Property Name="EASItemDescription" InitialValue="0" /> 
	  <Property Name="EASItemEntryID" InitialValue="0" /> 
	  <Property Name="IsMobileGenericDelayed" InitialValue="0" /> <!-- CRD 223409 -->
	  <Property Name="IsInStoreMode" InitialValue="0" /> <!-- CRD 223409 -->
	  <!-- End CRD 130212 -->
	  <!-- CRD185924 -->
	  <Property Name="IsPOSRestartInprogress" InitialValue="0" /> 
	  <Property Name="IsQuickRestart" InitialValue="0" /> <!-- CRD185924 -->
    <Property Name="IsNewPOSSoftwareAvailable" InitialValue="0" /> 
    <Property Name="IsSASTimeOut" InitialValue="0" /> 	<!-- CRD 265301 -->
    <Property Name="AlcoholLimitExceeded" InitialValue="0" /> 	<!-- CRD 291250 -->
    <Property Name="RecallModeWaitForMperks" InitialValue="0" /> 	<!-- CRD 293397 -->
    <Property Name="EverseenEnabled" InitialValue="0" /> 	<!-- CRD 313028 -->
    <!-- CRD185924 -->    
	<Property Name="ShiptBarcodeScanned" InitialValue="0" /> <!-- CRD 297752 -->
	<Property Name="IsEverseenAlert" InitialValue="0" /> <!-- CRD 347846 -->
	<Property Name="IsTEXAS_WIC_ON" InitialValue="0" /> <!-- CRD 345698 -->
   </Properties>
   <!-- Controls are what we refer to as TBMsgs.  The entries here allow mapping 
          Context Field values or property values directly in to Control fields.  Valid 
          controls and control fields are found in tbControls.xml.  It is not required that
          all control fields be mapped here. -->
   <Controls>
      <Control Name="Display">
         <!-- From the DF_DynaFrame_labels context, we get the screens title, lead-thru text and id. This can
    // come through without a DK message and does during screen refreshes. Whenever the DF context is
    // different from the previous DF, then a DF_DynaKey_labels message will follow. -->
         <ControlField Name="Title1" MapContext="DF_DynaFrame_labels" MapContextField="title_1" />
         <ControlField Name="Title2" MapContext="DF_DynaFrame_labels" MapContextField="title_2" />
         <ControlField Name="LTT1" MapContext="DF_DynaFrame_labels" MapContextField="leadthru_1" />
         <ControlField Name="LTT2" MapContext="DF_DynaFrame_labels" MapContextField="leadthru_2" />
         <ControlField Name="DF_ID" MapContext="DF_DynaFrame_labels" MapContextField="dynaframe_id" />
         <!--// Dynaframe labels -these are determined by first looking at the DF_DynaKey_labels.normal_label_X field.
    // If this is emtpy, then use the DF_DynaKey_labels.icon_label_X field. X is 1 through 8. DF_DynaKey_labels
    // can come through without being preceded by a DF_DynaFram_labels message and do so when the "more" button
    // is pressed on a DF. DK contexts always seem to terminate the display sequencing. -->
         <ControlField Name="DK1_Label" MapContext="DF_DynaKey_labels" MapContextField="normal_label_1" />
         <ControlField Name="DK2_Label" MapContext="DF_DynaKey_labels" MapContextField="normal_label_2" />
         <ControlField Name="DK3_Label" MapContext="DF_DynaKey_labels" MapContextField="normal_label_3" />
         <ControlField Name="DK4_Label" MapContext="DF_DynaKey_labels" MapContextField="normal_label_4" />
         <ControlField Name="DK5_Label" MapContext="DF_DynaKey_labels" MapContextField="normal_label_5" />
         <ControlField Name="DK6_Label" MapContext="DF_DynaKey_labels" MapContextField="normal_label_6" />
         <ControlField Name="DK7_Label" MapContext="DF_DynaKey_labels" MapContextField="normal_label_7" />
         <ControlField Name="DK8_Label" MapContext="DF_DynaKey_labels" MapContextField="normal_label_8" />
         <ControlField Name="DK1_Label_Alt" MapContext="DF_DynaKey_labels" MapContextField="icon_label_1" />
         <ControlField Name="DK2_Label_Alt" MapContext="DF_DynaKey_labels" MapContextField="icon_label_2" />
         <ControlField Name="DK3_Label_Alt" MapContext="DF_DynaKey_labels" MapContextField="icon_label_3" />
         <ControlField Name="DK4_Label_Alt" MapContext="DF_DynaKey_labels" MapContextField="icon_label_4" />
         <ControlField Name="DK5_Label_Alt" MapContext="DF_DynaKey_labels" MapContextField="icon_label_5" />
         <ControlField Name="DK6_Label_Alt" MapContext="DF_DynaKey_labels" MapContextField="icon_label_6" />
         <ControlField Name="DK7_Label_Alt" MapContext="DF_DynaKey_labels" MapContextField="icon_label_7" />
         <ControlField Name="DK8_Label_Alt" MapContext="DF_DynaKey_labels" MapContextField="icon_label_8" />
         <!--// The dynakeys are disabled or greyed out when DF_DynaKey_labels.label_asa_1 is equal to ASA_GRAY_OUT
    // or ASA_GRAY_OUT_UNDERLINE. These are defined in saleslnf.h and copied below for reference    
    //#define ASA_GRAY_OUT 1
    //#define ASA_GRAY_OUT_UNDERLINE 3
    // The dynakeys are also disabled when the DF_DynaKey_labels.dkey_id_X is 0 (zero). X is 1 through 8.-->
         <ControlField Name="DK1_Grayed" MapContext="DF_DynaKey_labels" MapContextField="label_asa_1" />
         <ControlField Name="DK2_Grayed" MapContext="DF_DynaKey_labels" MapContextField="label_asa_2" />
         <ControlField Name="DK3_Grayed" MapContext="DF_DynaKey_labels" MapContextField="label_asa_3" />
         <ControlField Name="DK4_Grayed" MapContext="DF_DynaKey_labels" MapContextField="label_asa_4" />
         <ControlField Name="DK5_Grayed" MapContext="DF_DynaKey_labels" MapContextField="label_asa_5" />
         <ControlField Name="DK6_Grayed" MapContext="DF_DynaKey_labels" MapContextField="label_asa_6" />
         <ControlField Name="DK7_Grayed" MapContext="DF_DynaKey_labels" MapContextField="label_asa_7" />
         <ControlField Name="DK8_Grayed" MapContext="DF_DynaKey_labels" MapContextField="label_asa_8" />
         <ControlField Name="DK1_Enabled" MapContext="DF_DynaKey_labels" MapContextField="dkey_id_1" />
         <ControlField Name="DK2_Enabled" MapContext="DF_DynaKey_labels" MapContextField="dkey_id_2" />
         <ControlField Name="DK3_Enabled" MapContext="DF_DynaKey_labels" MapContextField="dkey_id_3" />
         <ControlField Name="DK4_Enabled" MapContext="DF_DynaKey_labels" MapContextField="dkey_id_4" />
         <ControlField Name="DK5_Enabled" MapContext="DF_DynaKey_labels" MapContextField="dkey_id_5" />
         <ControlField Name="DK6_Enabled" MapContext="DF_DynaKey_labels" MapContextField="dkey_id_6" />
         <ControlField Name="DK7_Enabled" MapContext="DF_DynaKey_labels" MapContextField="dkey_id_7" />
         <ControlField Name="DK8_Enabled" MapContext="DF_DynaKey_labels" MapContextField="dkey_id_8" />
         <!-- The Tax table options available are specified by the context field values that come in -->
         <ControlField Name="DK1_Grayed" MapContext="DF_Manual_tax" MapContextField="tax_table_1_asa" />
         <ControlField Name="DK2_Grayed" MapContext="DF_Manual_tax" MapContextField="tax_table_2_asa" />
         <ControlField Name="DK3_Grayed" MapContext="DF_Manual_tax" MapContextField="tax_table_3_asa" />
         <ControlField Name="DK4_Grayed" MapContext="DF_Manual_tax" MapContextField="tax_table_4_asa" />
         <ControlField Name="Title2" MapContext="DF_Oit_tax_amt" MapContextField="tax_table" />
         <!-- 
    // These are text labels contained under the dynakey text labels in small font
    -->
         <ControlField Name="DK1_Desc" MapContext="DF_DynaKey_labels" MapContextField="icon_desc_1" />
         <ControlField Name="DK2_Desc" MapContext="DF_DynaKey_labels" MapContextField="icon_desc_2" />
         <ControlField Name="DK3_Desc" MapContext="DF_DynaKey_labels" MapContextField="icon_desc_3" />
         <ControlField Name="DK4_Desc" MapContext="DF_DynaKey_labels" MapContextField="icon_desc_4" />
         <ControlField Name="DK5_Desc" MapContext="DF_DynaKey_labels" MapContextField="icon_desc_5" />
         <ControlField Name="DK6_Desc" MapContext="DF_DynaKey_labels" MapContextField="icon_desc_6" />
         <ControlField Name="DK7_Desc" MapContext="DF_DynaKey_labels" MapContextField="icon_desc_7" />
         <ControlField Name="DK8_Desc" MapContext="DF_DynaKey_labels" MapContextField="icon_desc_8" />
         <ControlField Name="DK1_Icon" MapContext="DF_DynaKey_labels" MapContextField="icon_bitmap_1" />
         <ControlField Name="DK2_Icon" MapContext="DF_DynaKey_labels" MapContextField="icon_bitmap_2" />
         <ControlField Name="DK3_Icon" MapContext="DF_DynaKey_labels" MapContextField="icon_bitmap_3" />
         <ControlField Name="DK4_Icon" MapContext="DF_DynaKey_labels" MapContextField="icon_bitmap_4" />
         <ControlField Name="DK5_Icon" MapContext="DF_DynaKey_labels" MapContextField="icon_bitmap_5" />
         <ControlField Name="DK6_Icon" MapContext="DF_DynaKey_labels" MapContextField="icon_bitmap_6" />
         <ControlField Name="DK7_Icon" MapContext="DF_DynaKey_labels" MapContextField="icon_bitmap_7" />
         <ControlField Name="DK8_Icon" MapContext="DF_DynaKey_labels" MapContextField="icon_bitmap_8" />
         <!--
      Operator Guidance is a text box that replaces the e-receipt in Assist Mode. I have always seen
      Operator_guidance followed by DF_DynaFrame_labels followed by DF_DynaKey_labels contexts. 
    -->
         <ControlField Name="OperGuid_Txt" MapContext="Operator_guidance" MapContextField="Guidance_for_operator" />
         <ControlField Name="OperGuid_Prompt" MapContext="Operator_guidance" MapContextField="Prompt_for_operator" />
         <ControlField Name="OperGuid_Num" MapContext="Operator_guidance" MapContextField="msg_num" />
         <ControlField Name="OperGuid_Level" MapContext="Operator_guidance" MapContextField="msg_level" />
         <ControlField Name="Prc_method_desc" MapContext="DF_Prc_method" MapContextField="desc" />
         <ControlField Name="Prc_method_prc" MapContext="DF_Prc_method" MapContextField="base_price" />
         <ControlField Name="Void_item_desc" MapContext="DF_Void_item_mods" MapContextField="item_desc" />
         <ControlField Name="Void_item_quantity" MapContext="DF_Void_item_mods" MapContextField="quantity" />
         <ControlField Name="Void_item_price" MapContext="DF_Void_item_mods" MapContextField="price" />
         <!-- Barbara needs some way to determine when she can exit assist mode. We will have a bool that will
                   let her know. The way we determine the value of that bool is still to be determined. Some thoughts,
                  we cannot allow AM exit when there is Operator Guidance. It would be nice to restrict exiting AM to -->
         <ControlField Name="AllowAMExit" MapProperty="PropertyAllowAMExit" />
         <ControlField Name="IsOperGuid" MapProperty="PropIsOperGuid" />
         <ControlField Name="IsPrcMethod" MapProperty="PropIsPrcMethod" />
         <ControlField Name="IsVoidItem" MapProperty="PropIsVoidItem" />
         <!-- Property overrides for display messages that don't have context data that bind to them.  We basically
                  wire property values to these controls instead so that they may be manipulated directly when the 
                  contexts in question arrive - e.g. DF_Md_amt. 
            -->
         <ControlField Name="Title1" MapProperty="Title1_Prop" />
         <ControlField Name="Title2" MapProperty="Title2_Prop" />
         <ControlField Name="LTT1" MapProperty="LTT1_Prop" />
         <ControlField Name="LTT2" MapProperty="LTT2_Prop" />
         <ControlField Name="DK1_Grayed" MapProperty="DK1_Grayed_Prop" />
         <ControlField Name="DK2_Grayed" MapProperty="DK2_Grayed_Prop" />
         <ControlField Name="DK3_Grayed" MapProperty="DK3_Grayed_Prop" />
         <ControlField Name="DK4_Grayed" MapProperty="DK4_Grayed_Prop" />
         <ControlField Name="DK5_Grayed" MapProperty="DK5_Grayed_Prop" />
         <ControlField Name="DK6_Grayed" MapProperty="DK6_Grayed_Prop" />
         <ControlField Name="DK7_Grayed" MapProperty="DK7_Grayed_Prop" />
         <ControlField Name="DK8_Grayed" MapProperty="DK8_Grayed_Prop" />
         <ControlField Name="DK1_Label" MapProperty="DK1_Label_Prop" />
         <ControlField Name="DK2_Label" MapProperty="DK2_Label_Prop" />
         <ControlField Name="DK3_Label" MapProperty="DK3_Label_Prop" />
         <ControlField Name="DK4_Label" MapProperty="DK4_Label_Prop" />
         <ControlField Name="DK5_Label" MapProperty="DK5_Label_Prop" />
         <ControlField Name="DK6_Label" MapProperty="DK6_Label_Prop" />
         <ControlField Name="DK7_Label" MapProperty="DK7_Label_Prop" />
         <ControlField Name="DK8_Label" MapProperty="DK8_Label_Prop" />
         <ControlField Name="DK1_Label_Alt" MapProperty="DK1_Label_Alt_Prop" />
         <ControlField Name="DK2_Label_Alt" MapProperty="DK2_Label_Alt_Prop" />
         <ControlField Name="DK3_Label_Alt" MapProperty="DK3_Label_Alt_Prop" />
         <ControlField Name="DK4_Label_Alt" MapProperty="DK4_Label_Alt_Prop" />
         <ControlField Name="DK5_Label_Alt" MapProperty="DK5_Label_Alt_Prop" />
         <ControlField Name="DK6_Label_Alt" MapProperty="DK6_Label_Alt_Prop" />
         <ControlField Name="DK7_Label_Alt" MapProperty="DK7_Label_Alt_Prop" />
         <ControlField Name="DK8_Label_Alt" MapProperty="DK8_Label_Alt_Prop" />
         <ControlField Name="LTT1" MapContext="End_of_tran_dis_no_change" MapContextField="thank_you" />
         <ControlField Name="LTT2" MapContext="End_of_tran_dis_no_change" MapContextField="cust_name" />
         <ControlField Name="OperGuid_Txt" MapProperty="OP_Guidance_Txt" />
         <ControlField Name="OperGuid_Prompt" MapProperty="OP_Guidance_Prompt" />
         <ControlField Name="EntryData" MapProperty="EntryData_Prop" />
         <ControlField Name="ChangeDue" MapContext="End_of_transaction_display" MapContextField="Change_due" />
         <ControlField Name="ChangeDue" MapContext="End_of_tran_dis_no_change" MapContextField="Change_due" />
         <ControlField Name="ChangeDue" MapContext="End_of_transaction_print" MapContextField="Change_due" />
         <ControlField Name="ChangeDue" MapProperty="PropChangeDue" />

         <!-- pos 12127 taxtable list -->
         <ControlField Name="TaxList_Selected" MapContext="TaxToggle_SSCSelection" MapContextField="selection" />
         <!-- e pos 12127 taxtable list -->

         <!-- pos57686 raincheck -->
         <ControlField Name="Raincheck_Selected" MapContext="DF_rainck_selection" MapContextField="selection" />
         <!-- e pos57686 raincheck -->
      </Control>         

      <Control Name="ItemDetails">
         <ControlField Name="ItemCode" MapContext="Item_entry_display" MapContextField="item_code" />
         <ControlField Name="ItemDescription" MapContext="Item_entry_display" MapContextField="item_descriptor_and_item_code" />

	 <!-- SOTF 8380 - O2S - RRS -->
	 <ControlField Name="ItemCode" MapContext="O2S_box_id_disp" MapContextField="box_id" />
         <ControlField Name="ItemDescription" MapContext="O2S_box_id_disp" MapContextField="box_id" />
         <ControlField Name="EntryID" MapContext="O2S_box_id_disp" MapContextField="EntryID" />
	 <ControlField Name="UserString" MapContext="O2S_box_id_disp" MapContextField="void_item" />
	<!-- E - SOTF 8380 - O2S - RRS -->

         <ControlField Name="Department" MapContext="Item_entry_display" MapContextField="Department_number" />
         <ControlField Name="UnitPrice" MapContext="Item_entry_display" MapContextField="Base_item_price" />
         <ControlField Name="ExtendedPrice" MapContext="Item_entry_display" MapContextField="calculated_price" />
         <ControlField Name="EntryID" MapContext="Item_entry_display" MapContextField="EntryID" />
         <ControlField Name="Quantity" MapContext="Item_entry_display" MapContextField="Key_entered_quantity" />
         <ControlField Name="Weight" MapContext="Item_entry_weight_display" MapContextField="Key_entered_weight" />
         <ControlField Name="Weight" MapContext="Item_entry_display" MapContextField="Key_entered_weight" />
         <ControlField Name="UserLong" MapContext="Item_entry_display" MapContextField="item_type" />
         <ControlField Name="LinkedItem" MapProperty="LinkedItem_Prop" />
         <ControlField Name="IsRestricted" MapProperty="IsRestricted_Prop" />          
         <ControlField Name="RestrictedAge" MapProperty="RestrictedAge_Prop" />

          <!-- SOTF 6226 -->
         <ControlField Name="IsRestricted" MapContext="Item_entry_display" MapContextField="required_age" />         
         <ControlField Name="RestrictedAge" MapContext="Item_entry_display" MapContextField="required_age" />
          <!-- -sotf -->

         <ControlField Name="UserString" MapContext="Item_entry_display" MapContextField="GiftRebateInd" />
         <ControlField Name="LinkedItemCode" MapContext="acs_tb_interface" MapContextField="Linked_item_code" />		  
      </Control>
      <Control Name="Total">
         <ControlField Name="TotalDue" MapContext="Item_entry_display" MapContextField="Transaction_subtotal" />
         <ControlField Name="TotalDue" MapContext="Balance_due_display" MapContextField="Transaction_subtotal" />
         <ControlField Name="TotalDue" MapContext="Subtotal_running_display" MapContextField="Transaction_subtotal" />
         <ControlField Name="TotalDue" MapContext="Subtotal_running_display_CM" MapContextField="Transaction_subtotal" />
         <ControlField Name="TotalDue" MapContext="CM_Total_update" MapContextField="Transaction_total" />
         <ControlField Name="TotalDue" MapContext="TMD_running_discount_amt_CM" MapContextField="tmd_total" />
         <ControlField Name="TotalDue" MapContext="TMD_running_discount_amt_TM" MapContextField="tmd_total" />
         <ControlField Name="TotalDue" MapContext="Discount_running_total" MapContextField="Transaction_subtotal" />
         <ControlField Name="TotalDiscount" MapContext="CM_Reward_Totals" MapContextField="amount_saved" />
         <ControlField Name="TotalDiscount" MapContext="CM_Reward_display_x1" MapContextField="amount_saved" />
         <ControlField Name="TotalDiscount" MapContext="CM_Reward_display_x2" MapContextField="amount_saved" />
         <ControlField Name="TotalDiscount" MapContext="CM_Reward_display_x3" MapContextField="amount_saved" />
         <ControlField Name="TaxDue" MapContext="Item_entry_display" MapContextField="Tax_for_display" />
         <ControlField Name="TaxDue" MapContext="Balance_due_display" MapContextField="Tax_for_display" />
         <ControlField Name="TaxDue" MapContext="CM_Total_update" MapContextField="Tax_for_display" />
         <ControlField Name="TaxDue" MapContext="TMD_running_discount_amt_CM" MapContextField="tmd_tax" />
         <ControlField Name="TaxDue" MapContext="Subtotal_running_display" MapContextField="Tax_for_display" />         
		 <ControlField Name="FoodStampAmount" MapContext="Item_entry_display" MapContextField="food_stamp_subtotal" />
         <ControlField Name="RewardPoints" MapContext="CM_Reward_Totals" MapContextField="points_earned" />
         <ControlField Name="RewardPoints" MapContext="CM_Reward_display_x1" MapContextField="points_earned" />
         <ControlField Name="RewardPoints" MapContext="CM_Reward_display_x2" MapContextField="points_earned" />
         <ControlField Name="RewardPoints" MapContext="CM_Reward_display_x3" MapContextField="points_earned" />
      </Control>
      <Control Name="Tender">
         <ControlField Name="TenderDescription" MapContext="Tender_display" MapContextField="Tender_descriptor" />
         <ControlField Name="Amount" MapContext="Tender_display" MapContextField="total_tendered" />
         <ControlField Name="Balance" MapContext="Tender_display" MapContextField="Transaction_subtotal" />
         <!-- for void tender -->
         <ControlField Name="Amount" MapContext="Void_all_tenders_output" MapContextField="total_void_tender_amt" />
         <ControlField Name="Balance" MapContext="Void_all_tenders_output" MapContextField="Transaction_subtotal" />
         <!-- The ChangeDue is commented for now -->
         <!-- DO NOT DELETE OR UNCOMMENT -->
         <!-- Enabling it can cause changedue to show on the following transaction, so will need TB changes -->
         <!-- ControlField Name="ChangeDue" MapContext="End_of_transaction_display" MapContextField="Change_due"/-->
      </Control>
      <Control Name="Printer">
         <ControlField Name="Function" MapProperty="Printer_Function" />
         <ControlField Name="StationId" MapProperty="Printer_Station" />
         <ControlField Name="BarcodeType" MapProperty="Printer_Argument" />
         <ControlField Name="Data" MapContext="Tlog_written_ok" MapContextField="transaction_number" />
         <ControlField Name="Data" MapContext="Tender_franking_1_MICR" MapContextField="Tender_descriptor" />
         <ControlField Name="Data" MapContext="Tender_franking_1" MapContextField="Tender_descriptor" />
         <ControlField Name="Data" MapContext="acs_tb_interface" MapContextField="EFTCardNumber" />
         <ControlField Name="Data" MapProperty="Printer_Data" />
      </Control>
      <Control Name="Scale">
         <ControlField Name="Weight" MapProperty="Scale_Weight_Prop" />
         <ControlField Name="UserLong" MapProperty="Scale_Weight_Prop" />
         <ControlField Name="UserString" MapProperty="Scale_Weight_Prop" />
      </Control>
      <Control Name="ACSReward">
         <ControlField Name="ContextType" MapProperty="RewardContextNum" />
         <ControlField Name="PointsEarned" MapContext="CM_Reward_display_x1" MapContextField="points_earned" />
         <ControlField Name="PointsEarned" MapContext="CM_Reward_display_x2" MapContextField="points_earned" />
         <ControlField Name="PointsEarned" MapContext="CM_Reward_display_x3" MapContextField="points_earned" />
         <ControlField Name="AmountSaved" MapContext="CM_Reward_display_x1" MapContextField="amount_saved" />
         <ControlField Name="AmountSaved" MapContext="CM_Reward_display_x2" MapContextField="amount_saved" />
         <ControlField Name="AmountSaved" MapContext="CM_Reward_display_x3" MapContextField="amount_saved" />
         <ControlField Name="TaxForDisplay" MapContext="CM_Reward_display_x1" MapContextField="Tax_for_display" />
         <ControlField Name="TaxForDisplay" MapContext="CM_Reward_display_x2" MapContextField="Tax_for_display" />
         <ControlField Name="TaxForDisplay" MapContext="CM_Reward_display_x3" MapContextField="Tax_for_display" />
         <ControlField Name="TransactionTotal" MapContext="CM_Reward_display_x1" MapContextField="Transaction_total" />
         <ControlField Name="TransactionTotal" MapContext="CM_Reward_display_x2" MapContextField="Transaction_total" />
         <ControlField Name="TransactionTotal" MapContext="CM_Reward_display_x3" MapContextField="Transaction_total" />
         <ControlField Name="EntryID" MapContext="CM_Reward_display_x1" MapContextField="EntryID" />
         <ControlField Name="EntryID" MapContext="CM_Reward_display_x2" MapContextField="EntryID" />
         <ControlField Name="EntryID" MapContext="CM_Reward_display_x3" MapContextField="EntryID" />
         <ControlField Name="RewardID" MapContext="CM_Reward_display_x1" MapContextField="RewardID" />
         <ControlField Name="RewardID" MapContext="CM_Reward_display_x2" MapContextField="RewardID" />
         <ControlField Name="RewardID" MapContext="CM_Reward_display_x3" MapContextField="RewardID" />
         <ControlField Name="RewardType" MapContext="CM_Reward_display_x1" MapContextField="RewardType" />
         <ControlField Name="RewardType" MapContext="CM_Reward_display_x2" MapContextField="RewardType" />
         <ControlField Name="RewardType" MapContext="CM_Reward_display_x3" MapContextField="RewardType" />
         <ControlField Name="ExtendedRewardValue" MapContext="CM_Reward_display_x1" MapContextField="ExtendedRewardValue" />
         <ControlField Name="ExtendedRewardValue" MapContext="CM_Reward_display_x2" MapContextField="ExtendedRewardValue" />
         <ControlField Name="ExtendedRewardValue" MapContext="CM_Reward_display_x3" MapContextField="ExtendedRewardValue" />
         <ControlField Name="RewardDesc1" MapContext="CM_Reward_display_x1" MapContextField="reward_description_1" />
         <ControlField Name="RewardDesc1" MapContext="CM_Reward_display_x2" MapContextField="reward_description_1" />
         <ControlField Name="RewardDesc1" MapContext="CM_Reward_display_x3" MapContextField="reward_description_1" />
         <ControlField Name="RewardDesc2" MapContext="CM_Reward_display_x2" MapContextField="reward_description_2" />
         <ControlField Name="RewardDesc2" MapContext="CM_Reward_display_x3" MapContextField="reward_description_2" />
         <ControlField Name="RewardDesc3" MapContext="CM_Reward_display_x3" MapContextField="reward_description_3" />
         <ControlField Name="RewardAmt1" MapContext="CM_Reward_display_x1" MapContextField="reward_amount_1" />
         <ControlField Name="RewardAmt1" MapContext="CM_Reward_display_x2" MapContextField="reward_amount_1" />
         <ControlField Name="RewardAmt1" MapContext="CM_Reward_display_x3" MapContextField="reward_amount_1" />
         <ControlField Name="RewardAmt2" MapContext="CM_Reward_display_x2" MapContextField="reward_amount_2" />
         <ControlField Name="RewardAmt2" MapContext="CM_Reward_display_x3" MapContextField="reward_amount_2" />
         <ControlField Name="RewardAmt3" MapContext="CM_Reward_display_x3" MapContextField="reward_amount_3" />
         <ControlField Name="ItemModifier1" MapContext="CM_Reward_display_x1" MapContextField="item_modifier_1" />
         <ControlField Name="ItemModifier1" MapContext="CM_Reward_display_x2" MapContextField="item_modifier_1" />
         <ControlField Name="ItemModifier1" MapContext="CM_Reward_display_x3" MapContextField="item_modifier_1" />
         <ControlField Name="ItemModifier2" MapContext="CM_Reward_display_x2" MapContextField="item_modifier_2" />
         <ControlField Name="ItemModifier2" MapContext="CM_Reward_display_x3" MapContextField="item_modifier_2" />
         <ControlField Name="ItemModifier3" MapContext="CM_Reward_display_x3" MapContextField="item_modifier_3" />
         <ControlField Name="VoidIndicator1" MapContext="CM_Reward_display_x1" MapContextField="void_indicator_1" />
         <ControlField Name="VoidIndicator1" MapContext="CM_Reward_display_x2" MapContextField="void_indicator_1" />
         <ControlField Name="VoidIndicator1" MapContext="CM_Reward_display_x3" MapContextField="void_indicator_1" />
         <ControlField Name="VoidIndicator2" MapContext="CM_Reward_display_x2" MapContextField="void_indicator_2" />
         <ControlField Name="VoidIndicator2" MapContext="CM_Reward_display_x3" MapContextField="void_indicator_2" />
         <ControlField Name="VoidIndicator3" MapContext="CM_Reward_display_x3" MapContextField="void_indicator_3" />
		 <!-- There is no other way to capture the succeding values of acs_tb_interface context for SVCard limit tender allowed tenders, so it hass been decided to ride-in on this
			ACSReward Control
		 -->
		 <ControlField Name="RewardDesc1" MapContext="acs_tb_interface" MapContextField="EFTTenderDescription" />
		 <ControlField Name="RewardAmt1" MapContext="acs_tb_interface" MapContextField="EFTTenderTotal" />
		  <!-- POS277295 -->
		 <ControlField Name="RewardType" MapContext="acs_tb_interface" MapContextField="tb_int" />
		 <ControlField Name="RewardID" MapContext="acs_tb_interface" MapContextField="tb_long" />
		 <ControlField Name="RewardDesc1" MapContext="acs_tb_interface" MapContextField="mnemonic" />
         <ControlField Name="RewardDesc2" MapContext="acs_tb_interface" MapContextField="account_number" /> 
	  <!-- POS277295 -->
      </Control>

      <Control Name="ACSList">
		 <ControlField Name="EntryValue" MapContext="DF_Build_rainck" MapContextField="desc" />
	  </Control>

<!-- POS 12127 rrs -->
      <Control Name="ACSTaxList">
		 <ControlField Name="TaxListDesc" MapContext="TaxToggle_PickList" MapContextField="reason" />
	  </Control>
<!-- e POS 12127 rrs -->

      <!-- POS83168: The PosDynaframeMode Control will allow FastLane to know the appropriate time to enable its scanner.   -->
      <!-- The appropriate time is when the POS sales app's DF_Mode context's scan_scale is set to "|BITMAP|:scaninpt.bmp". -->
      <Control Name="PosDynaframeMode">
         <ControlField Name="PosModeImage" MapContext="DF_Mode" MapContextField="mode" />
         <ControlField Name="PosScanScaleImage" MapContext="DF_Mode" MapContextField="scan_scale" />
      </Control>
	  <!-- CRD 313027 Save Everseen details -->
	   <Control Name="EverseenProperties">
		 <ControlField Name="EverseenVideoPath" MapContext="acs_tb_interface" MapContextField="account_number" />
	  </Control>
	  <!-- CRD 564271 Save Apply Meijer Card Options -->
	   <Control Name="ApplyMeijerCardProperties">
		 <ControlField Name="ApplyMeijerCardEnabled" MapContext="acs_tb_interface" MapContextField="tb_char" />
		 <ControlField Name="ApplyMeijerCardRedisplay" MapContext="acs_tb_interface" MapContextField="EFTTenderTotal" /> <!-- CRD 537490 -->
		 <ControlField Name="ApplyMeijerCardOnAttract" MapContext="acs_tb_interface" MapContextField="EFTCustomerName" />
		 <ControlField Name="ApplyMeijerCardOnSNB" MapContext="acs_tb_interface" MapContextField="mnemonic" />
		 <ControlField Name="ApplyMeijerCardOnPayment" MapContext="acs_tb_interface" MapContextField="account_number" />
	  </Control>
   </Controls>
   <Events>      
      <OnContextEvent Context="Operator_guidance">
	     <SetProperty Value="0" Action="Set" Property="HHRapVirtualKeyboardNeeded" />
		 <SetProperty Value="0" Action="Set" Property="IsSupervisorApproval" />		 
		 <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0" />
         <SetProperty Value="1" Action="Set" Property="PropIsOperGuid" />
         <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
         <SetProperty Value="0" Action="Set" Property="PropIsProcessingItem" />
         <SetProperty Value="0" Action="Set" Property="PropIsVoidItem" />
         <ResetContext Context="Operator_guidance" />
         <ResetContext Context="Error_tone" />
      </OnContextEvent>
      <OnContextEvent Context="DF_Void_item_mods">
         <SetProperty Value="1" Action="Set" Property="PropIsVoidItem" />
         <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
         <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />
         <SetProperty Value="0" Action="Set" Property="PropIsProcessingItem" />
      </OnContextEvent>
      <OnContextEvent Context="DF_Prc_method">
         <SetProperty Value="1" Action="Set" Property="PropIsPrcMethod" />
         <SetProperty Value="0" Action="Set" Property="PropIsVoidItem" />
         <SetProperty Value="0" Action="Set" Property="PropIsOperGuid" />
         <SetProperty Value="0" Action="Set" Property="PropIsProcessingItem" />
      </OnContextEvent>
      <OnContextEvent Context="DF_Void_item_type">
         <SetProperty Property="Title1_Prop" Action="Set" Value="Void Item" />
         <SetProperty Property="Title2_Prop" Action="Set" Value="Item Type" />
         <SetProperty Property="LTT1_Prop" Action="Set" Value="Select type of item to void" />
         <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
         <SetProperty Property="DK1_Label_Prop" Action="Set" Value="Normal Item" />
         <SetProperty Property="DK2_Label_Prop" Action="Set" Value="Return Item" />
         <SetProperty Property="DK3_Label_Prop" Action="Set" Value="Negative Item" />
         <SetProperty Property="DK4_Label_Prop" Action="Set" Value="Deposit Item" />
         <SetProperty Property="DK5_Label_Prop" Action="Set" Value="Deposit Return" />
         <SetProperty Property="DK6_Label_Prop" Action="Set" Value="Manual Tax" />
         <SetProperty Property="DK7_Label_Prop" Action="Set" Value="Version E Item" />
         <SetProperty Property="DK8_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK8_Label_Alt_Prop" Action="Set" Value="" />
         <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
         <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="0" />
         <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="0" />
         <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="0" />
         <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="0" />
         <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="0" />
         <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="0" />
         <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="0" />
         <SendControl Control="Display" />
      </OnContextEvent>
      <OnContextEvent Context="DF_Dupl_term_num">
         <SetProperty Property="Title1_Prop" Action="Set" Value="Duplicate EFT Receipt" />
         <SetProperty Property="Title2_Prop" Action="Set" Value="" />
         <SetProperty Property="LTT1_Prop" Action="Set" Value="Key in terminal number or select This Terminal" />
         <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
         <SetProperty Property="DK1_Label_Alt_Prop" Action="Set" Value="This Terminal" />
         <SetProperty Property="DK2_Label_Alt_Prop" Action="Set" Value="" />
         <SetProperty Property="DK3_Label_Alt_Prop" Action="Set" Value="" />
         <SetProperty Property="DK4_Label_Alt_Prop" Action="Set" Value="" />
         <SetProperty Property="DK5_Label_Alt_Prop" Action="Set" Value="" />
         <SetProperty Property="DK6_Label_Alt_Prop" Action="Set" Value="" />
         <SetProperty Property="DK7_Label_Alt_Prop" Action="Set" Value="" />
         <SetProperty Property="DK8_Label_Alt_Prop" Action="Set" Value="Backup" />
         <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
         <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="0" />
         <SendControl Control="Display" />
      </OnContextEvent>
      <OnContextEvent Context="DF_DynaFrame_labels">
         <SetProperty Value="0" Action="Set" Property="PropIsProbablyPINEntry" />
		 <SetProperty Value="0" Action="Set" Property="NeedAMProcessing"/>
		 <SendControl Control="Display" />         
      </OnContextEvent>
      <OnContextEvent Context="DF_DynaKey_labels">
         <SetProperty Property="ItemMenuFlag" Action="Set" Value="0" />
         <SetProperty Value="0" Action="Set" Property="PropIsProbablyPINEntry" />
		 <SetProperty Value="0" Action="Set" Property="NeedAMProcessing"/>
         <SendControl Control="Display" />
         <ResetAllContexts>
            <Exclude Context="DF_DynaKey_labels" />			
         </ResetAllContexts>
         <SetProperty Property="RefreshDisplay" Action="Set" Value="0" />
      </OnContextEvent>
      <OnContextEvent Context="Item_entry_display">
         <SendControl Control="ItemDetails" />
         <ResetControl Control="ItemDetails" />
         <SetProperty Value="0" Action="Set" Property="ItemWeight" />
         <ResetContext Context="DF_Birth_date" />
         <SetProperty Value="0" Action="Set" Property="LinkedItem_Prop" />
         <SetProperty Value="0" Action="Set" Property="IsRestricted_Prop" />
         <SetProperty Value="0" Action="Set" Property="RestrictedAge_Prop" />
         <SetProperty Property="IsTransactionVoided_Prop" Action="Set" Value="0" />
         <SetProperty Property="GiftCardInUse" Action="Set" Value="0" />
		 <SetProperty Property="IsVoiding" Action="Set" Value="0" />
         <SetProperty Property="ItemMenuFlag" Action="Set" Value="1" />
		 <SetProperty Value="" Action="Set" Property="ResponseCodeToSendToPOS" />

            <SetProperty Value="0" Action="Set" Property="PropIsPrcMethod" />   <!-- POS31053 reset the price verify flag rrs -->
      </OnContextEvent>

<!-- SOTF8380 - O2S - RRS -->

      <OnContextEvent Context="O2S_box_id_disp">
         <SendControl Control="ItemDetails" />
         <ResetControl Control="ItemDetails" />
         <SetProperty Value="0" Action="Set" Property="ItemWeight" />
         <ResetContext Context="O2S_box_id_disp" />
         <SetProperty Value="0" Action="Set" Property="LinkedItem_Prop" />
         <SetProperty Value="0" Action="Set" Property="IsRestricted_Prop" />
         <SetProperty Value="0" Action="Set" Property="RestrictedAge_Prop" />
         <SetProperty Property="IsTransactionVoided_Prop" Action="Set" Value="0" />
         <SetProperty Property="GiftCardInUse" Action="Set" Value="0" />
	 <SetProperty Property="IsVoiding" Action="Set" Value="0" />
         <SetProperty Property="ItemMenuFlag" Action="Set" Value="1" />
	 <SetProperty Value="" Action="Set" Property="ResponseCodeToSendToPOS" />
      </OnContextEvent>

<!-- E - SOTF8380 - O2S - RRS -->
      <OnContextEvent Context="TMD_running_discount_amt_TM">
         <SendControl Control="Total" />
         <SetProperty Value="1" Action="Set" Property="IsTMD_Only" />
         <SetProperty Value="0" Action="Set" Property="IsCM_TMDPresent" />
         <SetProperty Property="CMDiscount_Total" Action="Set" Value="0" />
      </OnContextEvent>
      <OnContextEvent Context="TMD_running_discount_amt_CM">
         <SendControl Control="Total" />
         <SetProperty Value="1" Action="Set" Property="IsCM_TMDPresent" />
         <SetProperty Value="0" Action="Set" Property="GM_Total_Subtotal" />
         <SetProperty Value="0" Action="Set" Property="IsTMD_Only" />
      </OnContextEvent>
      <OnContextEvent Context="Subtotal_running_display">
         <SetProperty Value="0" Action="Set" Property="IsCM_TMDPresent" />
         <SetProperty Value="0" Action="Set" Property="IsCMDPresent" />
         <SetProperty Value="0" Action="Set" Property="GM_Total_TMD" />
         <SetProperty Property="CMDiscount_Total" Action="Set" Value="0" />
         <SendControl Control="Total" />
      </OnContextEvent>
      <OnContextEvent Context="Subtotal_running_display_CM">
         <SetProperty Value="0" Action="Set" Property="IsCM_TMDPresent" />
         <SetProperty Value="0" Action="Set" Property="GM_Total_TMD" />
         <SetProperty Value="1" Action="Set" Property="IsCMDPresent" />
         <SendControl Control="Total" />
      </OnContextEvent>
      <OnContextEvent Context="Item_entry_orig_price_display">
         <ResetContext Context="Item_entry_orig_price_display" />
         <SendControl Control="Total" />
      </OnContextEvent>
      <OnContextEvent Context="Last_item_entry_display">
         <SendControl Control="Total" />  

	 <!-- pos 12127 rrs -->
	 <SetProperty Value="0" Action="Set" Property="TaxListReceipt" />             
	 <!-- e pos 12127 rrs -->

      </OnContextEvent>
      <OnContextEvent Context="Tender_display">
         <SendControl Control="Tender" />
         <SetProperty Value="1" Action="Set" Property="TenderDisplaySeen" />
      </OnContextEvent>
      <OnContextEvent Context="Tlog_written_ok">
         <SetProperty Property="SignPaperForm" Action="Set" Value="0" />
         <SetProperty Value="0" Action="Set" Property="Printer_Function" />
         <SetProperty Value="0" Action="Set" Property="Printer_Station" />
         <SetProperty Value="0" Action="Set" Property="Printer_Argument" />
         <SetProperty Property="IsPOSRestartInprogress" Action="Set" Value="0" />
         <SendControl Control="Printer" />
      </OnContextEvent>
      <OnContextEvent Context="CM_Reward_display_x1">
         <SetProperty Value="1" Action="Set" Property="RewardContextNum" />
         <SendControl Control="ACSReward" />
         <ResetContext Context="CM_Reward_display_x1" />
      </OnContextEvent>
      <OnContextEvent Context="CM_Reward_display_x2">
         <SetProperty Value="2" Action="Set" Property="RewardContextNum" />
         <SendControl Control="ACSReward" />
         <ResetContext Context="CM_Reward_display_x2" />
      </OnContextEvent>
      <OnContextEvent Context="CM_Reward_display_x3">
         <SetProperty Value="3" Action="Set" Property="RewardContextNum" />
         <SendControl Control="ACSReward" />
         <ResetContext Context="CM_Reward_display_x3" />
      </OnContextEvent>
      <OnContextEvent Context="End_of_tran_dis_no_change">
         <!-- <SetProperty Value="0" Action="Set" Property="CheckEndorsed"/> this is transfered -->
		 <SetProperty Property="ReceiptWritten" Action="Set" Value="1" /><!-- SSCOI-45311 -->
		 <SetProperty Property="DK1_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK3_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK4_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK5_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK6_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK7_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK8_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="1" />
         <SendControl Control="Display" />
      </OnContextEvent>
      <OnContextEvent Context="DF_Printer_Error_warning">
         <SendInput Input="F1" />
      </OnContextEvent>

      <OnContextEvent Context="check_write_personal">
         <ResetContext Context="Tender_franking_1_MICR" />
         <ResetContext Context="Tender_franking_1" />
         <ResetContext Context="acs_tb_interface" />
      </OnContextEvent>
      <OnContextEvent Context="check_write_business">
         <ResetContext Context="Tender_franking_1_MICR" />
         <ResetContext Context="Tender_franking_1" />
         <ResetContext Context="acs_tb_interface" />
      </OnContextEvent>
      <OnContextEvent Context="DF_Check_write">
         <ResetContext Context="DF_DynaFrame_labels" />
         <ResetContext Context="DF_DynaKey_labels" />
         <SetProperty Property="Title1_Prop" Action="Set" Value="Check Writing" />
         <SetProperty Property="Title2_Prop" Action="Set" Value="" />
         <SetProperty Property="LTT1_Prop" Action="Set" Value="Select type of Check writing" />
         <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
         <SetProperty Property="DK1_Label_Prop" Action="Set" Value="Written by printer" />
         <SetProperty Property="DK2_Label_Prop" Action="Set" Value="Written by guest" />
         <SetProperty Property="DK3_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK4_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK5_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK6_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK7_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK8_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
         <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="0" />
         <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="1" />
		 <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
         <SendControl Control="Display" />
      </OnContextEvent>
      <OnContextEvent Context="DF_Check_write_pb">
         <ResetContext Context="DF_DynaFrame_labels" />
         <ResetContext Context="DF_DynaKey_labels" />
         <SetProperty Property="Title1_Prop" Action="Set" Value="Check Size" />
         <SetProperty Property="Title2_Prop" Action="Set" Value="Check Writing" />
         <SetProperty Property="LTT1_Prop" Action="Set" Value="Select size of Check" />
         <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
         <SetProperty Property="DK1_Label_Prop" Action="Set" Value="Personal/small" />
         <SetProperty Property="DK2_Label_Prop" Action="Set" Value="Business/large" />
         <SetProperty Property="DK3_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK4_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK5_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK6_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK7_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK8_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
         <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="0" />
         <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="1" />
         <SendControl Control="Display" />
      </OnContextEvent>
      <OnContextEvent Context="DF_giftcard_man_balance_req">
         <ResetContext Context="DF_DynaFrame_labels" />
         <ResetContext Context="DF_DynaKey_labels" />
         <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
         <SetProperty Property="Title1_Prop" Action="Set" Value="Manual Tender Entry" />
         <SetProperty Property="Title2_Prop" Action="Set" Value="" />
         <SetProperty Property="LTT1_Prop" Action="Set" Value="Enter Amount to be Tendered or Select Cancel" />
         <SetProperty Property="LTT2_Prop" Action="Set" Value="" />
         <SetProperty Property="DK1_Label_Prop" Action="Set" Value="Cancel" />
         <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK3_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK4_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK5_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK6_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK7_Label_Prop" Action="Set" Value="" />
         <SetProperty Property="DK8_Label_Prop" Action="Set" Value="Backup" />
         <SetProperty Property="DK1_Grayed_Prop" Action="Set" Value="0" />
         <SetProperty Property="DK2_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK4_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK5_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK6_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK7_Grayed_Prop" Action="Set" Value="1" />
         <SetProperty Property="DK8_Grayed_Prop" Action="Set" Value="0" />
         <SendControl Control="Display" />
         <SetProperty Property="Title1_Prop" Action="Set" Value="" />
      </OnContextEvent>
      <OnContextEvent Context="Close_Drawer_Warning">
         <SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0"/>
         <SetProperty Property="OP_Guidance_Txt" Action="Set" Value="Close Cash Drawer" />
         <SetProperty Property="OP_Guidance_Prompt" Action="Set" Value="Hello" />
         <SetProperty Property="PropIsOperGuid" Action="Set" Value="1" />
		 <SetProperty Property="DK3_Grayed_Prop" Action="Set" Value="1" /> 
		 <SetProperty Property="RefreshDisplay" Action="Set" Value="1" />
         <SendControl Control="Display" />
         <SetProperty Property="OP_Guidance_Txt" Action="Set" Value="" />
         <SetProperty Property="OP_Guidance_Prompt" Action="Set" Value="" />
         <SetProperty Property="PropIsOperGuid" Action="Set" Value="0" />
      </OnContextEvent>
      <OnContextEvent Context="Store_transaction_trailer_2">
         <SetProperty Property="ReceiptWritten" Action="Set" Value="1" />
      </OnContextEvent>

<!-- SOTF 8380 O2S RRS -->
      <OnContextEvent Context="Store_transaction_trailer">
         <SetProperty Property="ReceiptWritten" Action="Set" Value="1" />
      </OnContextEvent>
<!-- E SOTF 8380 O2S RRS -->

<!-- POS180969 -->
      <OnContextEvent Context="Store_report_trailer">
         <SetProperty Property="ReceiptWritten" Action="Set" Value="1" />
      </OnContextEvent>
<!-- e POS180969 -->

      <OnContextEvent Context="Discount_running_total">
         <SendControl Control="Total" />
      </OnContextEvent>
      <OnContextEvent Context="DF_Alphanum_display_lc">
         <SendControl Control="Display" />
         <ResetContext Context="DF_Alphanum_display_lc" />
         <!-- <SetProperty Property="EntryData_Prop" Action="Set" Value="" /> -->
      </OnContextEvent>
      <!-- TAR 392580 
      <OnContextEvent Context="gift_receipt">
         <SetProperty Property="PrintGiftReceipt" Action="Set" Value="0" />
      </OnContextEvent>
      -->

      <OnContextEvent Context="Resume2_transaction">
         <SetProperty Property="IsResumeTrxInProgress" Action="Set" Value="1" />
         <SetProperty Value="0" Action="Set" Property="IsResumeComplete" />
		 <SetProperty Value="0" Action="Set" Property="IsResumeCompleteLocal" />
      </OnContextEvent>
	  <OnContextEvent Context="Suspend_transaction">
		 <SetProperty Property="PrintGiftReceipt" Action="Set" Value="0" />
		 <SetProperty Property="RebateReceiptRequested" Action="Set" Value="0" />
      </OnContextEvent>
      <OnContextEvent Context="Suspend_transaction_barcode">
	     <SetProperty Property="SuspendingCurrentTransaction" Action="Set" Value="1" />
	  </OnContextEvent>
      <OnContextEvent Context="DF_Acct_no_MSR_ResumePhoneGift">
        <SetProperty Property="Title1_Prop" Action="Set" Value="Account Number" />
        <SetProperty Property="Title2_Prop" Action="Set" Value="MSR Entry" />
        <SetProperty Property="LTT1_Prop" Action="Set" Value="Swipe card to activate or Cancel to void item" />
        <SetProperty Property="DK1_Label_Prop" Action="Set" Value="Cancel" />
        <SetProperty Property="DK2_Label_Prop" Action="Set" Value="" />
        <SendControl Control="Display" />
      </OnContextEvent>
      <OnContextEvent Context="DF_Build_rainck">
		<!-- POS57586 <SetProperty Value="1" Action="Set" Property="VoidPrepaidCards"  remove the line rrs -->
		<SetProperty Value="1" Action="Set" Property="PropEASDeact" /><!--POS11024 Mobile Shopper-->
		<SendControl Control="ACSList"/>
		<ResetContext Context="DF_Build_rainck" />				
	  </OnContextEvent>
	  <OnContextEvent Context="Status_window_update">      
        <ResetContext Context="Status_window_update" />
      </OnContextEvent>  

      <!-- pos 12127 taxtable rrs -->

      <OnContextEvent Context="TaxToggle_PickList">
		<SendControl Control="ACSTaxList"/>
		<ResetContext Context="TaxToggle_PickList" />				
      </OnContextEvent>

      <OnContextEvent Context="TaxToggle_SSCSelection">
		<SetProperty Value="1" Action="Set" Property="TaxListReceipt" />
		<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0"/>
		<SendControl Control="Display"/>
      </OnContextEvent>
      <!-- pos 12127 taxtable rrs --> 

     <!-- POS57686 Raincheck rrs -->
     <!-- POS57465: RainCheckList property also used for mPerks Lookup. -->
      <OnContextEvent Context="DF_rainck_selection">
		<SetProperty Value="1" Action="Set" Property="RainCheckList" /> <!-- TaxListReceipt"-->
		<SetProperty Property="PropertyAllowAMExit" Action="Set" Value="0"/>
		<SendControl Control="Display"/>
      </OnContextEvent>
     <!-- e POS57686 Raincheck rrs -->

      <!-- POS83168: Activate the PosDynaframeMode Control to see if this is the appropriate time for FastLane to enable its scanner. -->
      <!-- The appropriate time is when the POS sales app's DF_Mode context's scan_scale is set to "|BITMAP|:scaninpt.bmp".           -->
      <OnContextEvent Context="DF_Mode">
         <SendControl Control="PosDynaframeMode" />
         <ResetContext Context="DF_Mode" />
      </OnContextEvent>

   </Events>
   <Inputs>
      <!-- Sequence type inputs interface with the application using the ACSIO Sequence channel.
      Each SequenceField represents a field in the structure that is filled in and sent over the
      sequence channel. The sequence fields are defined in the KEYBOARD_TYPE union in the 
      asgvsd.h file. -->
      <Input Name="ENTRY_ID_ENTERED">
         <Sequence>
            <SequenceField Name="entry_id" MapProperty="PropEntryId" />
         </Sequence>
      </Input>
      <Input Name="FL_NOTIFY_ENTERED">
         <Sequence>
            <SequenceField Name="data" MapProperty="PropFLNotifyData" />
            <SequenceField Name="id" MapProperty="PropFLNotifyId" />
         </Sequence>
      </Input>
      <Input Name="ACSIO_BIOMETRIC_ENTERED">
         <Sequence>
            <SequenceField Name="data" MapProperty="PropBiometricData" />
            <SequenceField Name="count" MapProperty="PropBiometricCount" />
         </Sequence>
      </Input>               
      <Input Name="1">
         <Text Value="{{02}}" />
      </Input>
      <Input Name="2">
         <Text Value="{{03}}" />
      </Input>
      <Input Name="3">
         <Text Value="{{04}}" />
      </Input>
      <Input Name="4">
         <Text Value="{{05}}" />
      </Input>
      <Input Name="5">
         <Text Value="{{06}}" />
      </Input>
      <Input Name="6">
         <Text Value="{{07}}" />
      </Input>
      <Input Name="7">
         <Text Value="{{08}}" />
      </Input>
      <Input Name="8">
         <Text Value="{{09}}" />
      </Input>
      <Input Name="9">
         <Text Value="{{0A}}" />
      </Input>
      <Input Name="0">
         <Text Value="{{0B}}" />
      </Input>
      <Input Name="-">
         <Text Value="{{0C}}" />
      </Input>
      <Input Name="=">
         <Text Value="{{0D}}" />
      </Input>
      <Input Name="BackSpace">
         <Text Value="{{0E}}" />
      </Input>
      <Input Name="Tab">
         <Text Value="{{0F}}" />
      </Input>
      <Input Name="q">
         <Text Value="{{10}}" />
      </Input>
      <Input Name="w">
         <Text Value="{{11}}" />
      </Input>
      <Input Name="e">
         <Text Value="{{12}}" />
      </Input>
      <Input Name="r">
         <Text Value="{{13}}" />
      </Input>
      <Input Name="t">
         <Text Value="{{14}}" />
      </Input>
      <Input Name="y">
         <Text Value="{{15}}" />
      </Input>
      <Input Name="u">
         <Text Value="{{16}}" />
      </Input>
      <Input Name="i">
         <Text Value="{{17}}" />
      </Input>
      <Input Name="o">
         <Text Value="{{18}}" />
      </Input>
      <Input Name="p">
         <Text Value="{{19}}" />
      </Input>
      <Input Name="[">
         <Text Value="{{1A}}" />
      </Input>
      <Input Name="]">
         <Text Value="{{1B}}" />
      </Input>
      <Input Name="ENTER">
         <Text Value="{{1C}}" />
      </Input>
      <Input Name="CAPS">
         <Text Value="{{1D}}" />
      </Input>
      <Input Name="a">
         <Text Value="{{1E}}" />
      </Input>
      <Input Name="s">
         <Text Value="{{1F}}" />
      </Input>
      <Input Name="d">
         <Text Value="{{20}}" />
      </Input>
      <Input Name="f">
         <Text Value="{{21}}" />
      </Input>
      <Input Name="g">
         <Text Value="{{22}}" />
      </Input>
      <Input Name="h">
         <Text Value="{{23}}" />
      </Input>
      <Input Name="j">
         <Text Value="{{24}}" />
      </Input>
      <Input Name="k">
         <Text Value="{{25}}" />
      </Input>
      <Input Name="l">
         <Text Value="{{26}}" />
      </Input>
      <Input Name=";">
         <Text Value="{{27}}" />
      </Input>
      <Input Name="'">
         <Text Value="{{28}}" />
      </Input>
      <Input Name="`">
         <Text Value="{{29}}" />
      </Input>
      <Input Name="skipped">
         <Text Value="{{2A}}" />
      </Input>
      <Input Name="\">
         <Text Value="{{2B}}" />
      </Input>
      <Input Name="z">
         <Text Value="{{2C}}" />
      </Input>
      <Input Name="x">
         <Text Value="{{2D}}" />
      </Input>
      <Input Name="c">
         <Text Value="{{2E}}" />
      </Input>
      <Input Name="v">
         <Text Value="{{2F}}" />
      </Input>
      <Input Name="b">
         <Text Value="{{30}}" />
      </Input>
      <Input Name="n">
         <Text Value="{{31}}" />
      </Input>
      <Input Name="m">
         <Text Value="{{32}}" />
      </Input>
      <Input Name=",">
         <Text Value="{{33}}" />
      </Input>
      <Input Name=".">
         <Text Value="{{34}}" />
      </Input>
      <Input Name="/">
         <Text Value="{{35}}" />
      </Input>
      <Input Name="shift">
         <Text Value="{{36}}" />
      </Input>
      <Input Name="*">
         <Text Value="{{37}}" />
      </Input>
      <Input Name="">
         <Text Value="{{38}}" />
      </Input>
      <Input Name=" ">
         <Text Value="{{39}}" />
      </Input>
      <Input Name="">
         <Text Value="{{3A}}" />
      </Input>
      <Input Name="F1">
         <Text Value="{{3B}}" />
      </Input>
      <Input Name="F2">
         <Text Value="{{3C}}" />
      </Input>
      <Input Name="F3">
         <Text Value="{{3D}}" />
      </Input>
      <Input Name="CREDIT">
         <Text Value="{{3D}}" />
      </Input>
      <Input Name="F4">
         <Text Value="{{3E}}" />
      </Input>
      <Input Name="DEBIT">
         <Text Value="{{3E}}" />
      </Input>
      <Input Name="F5">
         <Text Value="{{3F}}" />
      </Input>
	  <!-- Task POS102483 Assign F6 key for CASH -->
	  <Input Name="CASH">
         <Text Value="{{40}}" />
      </Input>
      <Input Name="F6">
         <Text Value="{{40}}" />
      </Input>
      <Input Name="F7">
         <Text Value="{{41}}" />
      </Input>
      <Input Name="F8">
         <Text Value="{{42}}" />
      </Input>
      <Input Name="GIFTCARD">
         <Text Value="{{4241}}" />
      </Input>
      <Input Name="ITEM">
         <Text Value="{{54}}" />
      </Input>
      <Input Name="TRANS">
         <Text Value="{{55}}" />
      </Input>
      <Input Name="MISC">
         <Text Value="{{56}}" />
      </Input>
      <Input Name="OTHER">
         <Text Value="{{57}}" />
      </Input>
      <Input Name="PRICE">
         <Text Value="{{58}}" />
      </Input>
      <Input Name="VOID">
         <Text Value="{{59}}" />
      </Input>
      <Input Name="CLEAR">
         <Text Value="{{5A}}" />
      </Input>
      <Input Name="LOOKUP">
         <Text Value="{{5B}}" />
      </Input>
      <Input Name="COUPON">
         <Text Value="{{5D}}" />
      </Input>
      <Input Name="PAYMENT">
         <Text Value="{{5E}}" />
      </Input>
      <Input Name="DEPT">
         <Text Value="{{5F}}" />
      </Input>
      <Input Name="DOWN">
         <Text Value="{{50}}" />
      </Input>
      <Input Name="UP">
         <Text Value="{{48}}" />
      </Input>
   </Inputs>
</ApplicationModel>
